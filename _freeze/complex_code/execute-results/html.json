{
  "hash": "a47309c0e1b2590348c40b9651364b51",
  "result": {
    "markdown": "---\ntitle: \"Tutorial(complex) - Code\"\nsubtitle: \"Complex demo of using code in TriplotGUI\"\ntitle-block-banner: true\ntitle-block-banner-color: white\ntitle-block-categories: false\n\npage-layout: full\nformat:\n  html: \n    margin-top: 0em\n    margin-bottom: 0em\n    padding-top: 0em\n    padding-bottom: 0em\n    minimal: true\n    smooth-scroll: true\n    fig-responsive: true\n    toc-location: right\n    toc-depth: 5\n    toc-title: Tutorial\n    number-sections: true  ## add number in the session or not\n    number-depth: 4\n    code-fold: show\n    code-summary: \"Show the code\"\n    code-overflow: wrap\n    code-tools: true\n    code-copy: true\n    highlight: tango\n    df-print: paged  ## kable is another option How the dataframe looks like \n    standalone: false  ### specifies if all assets and libraries must be integrated into the output html file as a standalone document.\n    fig-align: right\n    theme:  solar\ngeometry: margin=lin  \n---\n\n\n\n\nBefore starting,please make sure you have installed the TriplotGUI package following [Setup](installation.qmd){target=\"_blank\"}.\n\nThe code of at this page can be downloaded [here](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/HealthyNordicDiet_2_applying_TriplotGUI_code.R){target=\"_blank\"}\n\n# Data description\n\nThe data used in this page of tutorial can be downloaded [here](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda){target=\"_blank\"} in rda format.\n\nThe Data used for this example of code is ***HealthyNordicDiet_2***, modified from the **HealthyNordicDiet** data provided by the triplot package (Schillemans et al. 2019). **HealthyNordicDiet** is a synthetic dataset that was simulated from the authentic data used in a case/control study nested within the Swedish prospective Västerbotten Intervention Programme cohort. The original study was set up to explore plasma metabolites that could objectively reflect healthy Nordic dietary patterns in a matched case-control study and to assess associations between such patterns and later development of type 2 diabetes. (Shi et al. 2018). The simulated data ***HealthyNordicDiet_2*** is a list that contains three data frames:\n\n-   Clinical measurements (ClinData, 11 variables): `\"ID\"`,`\"T2D\"`(Cases and controls for type 2 diabetes), `\"PairedInfo\"`(Pairing information for case and controls),`\"Energy\"`,`\"Gender\"`,`\"Age\"`,`\"BMI\"`,`\"Smoking\"`,`\"PhysicalActivityIndex\"`,`\"Education\"`,`\"FastingGlucose\"`.\\\n-   Plasma metabolites predictive of BMI (MetaboliteData, 20 variables)\n-   Dietary intake as measured by food frequency questionnaires (FoodData, 11 variables): `\"HFI\"`(Healthy Food Index),`\"BSDS\"`(the Baltic Sea Diet Score),`\"Wholegrains\"`,`\"Sausage\"`,`\"Pizza\"`,`\"Refined.bread\"`, `\"Fruits\"`,`\"Liquor\"`,`\"Wine\"`,`\"Hamburger\"`,`\"Poultry\"`,`\"Fish\"`,`\"Margarine\"`,`\"Cabbage\"`,`\"Carrot\"`,`\"low_fat_Dairy\"`,`\"Vegetables\"`\n\nThe data frames are row-wise matched by observation and consist of 1000 synthetic observations.\n\n**Reference**\n\nShi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., & Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. *The American Journal of Clinical Nutrition*, 108(3), 564-575. [10.1093/ajcn/nqy145](https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub){target=\"_blank\"}\n\nSchillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. *Metabolites*. 2019 Jul 6;9(7):133. [doi: 10.3390/metabo9070133](https://www.mdpi.com/2218-1989/9/7/133){target=\"_blank\"}\n\n# Research question\n\nWe want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI. We assume that metabolites serves as mediators, mediating the effect of dietary exposures on Type 2 diabetes and BMI outcome.\n\n# Data exploration\n\n***HealthyNordicDiet_2*** is loaded in the R environment up on running `library(TriplotGUI)`. We will do some data exploration first to see how the data looks like.\n\n\n::: {.cell .styled-output}\n\n:::\n\n\n## Check HealthyNordicDiet_2\n\nCheck ***HealthyNordicDiet_2*** as a list:\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nclass(HealthyNordicDiet_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"list\"\n```\n:::\n\n```{.r .cell-code}\nnames(HealthyNordicDiet_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ClinData\"       \"MetaboliteData\" \"FoodData\"      \n```\n:::\n:::\n\n\n## Check datasets\n\nCheck the names of variables in each data:\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\ncolnames(HealthyNordicDiet_2$ClinData)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"ID\"                    \"T2D\"                   \"PairedInfo\"           \n [4] \"Energy\"                \"Gender\"                \"Age\"                  \n [7] \"BMI\"                   \"Smoking\"               \"PhysicalActivityIndex\"\n[10] \"Education\"             \"FastingGlucose\"       \n```\n:::\n\n```{.r .cell-code}\ncolnames(HealthyNordicDiet_2$MetaboliteData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Pipecolic.acid.betaine\"         \"lysoPC.18.0.\"                  \n [3] \"HP143.1179.1.55\"                \"lysoPE.22.6.\"                  \n [5] \"HN151.0065.4.97\"                \"RP225.1482.9.15\"               \n [7] \"X3.4.5.Trimethoxycinnamic.acid\" \"DHA\"                           \n [9] \"RP383.1671.10.53\"               \"gama.tocopherol\"               \n[11] \"RP431.3516.11.96\"               \"RP490.3516.8.99\"               \n[13] \"lysoPC.22.6.\"                   \"Steroid.glucuronide\"           \n[15] \"RP684.5545.13.41\"               \"RP197.0926.3.17\"               \n[17] \"RP303.6468.9.98\"                \"RP816.5684.12.52\"              \n[19] \"RP827.5356.11.88\"               \"RP826.5442.12.17\"              \n[21] \"RN201.1498.8.23\"                \"RN203.0022.3.00\"               \n[23] \"EPA\"                            \"PC.18.2.15.0.\"                 \n[25] \"RN814.5610.12.14\"               \"RN153.0190.3.5\"                \n[27] \"RN427.1641.10.59\"               \"RN457.1742.10.50\"              \n[29] \"RN830.5845.12.46\"               \"RN446.1541.10.59\"              \n[31] \"RN472.1596.10.53\"              \n```\n:::\n\n```{.r .cell-code}\ncolnames(HealthyNordicDiet_2$FoodData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"HFI\"           \"BSDS\"          \"Wholegrains\"   \"Sausage\"      \n [5] \"Pizza\"         \"Refined.bread\" \"Fruits\"        \"Liquor\"       \n [9] \"Wine\"          \"Hamburger\"     \"Poultry\"       \"Fish\"         \n[13] \"Margarine\"     \"Cabbage\"       \"Carrot\"        \"low_fat_Dairy\"\n[17] \"Vegetables\"   \n```\n:::\n:::\n\n\n## Check variables' class\n\nWe Transform the data to dataframe format and then use TriplotGUI's `checkdata()` function in to examine the class of variables.\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nClinData<-as.data.frame(HealthyNordicDiet_2$ClinData)\nMetaboliteData<-as.data.frame(HealthyNordicDiet_2$MetaboliteData)\nFoodData<-as.data.frame(HealthyNordicDiet_2$FoodData)\n\nClinData_check<-checkdata(ClinData)\nMetaboliteData_check<-checkdata(MetaboliteData)\nFoodData_check<-checkdata(FoodData)\n```\n:::\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nClinData_check$class_sumamry_statistics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNULL\n```\n:::\n\n```{.r .cell-code}\nMetaboliteData_check$class_sumamry_statistics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNULL\n```\n:::\n\n```{.r .cell-code}\nFoodData_check$class_sumamry_statistics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNULL\n```\n:::\n:::\n\n\n::: callout-note\nNote that `\"HFI\"`(Healthy Food Index) is used as a factor variable and `\"BSDS\"`(the Baltic Sea Diet Score) is used as a numeric variable. You could use `table(FoodData$HFI)` and `table(FoodData$BSDS)` to check the difference.\n:::\n\n## Check sanities for variables\n\nWhether each variable contains missing (NA) or abnormal values (e.g. NAN, Inf, blank value) can also be checked\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nClinData_check$everycolumn\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T2D\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PairedInfo\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Energy\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Gender\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Age\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BMI\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Smoking\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PhysicalActivityIndex\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Education\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"FastingGlucose\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"NA_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"NA_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"NaN_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"NaN_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"negative_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"negative_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"zero_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"zero_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"inf_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"inf_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"blank_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"blank_percentage\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nMetaboliteData_check$everycolumn\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Pipecolic.acid.betaine\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lysoPC.18.0.\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"HP143.1179.1.55\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lysoPE.22.6.\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"HN151.0065.4.97\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP225.1482.9.15\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X3.4.5.Trimethoxycinnamic.acid\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"DHA\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP383.1671.10.53\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gama.tocopherol\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP431.3516.11.96\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP490.3516.8.99\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lysoPC.22.6.\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Steroid.glucuronide\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP684.5545.13.41\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP197.0926.3.17\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP303.6468.9.98\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP816.5684.12.52\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP827.5356.11.88\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP826.5442.12.17\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN201.1498.8.23\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN203.0022.3.00\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"EPA\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PC.18.2.15.0.\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN814.5610.12.14\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN153.0190.3.5\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN427.1641.10.59\"],\"name\":[27],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN457.1742.10.50\"],\"name\":[28],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN830.5845.12.46\"],\"name\":[29],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN446.1541.10.59\"],\"name\":[30],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN472.1596.10.53\"],\"name\":[31],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"NA_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"NA_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"NaN_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"NaN_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"negative_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"negative_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"zero_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"zero_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"inf_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"inf_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"blank_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"blank_percentage\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nFoodData_check$everycolumn\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"HFI\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BSDS\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Wholegrains\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sausage\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pizza\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Refined.bread\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Fruits\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Liquor\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Wine\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Hamburger\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Poultry\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Fish\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Margarine\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Cabbage\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Carrot\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"low_fat_Dairy\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Vegetables\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"NA_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"NA_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"NaN_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"NaN_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"negative_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"negative_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"63.000\",\"4\":\"139.000\",\"5\":\"195.000\",\"6\":\"155.000\",\"7\":\"180.00\",\"8\":\"367.000\",\"9\":\"288.000\",\"10\":\"231.000\",\"11\":\"117.000\",\"12\":\"79.000\",\"13\":\"41.000\",\"14\":\"253.000\",\"15\":\"225.000\",\"16\":\"237.000\",\"17\":\"192.000\",\"_rn_\":\"zero_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.063\",\"4\":\"0.139\",\"5\":\"0.195\",\"6\":\"0.155\",\"7\":\"0.18\",\"8\":\"0.367\",\"9\":\"0.288\",\"10\":\"0.231\",\"11\":\"0.117\",\"12\":\"0.079\",\"13\":\"0.041\",\"14\":\"0.253\",\"15\":\"0.225\",\"16\":\"0.237\",\"17\":\"0.192\",\"_rn_\":\"zero_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"inf_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"inf_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"blank_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"blank_percentage\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n::: callout-note\nYou shall only continue when the class of variables are correct and the missing or abnormal values in the variable are properly handled.\n:::\n\n## Build data for analysis\n\nWe see food data as our exposures and BMI and type 2 diabetes as outcomes. Note that BMI is a continuous variable. We can additionally construct BMI as a categorical outcome using the criteria below and see how this may differ the result. \n\n-   BMI <= 18.5: Underweight \n-   18.5 <BMI <= 25: Normal \n-   25 < BMI <= 30: Overweight \n-   30 < BMI: Obese\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nBMI<-ClinData[,\"BMI\"]\nBMI_cat<-vector(length=length(BMI))\nfor(i in 1:length(BMI)){\n  if(BMI[i]<=18.5){\n    BMI_cat[i]<-\"underweight\"\n  }else if (BMI[i]>18.5&BMI[i]<=25){\n    BMI_cat[i]<-\"normal\"\n  }else if(BMI[i]>25&BMI[i]<=30){\n    BMI_cat[i]<-\"overweight\"\n  }else{\n    BMI_cat[i]<-\"obese\"\n  }\n}\nBMI_cat<-as.factor(BMI_cat)\n```\n:::\n\n\nWe want to explore the exposure-outcome relationships through the metabolomics data, using metabolites as assumed mediators. Gender, age, education, physical activity and smoking are used as potential confounders for exposure-mediator and mediator-outcome association. Auxiliary information regarding case-control pairs, fasting glucose level, education and physical activity are also provided.\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nexposure2<-FoodData\nOmics2<-MetaboliteData\noutcome2<-cbind.data.frame(ClinData[,c(\"T2D\",\"BMI\")],BMI_cat)\ncovariates2<-ClinData[,c(\"Gender\" ,\"Age\",\"Education\",\"PhysicalActivityIndex\",\"Smoking\" )]\nauxilary2<-ClinData[,c(\"PairedInfo\",\"FastingGlucose\",\"Education\",\"PhysicalActivityIndex\", \"Energy\")]\n```\n:::\n\n\n# Code example of using TriplotGUI\n\nWe will use a complex settings in this example. Please go to [Tutorial(simple)](simple_code.qmd){target=\"_blank\"}.if you want to try simple settings.\n\n## Step 1: Data reduction of omics data {#simple_link}\n\nUsing `TriplotGUI` package, first we perform dimension reduction, using weighted correlation network analysis (WGCNA) on metabolomics data.\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\n#* USing the complex settings\nreduced_Omics2<-PCAorWGCNA_plots(dataframe=Omics2,\n                                 plottype=c(\"scree\",\"score\",\"loading\",\"scoreloading\"),\n                                 pc_type=\"principal\", \n# Users can choose freely to use principal() instead of prcomp() to perform PCA.The result should be very similar, but principal() allows more functionalites\n                                 first_PC=1,\n                                 second_PC=2,\n                                 option=\"WGCNA\",\n# In this example we use WGCNA to perform data reduction, therefore specifying `option=\"WGCNA\"`.\n                                 scale=T,\n                                 center=T,\n                                 eigen_loading=\"loading\",\n# If you want to show loading or scale it to eigevalues.\n                                 rotate=\"none\",\n# This argument is inherited from the principal() functions\n                                 size_variable=auxilary2$FastingGlucose,\n                                 size_variable_name=\"FastigGlucose\",\n                                 color_variable=auxilary2$Education,\n                                 color_variable_name=\"Education\",\n                                 shape_variable=auxilary2$PhysicalActivityIndex,\n                                 shape_variable_name=\"PhysicalActivityIndex\",\n# The size,shape,color variables are used to differentiate points on the score plot and biplot \n                                 loadings_name=T,\n# Show the names of loadings\n                                 loadings_cutpercent=0.2,\n# The loadings bigger than 20% of all the loadings will show up\n                                 minModuleSize=3\n# The mimimum number of variable in the clusters of WGCNA\n)\n```\n:::\n\n\n::: callout-note\n-  In WGCNA, Omics variables are separated into clusters. PCA are first performed on each cluster and the first principal component of each cluster will be used as the principal components of WGCNA.\n-  You could try out the arguments of the `PCAorWGCNA_plots()` function and view the whole function [here](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCAorWGCNA_plots.R?ref_type=heads){target=\"_blank\"}\n-  One important argument in the `PCAorWGCNA_plots()` is `minModuleSize`, which defines the minimum number of variables in each cluster. If this number is specified as 2 high, for example, if you have 20 variables in total and you specify `minModuleSize=15`, you may only end up all the 20 variables as one cluster. In this case, only the first principal component of the cluster will be used and be shown on both axis of the generated triplots.\n:::\n\nYou can see scree plot, score plot, loadings plot and biplot at this stage.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nreduced_Omics2$scree_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_6A-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\nIn the scree plot, each cluster is named with different colors, and the column heights represents how much variance are explained by that cluster among the total variance. The darker color represents variance explained by the first principal component of each cluster. You may notice that in the grey cluster there is only darker color, not the lighter ones, this is because there is only one variable in that cluster - which will also be used as its first principal component. Even though we specified `minModuleSize=2`, sometimes there are variables left out by clustering and become a cluster of their own \n\nThe clusters are listed from left to right base on the number of variables in each cluster. The left side cluster has the most number of variables and right side cluster has the least number of variables.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nreduced_Omics2$score_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_6B-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\nAs the function specified, the scores are colored by education level, and the observations with different physical activity index are in different shape and people with different fasting glucose level are with different size.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nreduced_Omics2$loading_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_6C-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\nIn the loading plot, you can see that the loadings are all in the direction along the axis. This is because we use first principal components in each cluster. We cannot have the position of a loading in the direction of another axis since the another axis represents a different principal component analysis.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nreduced_Omics2$scoreloading_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_6D-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\nThe biplot with both score and loading looks a bit messy since there are so many things on the plot.\n\n\nWe then build a TPObject, which is used for saving information and pass them through steps in TriplotGUI.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nscores=reduced_Omics2$object$scores\nloadings<-reduced_Omics2$object$loadings\nvariance<- reduced_Omics2$object$variance\nTPObject1<-makeTPO(scores=scores,\n                   loadings=loadings,\n                   variance=variance)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMaking TriPlotObject (TPO)\n--------------------------\n\nScore matrix has 1000 observations and 5 components.\n\nTPO has 0 attached correlations.\nTPO has 0 attached risks.\n```\n:::\n:::\n\n\n## Step 2: Exposures’ correlations & Outcomes’ associations\n\nThe correlations between principal component (PC) scores and food items were calculated using Pearson correlations, adjusting for confounders. The associations between PC scores and risk markers were investigated using linear regression.\n\nCorrelation matrix of correlation coefficients and p values between the TPO scores saved in the TPObject and the dietary variables in the data is generated, using a pair-wise Pearson correlations, adjusting for confounders.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nCorrelations_object<-makeCorr(TPObject=TPObject1,\n                              corrData=exposure2,\n                              use='pairwise', \n                              # use inherit from cor() function \n                              method='pearson',\n                              # method inherit from cor() function \n                              allowcategorical=F,\n                              # one-hot-encoding on categorical exposures\n                              partial=T,\n                              # perform confonder adjustment\n                              confounder=covariates2)\n```\n:::\n\n\n::: callout-note\n-   `allowcategorical=F` performs one-hot-encoding to transform categorical exposures variables with n\\>2 classes to n binary variables. You can use `Correlations_object$cor_estimate` to check that each HFI level is separated in to a binary variable and the correlation coefficients between PCs and the binary variables were calculated. If `allowcategorical=T` is specified, then the `HFI` variable is forced as numeric variables. This is not recommended unless you are sure that the level itself reflects the numeric value.\n\n-   `partial=T` specifies that the confounders will be adjusted.\n:::\n\nThe result of correlations are then added into the TPObject.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nTPObject2<-addCorr(TPObject=TPObject1,\n                   Corr=Correlations_object$cor_estimate,\n                   Corr_p=Correlations_object$cor_pvalue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nAdding correlation to TPO\n-------------------------\nPlease ensure same number of components in TPO and correlation matrix\n\nTPO has 23 attached correlations.\nTPO has 0 attached risks.\n```\n:::\n:::\n\n\nMatrices of risk estimates and p values between the TPO scores saved in the TPObject and the outcome variables are generated, adjusting for confounders.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nRisks_object<-coefficient_get(TPObject=TPObject2,\n                              outcome=outcome2,\n                              confounder=covariates2,\n                              partial=T,\n                              # performs confounder adjustment\n                              multinomial=T,\n                              # multinomial regression is used\n                              pair=auxilary2$PairedInfo,\n                              # use the pairing information of case and control\n                              CI=0.95\n                              # confidence interval\n                              )\n```\n:::\n\n\n::: callout-note\n-   `partial=T` specifies that the confounders will be adjusted.\n-   When `pair` information is not provided:\n    -   `multinomial=F` means that one-hot-encoding will be performed to transform outcome's categorical variables with n \\> 2 classes to n binary variables. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.\n    -   If specifying `multinomial=T`, multinomial regression will be performed on outcome's categorical outcome variable with n \\> 2 classes, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.\n-   When `pair` information for case - control pair is provided:\n    -   `multinomial=F` means that one-hot-encoding will be performed on outcome's categorical variables with n \\> 2 classes. And then conditional logistic regression will be performed on the binary variables and linear mixed model will be performed on continuous variables, using the pairing information.\n    -   If specifying `multinomial=T`, the pairing information will not be ignored and used (since the outcomes can have more than 2 classes), multinomial regression will be performed on outcome's categorical variable, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.\n    \n:::\n\nThe result of risk estimates are then added into the TPObject.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nTPObject3<-addRisk(TPObject=TPObject2,\n                   Risk=Risks_object)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nAdding risk to TPO\n------------------\nPlease add risks one by one with component in rows and estimates, se:s and (optionally) p-values in columns\nPlease ensure same number of components in TPO and risk matrix\n\nTPO has 23 attached correlations.\nTPO has 5 attached risks.\n```\n:::\n:::\n\n\n## Step 3: Visualization of Triplot\n\nThen we can generate Triplot using the TPObject: Note that Triplot can be generated from any TPObject. You can try out different argument in the `TriplotGUI()` function. The function is a wrapper of `PCA_TriplotGUI()` and `WGCNA_TriplotGUI()`. You can view the functions respectively here: [`TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/TriplotGUI.R?ref_type=heads){target=\"_blank\"} [`PCA_TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCA_TriplotGUI.R?ref_type=heads){target=\"_blank\"} [`WGCNA_TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/WGCNA_TriplotGUI.R?ref_type=heads){target=\"_blank\"}\n\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nTriplot_object3<-TriplotGUI(TPObject3,\n                            first_PC=1,   ## The first PC to map\n                            second_PC=2,   ## The first PC to map\n                            plotLoads=TRUE,   \n                            ##Whether to plot loadings (TRUE; default) or suppress them (FALSE)\n                            plotScores=FALSE,   \n                            ##Whether to plot scores (TRUE) or suppress them (FALSE; default)\n                            plotCorr=TRUE,   \n                            ##Whether to plot correlations (TRUE; default) or suppress them (FALSE)\n                            plotRisk=TRUE,      \n                            ##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)\n                            ###############################################\n                            ##For loadings\n                            loadLabels=TRUE,   \n                            ###Whether to plot variable loading labels (TRUE; default) or not (FALSE)\n                            loadArrowLength=0.02,   \n                            ###Length of arrow tip , set it as 0 if you want to remove it\n                            loadCut=0,    \n                            ###lower limit Loadings below the cut are plotted in light grey and without label\n                            loadLim=NULL,   \n                            ##higher limit,Plot range for loadings\n                            ###############################################\n                            ##For correlations\n                            colCorr=\"blue\",   \n                            ##Color vector for correlations\n                            pchCorr=16,   \n                            ##Plotting character for correlations\n                            whichCorr=NULL,  \n                            ##Which correlations to plot (vector of numbers)\n                            corLim=NULL,     \n                            ##Plot range for correlations\n                            corrLabels = T,\n                            ###############################################\n                            ##For risks\n                            colRisk=\"red\",    \n                            ##Color vector for risk estimates\n                            pchRisk=15,    \n                            ##Plotting character for risk estimates\n                            whichRisk=NULL,  \n                            ##Which risk estimates to plot (vector of numbers)\n                            riskLim=NULL,            \n                            ##Plot range for risks\n                            riskWhisker_percentage=0.1,  \n                            ## whisker length is how many percentage of confidence interval\n                            riskLabels = T,\n                            size=3,\n                            # the size of points ont he plot\n                            riskOR=T\n                            # plot the risk estimates as odds ratio\n                            )\n```\n:::\n\n\n\n\nWe then plot the triplot\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object3$triplot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_10-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\nIn the triplot, blue circle points represent exposure correlations and the red square points represents outcome risk estimates with confidence interval. So what information can we get from this figure? Lets us list a few points:\n\n-  Having a brief look, the generally healthy food (e.g. `\"Fruits\"`, `\"Vegetables\"`) is on the first dimension of the figure and the generally unhealthy food (e.g. `\"Hamburger\"`, `\"Sausage\"`, `\"Margarine\"`) is on the third dimension of the figure. The numeric outcome `\"BMI\"`, binary outcome `\"T2D\"`, and one-hot-encoded categorical `\"BMI_cat\"` outcome is on the second and fourth dimension of the figure. \n-  Explanation on some variables in the plot:\n   -   `\"HFI\"` stands for healthy food index. A higher `\"HFI\"` suggests healthier diet. `\"HFI\"` ranges from 0 to 6. You can see that there are *HFI_0*, *HFI_1*...*HFI_6* in the figure and that is because `\"HFI\"` is used as a factor exposure variable in step 2 and is one-hot-encoded (`allowcategorical=F`) to the same number of binary variables as its number of levels. For example, *HFI_6* is a binary variable where individuals with `\"HFI\"` as 6 (most healthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. *HFI_0* is a binary variable where individuals with `\"HFI\"` as 0 (most unhealthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. *HFI_1*...*HFI_5* has limited use since it only separates the group of people with certain `\"HFI\"` value from to the rest, which is a mixture of healthier and less healthier diet people.\n   -   `\"BSDS\"` stands for Baltic Sea Diet Score ranging. A higher `\"BSDS\"` suggests healthier diet. `\"BSDS\"` is used as a numeric variable ranging from 2 to 25 in this step.\n   -   *BMI_cat_obese*, *BMI_cat_overweight*,*BMI_cat_underweight* are the odds ratio generated from the multinomial regression. Since `\"BMI_cat\"` is a categorical outcome and multinomial regression is performed in step 2 (`multinomial=T`), normal weight is uses as a reference and odds ratio of obese, overweight and underweight is produced. (Note that the first level of the factor variable is set as the default reference, in this case it is *normal*).\n-  Adjusting for `\"Age\"`, `\"Gender\"`, `\"Smoking\"`, `\"Education\"` and `\"FastingGlucose\"`, component from the first cluster (on x-axis) correlates positively with generally healthy food (e.g. `\"fruits\"`, `\"vegatables\"`) and food index (e.g. `\"BSDS\"`) and negatively with unhealthy food (e.g. `\"Hamburger\"`, `\"pizza\"`). It also reversely associated with `\"T2D\"` and `\"BMI\"`. From the result from `\"BMI_cat\"`, this components also reversely associated with being obese. \n-  Component from the second cluster (on y-axis) associated positively with generally healthy food (e.g. `\"fruits\"`, `\"vegatables\"`) and food index (e.g. `\"BSDS\"`) and negatively with unhealthy food (e.g. `\"Hamburger\"`, `\"pizza\"`). However, the component correlates also positively with `\"T2D\"`,`\"BMI\"`, *obese*, *overweight* and negatively associated with *underweight*. \n-  Based on what we summarized above, the two components may be associated with a overall healthy eating pattern. And in such pattern, the first component is associated more with the beneficial effect on health and the second component represents the adverse health effect that may be caused by this pattern.\n\nThere are many things you could explore further in the following mediation analysis. To narrow down our focus and clearly show our examples, we select `\"BSDS\"` (Baltic Sea Diet Score) and `\"Hamburger\"` as our exposures, `\"BMI\"` and `\"T2D\"` as outcome to enter our next step.\n\n\n## Step 4: Mediation analysis and visualization\n\nThis time, we perform the mediation analysis using the conterfactual/potential outcome method (the ´mediation´ package) on the our exposures (i.e. `\"BSDS\"`, `\"Hamburger\"`), mediators (i.e. the first PC of the first 2 clusters) and outcome (i.e. `\"T2D\"`, `\"BMI\"`) of interest, adjusting for `\"Age\"`, `\"Gender\"`, `\"Smoking\"`, `\"Education\"` and `\"FastingGlucose\"` for both exposure-mediator and mediator-outcome relationship.\n\n:::callout-note\nIn the counterfactual mediation analysis, you need to specify contrast values of treatment and controls for each exposure. In brief, the algorithm will compare the scenarios with these 2 exposure values/levels. For my detailed explanation please refer to [this paper](https://www.jstatsoft.org/article/view/v059i05){target=\"_blank\"} of the `mediation` R package.\n\nIf an exposure variable is continuous (numeric variable), it is recommended that the 2 exposure values is chosen between the range of the exposure variable. \nIf an exposure variable is categorical (factor variable), the 2 exposure levels should be chosen from the levels of the exposure variable.\n:::\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nmediation_object3<-\n  get_mediation_counterfactual (mediator=TPObject3$scores[,c(1:2),drop=F], \n                             # Specfiying at least 2 components so that there can be a 2-dimensional plot\n                             exposure=exposure2[,c(\"Hamburger\",\"BSDS\"),drop=F],\n                             outcome=outcome2[,c(\"BMI\",\"T2D\"),drop=F],\n                             exposure_treatment = c(25,19),\n                             exposure_control = c(2,0),\n                             confounder_ME=covariates2,\n                             confounder_OE=covariates2)\n```\n:::\n\n\nLook at the barplot to have a more direct view on direct, indirect and total effects for each combination of exposure, mediator(princial component) and outcome.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nmediation_plot_object3<-plot_mediation(mediation_object3,\n                                       cex=2\n                                       # size of the text\n                                       )\n```\n:::\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nmediation_plot_object3\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_11-1.png){width=100%}\n:::\n\n\n\n</details>\n:::\n\n\n::: callout-note\nThe barplot showed direct, indirect and total effect for each exposure-mediator-outcome combination. It is a convenient tool to check the direction and magnitude of mediation estimates. Red color represents significant positive effect (p\\<0.05); Blue color represents significant negative effect (p\\<0.05). Grey represents insignificant effect. One star for p\\<0.05; Two stars for p\\<0.01; Three stars for p\\<0.001;\n:::\n\nAdd the mediation result into the TPObject.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTPObject4<-add_mediation(TPObject3, mediation_object3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nAdding mediation to TPO\n-------------------------\nNote that the exposures, mediators and outcomes are selected and not necessarily reflect total number of variables\n\nTPO mediation has used 2 mediators, 2 exposures, 2 outcomes\nMediators are turquoise, blue \nExposures are Hamburger, BSDS \nOutcomes are BMI, T2D\n```\n:::\n:::\n\n\nMake the triplot with mediation. We showed the aruguments you could use in the function here with default values.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4 <-\n  mediation_triplot(\n    TPObject4,\n    which_show = c(\"APM\",\"PM\"),\n    ##Which mediation estimate to show\n    first_PC = 1,\n    ##The first PC to map\n    second_PC = 2,\n    ##The second PC to map\n    plotMed = TRUE,\n    ##Whether to plot mediation estimates (TRUE; default) or suppress them (FALSE)\n    plotCorr = TRUE,\n    ##Whether to plot correlations (TRUE; default) or suppress them (FALSE)\n    plotRisk = TRUE,\n    ##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)\n    ###############################################\n    ##For correlations\n    colCorr = \"blue\",\n    ##Color vector for correlations\n    pchCorr = 16,\n    ##Plotting character for correlations\n    corrLim = NULL,\n    ##Plot range for correlations\n    corrLabels = T,\n    ##Add labels on exposures\n    ###############################################\n    ##For risks\n    colRisk = \"red\",\n    ##Color vector for risk estimates\n    pchRisk = 15,\n    ##Plotting character for risk estimates\n    riskLim = NULL,\n    ##Plot range for risks\n    Whisker_percentage_risk = 0.1,\n    ##whisker length is how many percentage of confidence interval\n    riskLabels = T,\n    ##Add labels on outcomes\n    riskOR = T,\n    #plot the risk estimates as odds ratio\n    ###############################################\n    ##For mediations\n    colmed = \"darkgreen\",\n    ##Color vector for mediation estimates\n    pchmed = 17,\n    ##Plotting character for mediation estimates\n    medLim = NULL,\n    ##Plot range for mediations\n    Whisker_percentage_med= 0.1,\n    ##whisker length is how many percentage of confidence interval\n    medLabels = T,\n    ##Add labels on mediation estimates\n    #########################################\n    \n    size = 3\n    # the size of points ont he plot\n  )\n```\n:::\n\n\nOnly showing the mediation estimates (indirect and total effect).\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4$mediation_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_13-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\nThe proportion mediated (PM) and adjusted proportion mediated(APM) is presented as triangle points on the mediation plot, this is because we specified that we only want to show them using `which_show = c(\"PM\", \"APM\")` in the `mediation_triplot()` function. \n\nThe plot is a bit messy, all the points are crowded together, you could specify `which_show = c(\"PM\")` and `which_show = c(APM\")` respectively and re-run the `mediation_triplot()` function to see proportion mediated and adjusted proportion mediated separately.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4 <-\n  mediation_triplot(\n    TPObject4,\n    which_show = c(\"PM\")\n  )\n```\n:::\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4$mediation_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_13B-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\nWe could see four data points on the figure, which represents the eight combinations of exposures, mediators and outcomes.\n\n-   exposure=BSDS, mediator= component 1, outcome=BMI\n-   exposure=BSDS, mediator= component 2, outcome=BMI\n-   exposure=Hamburger, mediator= component 1, outcome=BMI\n-   exposure=Hamburger, mediator= component 2, outcome=BMI\n-   exposure=BSDS, mediator= component 1, outcome=T2D\n-   exposure=BSDS, mediator= component 2, outcome=T2D\n-   exposure=Hamburger, mediator= component 1, outcome=T2D\n-   exposure=Hamburger, mediator= component 2, outcome=T2D\n\nWe could view from the confidence intervals on the figure already that some PM is not significant. A huge confidence interval presented on the plot has pushed the triangle points to the origin. If we want to zoom in and see which dimensions the points are in in the visualization.\n\nWe therefore adjust the limit of the proportion mediated to zoom in on the points. `\"medLim = 2.5\"` means that the limit showing on the plot will be from -2.5 to 2.5. \n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4 <-\n  mediation_triplot(\n    TPObject4,\n    which_show = c(\"PM\"),\n    medLim = 2.5\n  )\n```\n:::\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4$mediation_plot\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 3 rows containing missing values (`geom_errorbarh()`).\n```\n:::\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_13D-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\nIn the figure, we could see the direction and magnitude of proportion mediated for the 2 mediators, all the exposures and outcomes. We also notice that the PM for BSDS-component 1-BMI and BSDS-component 2-BMI mediation is significant.\n\n::: callout-note\n-   Note that some confidence intervals are automatically removed from the figure if they are not within the limit. \n-   Note that for some mediations, direct effect and indirect effects are in the opposite direction, implying possibly proportion mediated(PM)>1, since total effect could smaller than indirect effect.\n:::\n\nwe then further look at the adjusted proportion mediated (APM).\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4 <-\n  mediation_triplot(\n    TPObject4,\n    which_show = c(\"APM\")\n  )\n```\n:::\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4$mediation_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_13F-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\n\nBy observing this figure, we could see the direction and magnitude of adjusted proportion mediated for the 2 mediators, all the exposures and outcomes. The position of the points is similar what we have seen for proportion mediated. Note that APM for BSDS as exposure and T2D as outcome is smaller than their PM. This is because the indirect and direct effect for this mediation is of similar size but in opposite direction. This leads to a smaller total effect and in turn larger PM, but APM will not be affected  by the directionality of direct and indirect effect.\n\n\n::: callout-note\n-   No confidence interval is shown for adjusted proportion mediated, as such value can not be directly calculated from the mediation analysis.\n\n-   Note that even direct effect and indirect effects are in the opposite direction, adjusted proportion mediated is always smaller than 1, since it uses the sum of the absolute value of indirect and direct effect as denominator.\n$$APM=\\frac{IE}{|IE|+|DE|}\\cdot\\frac{|IE+DE|}{IE+DE}=\\frac{IE}{IE+DE}\\cdot\\frac{|IE+DE|}{|IE|+|DE|}=\\frac{IE}{IE+DE}\\cdot\\frac{|IE|+|DE|}{|IE+DE|}$$\n:::\n\n::: callout-note\nIf you want, you could specify `which_show = c(\"PM\", \"APM\", \"IE\",\"DE\",\"TE\")` in the `mediation_troplot()` to show all the estimates (IE for indirect effect, DE for direct effect and TE for total effect). However, it is not recommended, since the plot will get even messier if you put estimates and proportion mediated on the same plot. \n\nIf you go to [Tutorial(simple)](simple_code.qmd){target=\"_blank\"}, you can view the plot when showing `\"IE\"` and `\"TE\"`.\n:::\n\n\n\nPlotting the triplot with mediation,\n\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object4$final_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_14-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\n\nBase on the barplot and the triplot with mediation, we have observed significant proportion mediated for BSDS-component1/2-BMI mediations. Further exploration on indirect, direct and total effect of the mediation analysis could be explored by playing around the `which_show` argument in the `mediation_troplot()` function. We will not go into details here.\n\n## Step 5: Compare correlations, associations and mediations\n\nUsers can check the heatmaps of correlations, risk estimations and mediation results from the TPObject through the `checkTPO_ggplot()` function in TriplotGUI.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\ncheckTPObject4<-checkTPO_ggplot(TPObject4,\n                                which_med=c(\"IE\",\"DE\",\"TE\",\"PM\",\"APM\"),\n                                ## What type of mediation estimate or proportion mediated to show on the heatmap\n                                which_PC=c(\"turquoise\", \"blue\"),\n                                ## What meditor (principal component) you want to show\n                                which_corr=c(\"Hamburger\",\"BSDS\"),\n                                ## What exposure variable you want to show\n                                which_risk=c(\"T2D\",\"BMI\")\n                                ## What outcome variable you want to show\n                                )\n```\n:::\n\n\nCorrelation coefficients and p values between PC scores and exposures:\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\ncheckTPObject4$corr_coefficients\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_15A-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\n\nRisk estimates(beta coefficients) and p values between PC scores and outcomes:\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\ncheckTPObject4$risk_coefficients\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_15B-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\n\nMediation estimates and p values for indirect effect(IE), direct effect(DE) and total effect(TE), proportion mediated(PM) and adjusted proportion mediated(APM): See [Details](workflow.qmd){target=\"_blank\"} for more details:\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\ncheckTPObject4$med_coefficients\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_15C-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\n\nYou could also View the three plots aboved combinedly.\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\ncheckTPObject4$corr_risk_med_coefficients\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_15D-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\n\n\n\n::: callout-note\n-   One star for p\\<0.05; Two stars for p\\<0.01; Three stars for p\\<0.001.\n-   Note that in the plot of `checkTPbject4$med_coefficients`, only the selected exposures, mediators and outcomes that we use to do mediation on will show up. The rows in the heatmaps are mediators and the column represents exposure-outcome pairs. For each exposure_outcome pair, 5 result are shown: *IE* (indirect effect), *DE* (direct effect), *TE* (total effect), *PM*(Proportion Mediated) and *APM*(Adjusted Proportion Mediated). Please see [Details section](https://yingxiaoyan.gitlab.io/triplotgui_tutorial/workflow.html#5.2){target=\"_blank\"} for more information. The \"CF\" before the names of exposures-outcome pairs means that this mediation is using the Counterfactual method.\n:::\n\n## Step 6: Download data\n\nWe can save all your output, including data, results and visualization output through the `save()` function as an rda file.\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nsave(exposure2,Omics2,outcome2,covariates2,auxilariy2,\n     reduced_Omics2,Correlations_object,Risks_objects,\n     mediation_object3,mediation_plot_object3,\n     TPObject1,TPObject2,TPObject3,TPObject4,\n     checkTPObject4,\n     \"Tutorial_complex_output.rda\")\n```\n:::\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\n#don't run code, but show code\n3\n```\n:::\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\n#run code, and show code, don't show output\n4\n```\n:::\n\n::: {.cell .styled-output}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3\n```\n:::\n:::\n\n::: {.cell .styled-output}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#run code, and show code, and show output\n5\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5\n```\n:::\n\n```{.r .cell-code}\ns<-function(x){x+1}\ns(23)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 24\n```\n:::\n:::\n",
    "supporting": [
      "complex_code_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}