{
  "hash": "1f0a9ae9b8ffaafa8637288fcd7d2b2e",
  "result": {
    "markdown": "---\ntitle: \"Tutorial(complex) - Code\"\nsubtitle: \"Complex demo of using code in TriplotGUI\"\ntitle-block-banner: true\ntitle-block-banner-color: white\ntitle-block-categories: false\n\npage-layout: full\nformat:\n  html: \n    margin-top: 0em\n    margin-bottom: 0em\n    padding-top: 0em\n    padding-bottom: 0em\n    minimal: true\n    smooth-scroll: true\n    fig-responsive: true\n    toc-location: right\n    toc-depth: 5\n    toc-title: Tutorial\n    number-sections: true  ## add number in the session or not\n    number-depth: 4\n    code-fold: show\n    code-summary: \"Show the code\"\n    code-overflow: wrap\n    code-tools: true\n    code-copy: true\n    highlight: tango\n    df-print: paged  ## kable is another option How the dataframe looks like \n    standalone: false  ### specifies if all assets and libraries must be integrated into the output html file as a standalone document.\n    fig-align: right\n    theme:  solar\ngeometry: margin=lin  \n---\n\n\n\n\nBefore starting,please make sure you have installed the TriplotGUI package following [Setup](installation.qmd){target=\"_blank\"}.\n\nThe code of at this page can be downloaded [here](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/HealthyNordicDiet_2_applying_TriplotGUI_code.R){target=\"_blank\"}\n\n# Data description\n\nThe data used in this page of tutorial can be downloaded [here](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda){target=\"_blank\"} in rda format.\n\nThe Data used for this example of code is ***HealthyNordicDiet_2***. This is a synthetic dataset that was simulated from the authentic data used in a case/control study nested within the Swedish prospective Västerbotten Intervention Programme cohort. The original study was set up to explore plasma metabolites that could objectively reflect healthy Nordic dietary patterns in a matched case-control study and to assess associations between such patterns and later development of type 2 diabetes. (Shi et al. 2018). The simulated data ***HealthyNordicDiet_2*** is a list that contains three data frames:\n\n-   Clinical measurements (ClinData, 11 variables): `\"ID\"`,`\"T2D\"`(Cases and controls for type 2 diabetes), `\"PairedInfo\"`(Pairing information for case and controls),`\"Energy\"`,`\"Gender\"`,`\"Age\"`,`\"BMI\"`,`\"Smoking\"`,`\"PhysicalActivityIndex\"`,`\"Education\"`,`\"FastingGlucose\"`.\\\n-   Plasma metabolites predictive of BMI (MetaboliteData, 20 variables)\n-   Dietary intake as measured by food frequency questionnaires (FoodData, 11 variables): `\"HFI\"`( Healthy Food Index),`\"BSDS\"`(the Baltic Sea Diet Score),`\"Wholegrains\"`,`\"Sausage\"`,`\"Pizza\"`,`\"Refined.bread\"`, `\"Fruits\"`,`\"Liquor\"`,`\"Wine\"`,`\"Hamburger\"`,`\"Poultry\"`,`\"Fish\"`,`\"Margarine\"`,`\"Cabbage\"`,`\"Carrot\"`,`\"low_fat_Dairy\"`,`\"Vegetables\"`\n\nThe data frames are row-wise matched by observation and consist of 1000 synthetic observations.\n\n**Reference**\n\nShi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., & Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. The American Journal of Clinical Nutrition, 108(3), 564-575. [10.1093/ajcn/nqy145](https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub){target=\"_blank\"}\n\nSchillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. Metabolites. 2019 Jul 6;9(7):133. [doi: 10.3390/metabo9070133](https://www.mdpi.com/2218-1989/9/7/133){target=\"_blank\"}\n\n# Research question\n\nWe want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI.\n\n# Data exploration\n\n***HealthyNordicDiet_2*** is loaded in the R environment up on running `library(TriplotGUI)`. We will do some data exploration first to see how the data looks like.\n\n\n::: {.cell .styled-output}\n\n:::\n\n\n## Check HealthyNordicDiet_2\n\nCheck ***HealthyNordicDiet_2*** as a list:\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nclass(HealthyNordicDiet_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"list\"\n```\n:::\n\n```{.r .cell-code}\nnames(HealthyNordicDiet_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ClinData\"       \"MetaboliteData\" \"FoodData\"      \n```\n:::\n:::\n\n\n## Check datasets\n\nCheck the names of variables in each data:\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\ncolnames(HealthyNordicDiet_2$ClinData)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"ID\"                    \"T2D\"                   \"PairedInfo\"           \n [4] \"Energy\"                \"Gender\"                \"Age\"                  \n [7] \"BMI\"                   \"Smoking\"               \"PhysicalActivityIndex\"\n[10] \"Education\"             \"FastingGlucose\"       \n```\n:::\n\n```{.r .cell-code}\ncolnames(HealthyNordicDiet_2$MetaboliteData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Pipecolic.acid.betaine\"         \"lysoPC.18.0.\"                  \n [3] \"HP143.1179.1.55\"                \"lysoPE.22.6.\"                  \n [5] \"HN151.0065.4.97\"                \"RP225.1482.9.15\"               \n [7] \"X3.4.5.Trimethoxycinnamic.acid\" \"DHA\"                           \n [9] \"RP383.1671.10.53\"               \"gama.tocopherol\"               \n[11] \"RP431.3516.11.96\"               \"RP490.3516.8.99\"               \n[13] \"lysoPC.22.6.\"                   \"Steroid.glucuronide\"           \n[15] \"RP684.5545.13.41\"               \"RP197.0926.3.17\"               \n[17] \"RP303.6468.9.98\"                \"RP816.5684.12.52\"              \n[19] \"RP827.5356.11.88\"               \"RP826.5442.12.17\"              \n[21] \"RN201.1498.8.23\"                \"RN203.0022.3.00\"               \n[23] \"EPA\"                            \"PC.18.2.15.0.\"                 \n[25] \"RN814.5610.12.14\"               \"RN153.0190.3.5\"                \n[27] \"RN427.1641.10.59\"               \"RN457.1742.10.50\"              \n[29] \"RN830.5845.12.46\"               \"RN446.1541.10.59\"              \n[31] \"RN472.1596.10.53\"              \n```\n:::\n\n```{.r .cell-code}\ncolnames(HealthyNordicDiet_2$FoodData)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"HFI\"           \"BSDS\"          \"Wholegrains\"   \"Sausage\"      \n [5] \"Pizza\"         \"Refined.bread\" \"Fruits\"        \"Liquor\"       \n [9] \"Wine\"          \"Hamburger\"     \"Poultry\"       \"Fish\"         \n[13] \"Margarine\"     \"Cabbage\"       \"Carrot\"        \"low_fat_Dairy\"\n[17] \"Vegetables\"   \n```\n:::\n:::\n\n\n## Check variables' class\n\nWe Transform the data to dataframe format and then use TriplotGUI's `checkdata()` function in to examine the class of variables.\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nClinData<-as.data.frame(HealthyNordicDiet_2$ClinData)\nMetaboliteData<-as.data.frame(HealthyNordicDiet_2$MetaboliteData)\nFoodData<-as.data.frame(HealthyNordicDiet_2$FoodData)\n\nClinData_check<-checkdata(ClinData)\nMetaboliteData_check<-checkdata(MetaboliteData)\nFoodData_check<-checkdata(FoodData)\n```\n:::\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nClinData_check$class_sumamry_statistics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$check_class_vector\n                   ID                   T2D            PairedInfo \n            \"numeric\"              \"factor\"              \"factor\" \n               Energy                Gender                   Age \n            \"numeric\"              \"factor\"             \"numeric\" \n                  BMI               Smoking PhysicalActivityIndex \n            \"numeric\"              \"factor\"              \"factor\" \n            Education        FastingGlucose \n             \"factor\"             \"numeric\" \n\n$check_class_table\ncheck_class_vector\n factor numeric \n      6       5 \n```\n:::\n\n```{.r .cell-code}\nMetaboliteData_check$class_sumamry_statistics$check_class_table\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncheck_class_vector\nnumeric \n     31 \n```\n:::\n\n```{.r .cell-code}\nFoodData_check$class_sumamry_statistics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$check_class_vector\n          HFI          BSDS   Wholegrains       Sausage         Pizza \n     \"factor\"     \"numeric\"     \"numeric\"     \"numeric\"     \"numeric\" \nRefined.bread        Fruits        Liquor          Wine     Hamburger \n    \"numeric\"     \"numeric\"     \"numeric\"     \"numeric\"     \"numeric\" \n      Poultry          Fish     Margarine       Cabbage        Carrot \n    \"numeric\"     \"numeric\"     \"numeric\"     \"numeric\"     \"numeric\" \nlow_fat_Dairy    Vegetables \n    \"numeric\"     \"numeric\" \n\n$check_class_table\ncheck_class_vector\n factor numeric \n      1      16 \n```\n:::\n:::\n\n\n::: callout-note\nNote that `\"HFI\"`(Healthy Food Index) is used as a factor variable and `\"BSDS\"`(the Baltic Sea Diet Score) is used as a numeric variable. You could use `table(FoodData$HFI)` and `table(FoodData$BSDS)` to check the difference.\n:::\n\n## Check sanities for variables\n\nWhether each variable contains missing (NA) or abnormal values (e.g. NAN, Inf, blank value) can also be checked\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nClinData_check$everycolumn\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"ID\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T2D\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PairedInfo\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Energy\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Gender\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Age\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BMI\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Smoking\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PhysicalActivityIndex\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Education\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"FastingGlucose\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"NA_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"NA_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"NaN_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"NaN_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"negative_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"negative_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"zero_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"zero_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"inf_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"inf_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"blank_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"_rn_\":\"blank_percentage\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nMetaboliteData_check$everycolumn\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Pipecolic.acid.betaine\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lysoPC.18.0.\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"HP143.1179.1.55\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lysoPE.22.6.\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"HN151.0065.4.97\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP225.1482.9.15\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"X3.4.5.Trimethoxycinnamic.acid\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"DHA\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP383.1671.10.53\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gama.tocopherol\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP431.3516.11.96\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP490.3516.8.99\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lysoPC.22.6.\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Steroid.glucuronide\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP684.5545.13.41\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP197.0926.3.17\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP303.6468.9.98\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP816.5684.12.52\"],\"name\":[18],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP827.5356.11.88\"],\"name\":[19],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RP826.5442.12.17\"],\"name\":[20],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN201.1498.8.23\"],\"name\":[21],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN203.0022.3.00\"],\"name\":[22],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"EPA\"],\"name\":[23],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"PC.18.2.15.0.\"],\"name\":[24],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN814.5610.12.14\"],\"name\":[25],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN153.0190.3.5\"],\"name\":[26],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN427.1641.10.59\"],\"name\":[27],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN457.1742.10.50\"],\"name\":[28],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN830.5845.12.46\"],\"name\":[29],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN446.1541.10.59\"],\"name\":[30],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"RN472.1596.10.53\"],\"name\":[31],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"NA_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"NA_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"NaN_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"NaN_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"negative_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"negative_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"zero_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"zero_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"inf_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"inf_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"blank_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"0\",\"8\":\"0\",\"9\":\"0\",\"10\":\"0\",\"11\":\"0\",\"12\":\"0\",\"13\":\"0\",\"14\":\"0\",\"15\":\"0\",\"16\":\"0\",\"17\":\"0\",\"18\":\"0\",\"19\":\"0\",\"20\":\"0\",\"21\":\"0\",\"22\":\"0\",\"23\":\"0\",\"24\":\"0\",\"25\":\"0\",\"26\":\"0\",\"27\":\"0\",\"28\":\"0\",\"29\":\"0\",\"30\":\"0\",\"31\":\"0\",\"_rn_\":\"blank_percentage\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nFoodData_check$everycolumn\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"HFI\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BSDS\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Wholegrains\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sausage\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pizza\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Refined.bread\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Fruits\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Liquor\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Wine\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Hamburger\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Poultry\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Fish\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Margarine\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Cabbage\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Carrot\"],\"name\":[15],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"low_fat_Dairy\"],\"name\":[16],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Vegetables\"],\"name\":[17],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"NA_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"NA_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"NaN_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"NaN_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"negative_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"negative_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"63.000\",\"4\":\"139.000\",\"5\":\"195.000\",\"6\":\"155.000\",\"7\":\"180.00\",\"8\":\"367.000\",\"9\":\"288.000\",\"10\":\"231.000\",\"11\":\"117.000\",\"12\":\"79.000\",\"13\":\"41.000\",\"14\":\"253.000\",\"15\":\"225.000\",\"16\":\"237.000\",\"17\":\"192.000\",\"_rn_\":\"zero_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.063\",\"4\":\"0.139\",\"5\":\"0.195\",\"6\":\"0.155\",\"7\":\"0.18\",\"8\":\"0.367\",\"9\":\"0.288\",\"10\":\"0.231\",\"11\":\"0.117\",\"12\":\"0.079\",\"13\":\"0.041\",\"14\":\"0.253\",\"15\":\"0.225\",\"16\":\"0.237\",\"17\":\"0.192\",\"_rn_\":\"zero_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"inf_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"inf_percentage\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"blank_number\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.00\",\"8\":\"0.000\",\"9\":\"0.000\",\"10\":\"0.000\",\"11\":\"0.000\",\"12\":\"0.000\",\"13\":\"0.000\",\"14\":\"0.000\",\"15\":\"0.000\",\"16\":\"0.000\",\"17\":\"0.000\",\"_rn_\":\"blank_percentage\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n::: callout-note\nYou shall only continue when the class of variables are correct and the missing or abnormal values in the variable are properly handled.\n:::\n\n## Build data for analysis\n\nWe see food data as our exposures and BMI and type 2 diabetes as outcomes. Note that BMI is a continuous variable. We can additionally construct BMI as a categorical outcome using the criteria below and see how this may differ the result. \n-   BMI<= 18.5: Underweight\n-   18.5<BMI<= 25: Normal \n-   25< BMI<= 30: Overweight \n-   30< BMI: Obese\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nBMI<-ClinData[,\"BMI\"]\nBMI_cat<-vector(length=length(BMI))\nfor(i in 1:length(BMI)){\n  if(BMI[i]<=18.5){\n    BMI_cat[i]<-\"underweight\"\n  }else if (BMI[i]>18.5&BMI[i]<=25){\n    BMI_cat[i]<-\"normal\"\n  }else if(BMI[i]>25&BMI[i]<=30){\n    BMI_cat[i]<-\"overweight\"\n  }else{\n    BMI_cat[i]<-\"obese\"\n  }\n}\nBMI_cat<-as.factor(BMI_cat)\n```\n:::\n\n\nWe want to explore the exposure-outcome relationships through the metabolomics data, using metabolites as assumed mediators. Gender, age, education, physical activity and smoking are used as potential confounders for exposure-mediator and mediator-outcome association. Auxiliary information regarding case-control pairs, fasting glucose level, education and physical activity  are also provided.\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\nexposure2<-FoodData\nOmics2<-MetaboliteData\noutcome2<-cbind.data.frame(ClinData[,c(\"T2D\",\"BMI\")],BMI_cat)\ncovariates2<-ClinData[,c(\"Gender\" ,\"Age\",\"Education\",\"PhysicalActivityIndex\",\"Smoking\" )]\nauxilary2<-ClinData[,c(\"PairedInfo\",\"FastingGlucose\",\"Education\",\"PhysicalActivityIndex\", \"Energy\")]\n```\n:::\n\n\n# Code example of using TriplotGUI\n\nWe will use a complex settings in this example. Please go to [Tutorial(simple)](simple_code.qmd){target=\"_blank\"}.if you want to try simple settings.\n\n## Step 1: Data reduction of omics data {#simple_link}\n\nUsing `TriplotGUI` package, first we perform dimension reduction, using weighted correlation network analysis (WGCNA) on metabolomics data.\n\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\n#* USing the most simple settings\nreduced_Omics2<-PCAorWGCNA_plots(dataframe=Omics2,\n\n                                 plottype=c(\"scree\",\"score\",\"loading\",\"scoreloading\"),\n                                 pc_type=\"principal\", \n                                 # Use principal() instead of prcomp() to perform PCA\n                                 first_PC=1,\n                                 second_PC=2,\n                                 option=\"WGCNA\",\n                                 scale=T,\n                                 center=T,\n                                 eigen_loading=\"loading\",\n                                 rotate=\"none\",\n                                 size_variable=auxilary2$FastingGlucose,\n                                 size_variable_name=\"FastigGlucose\",\n                                 color_variable=auxilary2$Education,\n                                 color_variable_name=\"Education\",\n                                 shape_variable=auxilary2$PhysicalActivityIndex,\n                                 shape_variable_name=\"PhysicalActivityIndex\",\n                                 scale_scoreloading=T,\n                                 loadings_name=T,\n                                 loadings_cutvalue=NULL,\n                                 loadings_cutpercent=0.2,\n                                 minModuleSize=2)\n```\n:::\n\n\n::: callout-note\nYou could try out the arguments of the `PCAorWGCNA_plots()` function and view the whole function [here](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCAorWGCNA_plots.R?ref_type=heads){target=\"_blank\"}\n:::\n\nYou can see scree plot, score plot, loadings plot and biplot at this stage.\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nreduced_Omics2$scree_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_6-1.png){width=672}\n:::\n\n\n\n</details>\n\n```{.r .cell-code}\nreduced_Omics2$score_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_6-2.png){width=672}\n:::\n\n\n\n</details>\n\n```{.r .cell-code}\nreduced_Omics2$loading_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_6-3.png){width=672}\n:::\n\n\n\n</details>\n\n```{.r .cell-code}\nreduced_Omics2$scoreloading_plot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_6-4.png){width=672}\n:::\n\n\n\n</details>\n:::\n\n\nWe then build a TPObject, which is used for saving information and pass them through steps in TriplotGUI.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nscores=reduced_Omics2$object$scores\nloadings<-reduced_Omics2$object$loadings\nvariance<- reduced_Omics2$object$variance\nTPObject1<-makeTPO(scores=scores,\n                   loadings=loadings,\n                   variance=variance)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nMaking TriPlotObject (TPO)\n--------------------------\n\nScore matrix has 1000 observations and 6 components.\n\nTPO has 0 attached correlations.\nTPO has 0 attached risks.\n```\n:::\n:::\n\n\n## Step 2: Exposures’ correlations & Outcomes’ associations\n\nThe correlations between principal component (PC) scores and food items were calculated using Pearson correlations, adjusting for confounders. The associations between PC scores and risk markers were investigated using linear regression.\n\nCorrelation matrix of correlation coefficients and p values between the TPO scores saved in the TPObject and the dietary variables in the data is generated, using a pair-wise Pearson correlations, adjusting for confounders.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nCorrelations_object<-makeCorr(TPObject=TPObject1,\n                              corrData=exposure2,\n                              use='pairwise',\n                              method='pearson',\n                              allowcategorical=F,\n                              partial=T,\n                              confounder=covariates2)\n```\n:::\n\n\n::: callout-note\n-   `allowcategorical=F` performs one-hot-encoding to transform categorical exposures variables with n>2 classes to n binary variables. You can use `Correlations_object$cor_estimate` to check that each HFI level is separated in to a binary variable and the correlation coefficients between PCs and the binary variables were calculated. If `allowcategorical=T` is specified, then the `HFI` variable is forced as numeric variables. This is not recommended unless you are sure that the level itself reflect the numeric value.\n\n-   `partial=T` specifies that the confounders will be adjusted.\n:::\n\nThe result of correlations are then added into the TPObject.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nTPObject2<-addCorr(TPObject=TPObject1,\n                   Corr=Correlations_object$cor_estimate,\n                   Corr_p=Correlations_object$cor_pvalue)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nAdding correlation to TPO\n-------------------------\nPlease ensure same number of components in TPO and correlation matrix\n\nTPO has 23 attached correlations.\nTPO has 0 attached risks.\n```\n:::\n:::\n\n\nMatrices of risk estimates and p values between the TPO scores saved in the TPObject and the outcome variables are generated, adjusting for confounders.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nRisks_object<-coefficient_get(TPObject=TPObject2,\n                              outcome=outcome2,\n                              confounder=covariates2,\n                              partial=T,\n                              multinomial=T,\n                              pair=auxilary2$PairedInfo,\n                              CI=0.95)\n```\n:::\n\n\n::: callout-note\n-   `partial=T` specifies that the confounders will be adjusted.\n-   When `pair` information is not provided: \n    -   `multinomial=F` means that one-hot-encoding will be performed to transform categorical variables with n > 2 classes to n binary variables. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables. \n    -   If specifying `multinomial=T`, multinomial regression will be performed on the categorical outcome variable with n > 2 classes, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables. \n-   When `pair` information for case - control pair is provided:\n    -  `multinomial=F` means that one-hot-encoding will be performed on categorical variables with n > 2 classes. And then conditional logistic regression will be performed on the binary variables and linear mixed model will be performed on continuous variables, using the pairing information.\n    -   If specifying `multinomial=T`, the pairing information will not be ignored and used (since the outcomes can have more than 2 classes), multinomial regression will be performed on the categorical outcome variable, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables. \n\n:::\n\nThe result of risk estimates are then added into the TPObject.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nTPObject3<-addRisk(TPObject=TPObject2,\n                   Risk=Risks_object)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nAdding risk to TPO\n------------------\nPlease add risks one by one with component in rows and estimates, se:s and (optionally) p-values in columns\nPlease ensure same number of components in TPO and risk matrix\n\nTPO has 23 attached correlations.\nTPO has 5 attached risks.\n```\n:::\n:::\n\n\n## Step 3: Visualization of Triplot\n\nGenerate Triplot: Note that Triplot can be generated from any TPObject. You can try out different argument in the `TriplotGUI()` function. The function is a wrapper of `PCA_TriplotGUI()` and `WGCNA_TriplotGUI()`. You can view the functions respectively here: \n[`TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/TriplotGUI.R?ref_type=heads){target=\"_blank\"}\n[`PCA_TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCA_TriplotGUI.R?ref_type=heads){target=\"_blank\"}\n[`WGCNA_TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/WGCNA_TriplotGUI.R?ref_type=heads){target=\"_blank\"}\n\nIn this example we use WGCNA to perform data reduction, therefore specifying `option=\"WGCNA\"`.\n\n\n::: {.cell .styled-output fold.output='false'}\n\n```{.r .cell-code}\nTriplot_object3<-TriplotGUI(TPObject3,\n                            first_PC=1,   ## The first PC to map\n                            second_PC=2,   ## The first PC to map\n                            plotLoads=TRUE,   ##Whether to plot loadings (TRUE; default) or suppress them (FALSE)\n                            plotScores=FALSE,   ##Whether to plot scores (TRUE) or suppress them (FALSE; default)\n                            plotCorr=TRUE,   ##Whether to plot correlations (TRUE; default) or suppress them (FALSE)\n                            plotRisk=TRUE,      ##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)\n                            ##For loadings\n                            loadLabels=TRUE,   ###Whether to plot variable loading labels (TRUE; default) or not (FALSE)\n                            loadArrowLength=0.02,   ###Length of arrow tip , set it as 0 if you want to remove it\n                            loadCut=0,    ###lower limit Loadings below the cut are plotted in light grey and without label\n                            loadLim=NULL,   ##higher limit,Plot range for loadings\n                            ##For correlations\n                            colCorr=\"blue\",   ##Color vector for correlations\n                            pchCorr=16,   ##Plotting character for correlations\n                            whichCorr=NULL,   ##Which correlations to plot (vector of numbers)\n                            corLim=NULL,     ##Plot range for correlations\n                            corrLabels = T,\n                            ##For risks\n                            colRisk=\"red\",    ##Color vector for risk estimates\n                            pchRisk=15,    ##Plotting character for risk estimates\n                            whichRisk=NULL,  ##Which risk estimates to plot (vector of numbers)\n                            riskLim=NULL,            ##Plot range for risks\n                            riskWhisker_percentage=0.1,  ## whisker length is how many percentage of confidence interval (This is only for the visualization purpose)\n                            riskLabels = T,\n                            size=3,\n                            riskOR=T)\n```\n:::\n\n\nPlotting the triplot\n\n\n::: {.cell .styled-output fold.plot='true'}\n\n```{.r .cell-code}\nTriplot_object3$triplot\n```\n\n<details><summary>plot</summary>\n\n::: {.cell-output-display}\n![](complex_code_files/figure-html/showcode_runcode_showoutput_10-1.png){width=672}\n:::\n\n\n\n</details>\n:::\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\n#don't run code, but show code\n3\n```\n:::\n\n::: {.cell .styled-output}\n\n```{.r .cell-code}\n#run code, and show code, don't show output\n4\n```\n:::\n\n::: {.cell .styled-output}\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3\n```\n:::\n:::\n\n::: {.cell .styled-output}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#run code, and show code, and show output\n5\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5\n```\n:::\n\n```{.r .cell-code}\ns<-function(x){x+1}\ns(23)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 24\n```\n:::\n:::\n\n\nFOR REFERENCE: `<svg aria-label=\"Graduation Cap\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#98A08D;overflow:visible;position:relative;\"><title>Graduation Cap</title><path d=\"M320 32c-8.1 0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9v28.1c0 28.4-10.8 57.7-22.3 80.8c-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3 .9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7 .3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7C90.3 344.3 86 329.8 80 316.5V291.9c0-30.2 10.2-58.7 27.9-81.5c12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5 .8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1L624.2 182.6c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z\"/></svg>`{=html} \\# stopped working 5/1/2023?\n",
    "supporting": [
      "complex_code_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}