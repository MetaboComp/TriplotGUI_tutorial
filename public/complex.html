<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>TriplotGUI  - Tutorial(complex)- User Interface</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/TriplotGUI_logo_white.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 5,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
      }
</style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="styles.scss">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/TriplotGUI_logo_black.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">TriplotGUI <i class="fa-brands fa-gitlab" aria-label="gitlab"></i></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./introduction.html" rel="" target="">
 <span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./installation.html" rel="" target="">
 <span class="menu-text">Setup</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workflow.html" rel="" target="">
 <span class="menu-text">Manual</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorial(simple" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tutorial(simple)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorial(simple">
<li>
    <a class="dropdown-item" href="./simple.html" rel="" target="">
 <span class="dropdown-text">User Interface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simple_code.html" rel="" target="">
 <span class="dropdown-text">Code</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorial(complex" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tutorial(complex)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorial(complex">
<li>
    <a class="dropdown-item" href="./complex.html" rel="" target="">
 <span class="dropdown-text">User Interface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./complex_code.html" rel="" target="">
 <span class="dropdown-text">Code</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./papers.html" rel="" target="">
 <span class="menu-text">Papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About us</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/" rel="" target=""><i class="bi bi-folder-symlink" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/yingxiao-yan" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:yingxiao@chalmers.se" rel="" target=""><i class="bi bi-envelope" role="img" aria-label="email">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Tutorial(complex)- User Interface</h1>
            <p class="subtitle lead">Complex demo of using user interface in TriplotGUI</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Tutorial</h2>
   
  <ul>
<li><a href="#data-description" id="toc-data-description" class="nav-link active" data-scroll-target="#data-description">Data description</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question">Research question</a></li>
  <li>
<a href="#the-use-of-interface" id="toc-the-use-of-interface" class="nav-link" data-scroll-target="#the-use-of-interface">The use of interface</a>
  <ul>
<li><a href="#step-1-data-reduction-of-omics-data-and-auxiliary-data" id="toc-step-1-data-reduction-of-omics-data-and-auxiliary-data" class="nav-link" data-scroll-target="#step-1-data-reduction-of-omics-data-and-auxiliary-data">Step 1: Data reduction of Omics data and auxiliary data</a></li>
  <li><a href="#step-2-exposures-correlations-outcomes-associations" id="toc-step-2-exposures-correlations-outcomes-associations" class="nav-link" data-scroll-target="#step-2-exposures-correlations-outcomes-associations">Step 2: Exposures’ correlations &amp; Outcomes’ associations</a></li>
  <li><a href="#step-3-visualization-of-triplot" id="toc-step-3-visualization-of-triplot" class="nav-link" data-scroll-target="#step-3-visualization-of-triplot">Step 3: Visualization of Triplot</a></li>
  <li><a href="#step-4-mediation-analysis-and-visualization" id="toc-step-4-mediation-analysis-and-visualization" class="nav-link" data-scroll-target="#step-4-mediation-analysis-and-visualization">Step 4: Mediation analysis and visualization</a></li>
  <li><a href="#step-5-compare-correlations-associations-and-mediations" id="toc-step-5-compare-correlations-associations-and-mediations" class="nav-link" data-scroll-target="#step-5-compare-correlations-associations-and-mediations">Step 5: Compare correlations, associations and mediations</a></li>
  <li><a href="#step-6-download-data" id="toc-step-6-download-data" class="nav-link" data-scroll-target="#step-6-download-data">Step 6: Download data</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content"><p>Before starting, please make sure you can use the <a href="https://yingxiao.shinyapps.io/triplotgui/" target="_blank">online version of TriplotGUI</a> or can use TriplotGUI as a stand-alone application on your computer following <a href="./installation.html" target="_blank" style="color:blue">Setup</a>.</p>
<section id="data-description" class="level1"><h1>Data description</h1>
<p>Each dataset used in this page of tutorial can be downloaded <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Example_data/Example2" target="_blank">here</a> as a dataframe in the rds/rda/csv/xlsx files:</p>
<ul>
<li>Example2_exposure.rda</li>
<li>Example2_Omics.rds</li>
<li>Example2_outcome.rds</li>
<li>Example2_covariate.csv</li>
<li>Example2_auxiliary.xlsx</li>
</ul>
<p>We have used different file types on purpose to show you that TriplotGUI can deal with different data type.</p>
<p>The data used in this page of tutorial can be downloaded <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda" target="_blank">here</a> in rda format.</p>
<p>The Data used for this example originates from <strong><em>HealthyNordicDiet_2</em></strong>, modified from the <strong>HealthyNordicDiet</strong> data provided by the <a href="https://gitlab.com/CarlBrunius/triplot/-/blob/master/vignettes/Triplot_Tutorial.md?ref_type=heads" target="_blank"><em>triplot</em></a> package (Schillemans et al.&nbsp;2019). <strong>HealthyNordicDiet</strong> is a synthetic dataset that was simulated from the authentic data used in a case/control study nested within the Swedish prospective Västerbotten Intervention Programme cohort. The original study was set up to explore plasma metabolites that could objectively reflect healthy Nordic dietary patterns in a matched case-control study and to assess associations between such patterns and later development of type 2 diabetes. (Shi et al.&nbsp;2018). We have selected our exposures, Omics data, outcomes, covariates and auxiliary data based on the <strong><em>HealthyNordicDiet_2</em></strong> data following the code <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/Data_cleaning_HealthyNordicDiet_2.R" target="_blank">here</a>. The brief description of these data is shown as below.</p>
<ul>
<li>Example2_exposure.rda: containing a dataframe with 17 variables representing the dietary intake as measured by food frequency questionnaires (<code>"HFI"</code>(Healthy Food Index),<code>"BSDS"</code>(the Baltic Sea Diet Score), <code>"Wholegrains"</code>, <code>"Sausage"</code>, <code>"Pizza"</code>, <code>"Refined.bread"</code>, <code>"Fruits"</code>, <code>"Liquor"</code>, <code>"Wine"</code>, <code>"Hamburger"</code>, <code>"Poultry"</code>, <code>"Fish"</code>, <code>"Margarine"</code>, <code>"Cabbage"</code>, <code>"Carrot"</code>, <code>"low_fat_Dairy"</code>, <code>"Vegetables"</code>). HFI is a categorical factor variable with 7 levels (0-6). All the other variables are continuous/numeric.</li>
<li>Example2_Omics.rds: 31 variables representing plasma metabolites predictive of BMI. All 31 variables are continuous/numeric.</li>
<li>Example2_outcome.rds: 3 variables:
<ul>
<li>
<code>"BMI"</code>: A continuous variable.</li>
<li>
<code>"BMI_cat"</code>: A categorical factor variable with 4 levels: normal, overweight, obese, underweight</li>
<li>
<code>"T2D"</code>: A binary factor variable, 1 for cases and 0 for controls.</li>
</ul>
</li>
<li>Example2_covariate.csv: 5 variables that can be used as potential confounders:
<ul>
<li>
<code>"Gender"</code>: A factor variable with 2 levels: 1, 2.</li>
<li>
<code>"Age"</code>: A continuous/numeric variable.</li>
<li>
<code>"Education"</code>: A factor variable with 4 levels: 1-4.</li>
<li>
<code>"PhysicalActivityIndex"</code>: A factor variable with 4 levels: 1-4.</li>
<li>
<code>"Smoking"</code>: A factor variable with 5 levels: 1-5.</li>
</ul>
</li>
<li>Example2_auxiliary.xlsx: 5 variables that can be used as potential confounders:
<ul>
<li>
<code>"PairedInfo"</code>: A factor variable containing the pairing information of case-control matches of <code>"T2D"</code>, with 500 levels: 1-500</li>
<li>
<code>"Energy"</code>: A continuous/numeric variable.</li>
<li>
<code>"FastingGlucose"</code>: A continuous/numeric variable.</li>
<li>
<code>"Education"</code>: A factor variable with 4 levels: 1-4.</li>
<li>
<code>"PhysicalActivityIndex"</code>: A factor variable with 4 levels: 1-4.</li>
</ul>
</li>
</ul>
<p>All data are row-wise matched by observations and consist of 1000 synthetic observations.</p>
<p><strong>Reference</strong></p>
<p>Shi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., &amp; Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. <em>The American Journal of Clinical Nutrition</em>, 108(3), 564-575. <a href="https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub" target="_blank">10.1093/ajcn/nqy145</a></p>
<p>Schillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. <em>Metabolites</em>. 2019 Jul 6;9(7):133. <a href="https://www.mdpi.com/2218-1989/9/7/133" target="_blank">doi: 10.3390/metabo9070133</a></p>
</section><section id="research-question" class="level1"><h1>Research question</h1>
<p>We want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI. We assume that metabolites serves as mediators, mediating the effect of dietary exposures on Type 2 diabetes and BMI.</p>
</section><section id="the-use-of-interface" class="level1"><h1>The use of interface</h1>
<p>Open your interface. What we will show as an example in the interface here correspond to the <a href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/complex_code.html#step-2" target="_blank">Code example of using TriplotGUI</a> section in this page.</p>
<section id="step-1-data-reduction-of-omics-data-and-auxiliary-data" class="level2"><h2 class="anchored" data-anchor-id="step-1-data-reduction-of-omics-data-and-auxiliary-data">Step 1: Data reduction of Omics data and auxiliary data</h2>
<p>First upload the Omics data and auxiliary data in step 1. Upon finish uploading the Omics data, a series buttons will also show up in case you need to to make some modification on the Omics or auxiliary data. Inspect the classes of variables briefly. You would see it looks okay for Omics data’s class but not auxiliary data. Some categorical variables should be in factor format rather than character. Therefore we change their classes.</p>
<div class="columns">
<div class="column" style="width: 40%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_1_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="img/complex_1_1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_1_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="img/complex_1_2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Then change the “Data analysis settings” and “Visualization settings” as figure. In this example, we will use WGCNA method to obtain the principal components/modules and using auxiliary data to obtain more informative figures.</p>
<p>We could then examine the scree plot, score plot, loadings plot and biplot at step 1.</p>
<div class="columns">
<div class="column" style="width: 45%">
<p><a href="img/complex_1_3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="img/complex_1_3.png" class="img-fluid"></a> <a href="img/complex_1_4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="img/complex_1_4.png" class="img-fluid"></a> You can then play around the visualization panel on the right side and view all the plots (score, loadings, biplot, screeplot).</p>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_1_5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="img/complex_1_5.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section><section id="step-2-exposures-correlations-outcomes-associations" class="level2"><h2 class="anchored" data-anchor-id="step-2-exposures-correlations-outcomes-associations">Step 2: Exposures’ correlations &amp; Outcomes’ associations</h2>
<p>Then upload exposures and covariate data in step 2A. By briefly inspecting variable classes, you could notice: - In the exposure data, <code>"HFI"</code>(Healthy Food Index) is a factor variable while <code>"BSDS"</code> (Baltic Sea Food Index) is a numeric variable. We may not need to change their classes at this point, but it is good to be aware of variables’ classes to get a better understanding what happens in the downstream steps. - A variable called <code>"X"</code> exists in the covariate data. This is because the covariate data is uploaded as a csv file and the observation number may automatically be generated as a new variable when the file is read in. Remove this variable since it is not an actual covariate.</p>
<div class="columns">
<div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_2_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="img/complex_2_1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_2_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="img/complex_2_2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Change your “Data analysis settings” as the figure below.</p>
<div class="columns">
<div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_2_3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="img/complex_2_3.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>You could then briefly view the correlation coefficients in “Visualizations” by clicking “Refresh plot”.</p>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_2_4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="img/complex_2_4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<p>Select <em>One-hot-encoding</em> in <strong><em>Categorical variables</em></strong> performs one-hot-encoding to transform categorical exposures variables (i.e.&nbsp;<code>HFI</code>) with n&gt;2 classes to n binary variables and the correlation coefficients between modules and the binary variables were calculated.</p>
<p>If <em>Use Original</em> is specified in <strong><em>Categorical variables</em></strong>, no transformation is made on the <code>"HFI"</code> variable. Linear models regressing modules on the <code>"HFI"</code> variable are used for correlation analysis. The correlation coefficients are calculated as the square root of the proportion of sum of squares for HFI in the total sum of squares.</p>
</li>
<li><p>The approaches for managing <strong><em>Missing values</em></strong> are inherited from the <em>cor</em> package for continuous exposures. Please check <a href="https://rdrr.io/r/stats/cor.html" target="_blank"><em>cor</em></a> package for more information.</p></li>
</ul>
</div>
</div>
<p>Then in step 2B, upload outcome and covariate data. By briefly inspecting variable classes, you could notice: - In the outcome data, <code>"BMI"</code> is a numeric variable; <code>"BMI_cat"</code> and <code>"T2D"</code> are factor variables. - A variable called <code>"X"</code> exists in the covariate data. This is because the covariate data is uploaded as a csv file and the observation number may automatically be generated as a new variable when the file is read in. Remove this variable since it is not an actual covariate.</p>
<div class="columns">
<div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_2_5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="img/complex_2_5.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_2_6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="img/complex_2_6.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>Change your “Data analysis settings” and “Visulization settings” as the figure below.</p>
<div class="columns">
<div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_2_7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="img/complex_2_7.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<p>You could briefly view the risk estimate in “Visualizations” by clicking “Refresh plot”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_2_8.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="img/complex_2_8.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some clarification for using multinomial regression and pairing variables:</p>
<ul>
<li>When a pairing variable is not provided:
<ul>
<li>Not performing multinomial regression means that one-hot-encoding will be performed to transform outcome’s categorical variables with n &gt; 2 classes to n binary variables. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</li>
<li>Performing multinomial regression means that multinomial regression will be performed on outcome’s categorical outcome variable with n &gt; 2 classes, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</li>
</ul>
</li>
<li>When a pairing variable is provided:
<ul>
<li>Not performing multinomial regression means that one-hot-encoding will be performed on outcome’s categorical variables with n &gt; 2 classes. And then conditional logistic regression will be performed on the binary variables and linear mixed model will be performed on continuous variables, using the pairing information.</li>
<li>Performing multinomial regression means that the pairing information will be ignored and not used (since the outcomes can have more than 2 classes), multinomial regression will be performed on outcome’s categorical variable, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables. THIS IS THE CASE IN OUR EXAMPLE.</li>
</ul>
</li>
</ul>
</div>
</div>
</section><section id="step-3-visualization-of-triplot" class="level2"><h2 class="anchored" data-anchor-id="step-3-visualization-of-triplot">Step 3: Visualization of Triplot</h2>
<p>In the triplot, the black arrows are loadings representing Omics variables. Blue circle points represents exposure correlations with the modules and the red square points represents outcome associations with the modules. So what information can we get from this figure? Lets us list a few points:</p>
<ul>
<li>Having a brief look, the generally healthy food (e.g.&nbsp;<code>"Fruits"</code>, <code>"Vegetables"</code>) is on the first dimension of the figure and the generally unhealthy food (e.g.&nbsp;<code>"Hamburger"</code>, <code>"Sausage"</code>, <code>"Margarine"</code>) is on the third dimension of the figure. The numeric outcome <code>"BMI"</code>, binary outcome <code>"T2D"</code>, and one-hot-encoded categorical <code>"BMI_cat"</code> outcome is on the second and fourth dimension of the figure.</li>
<li>Explanation on some variables in the plot:
<ul>
<li>
<code>"HFI"</code> stands for healthy food index. A higher <code>"HFI"</code> suggests healthier diet. <code>"HFI"</code> ranges from 0 to 6. You can see that there are <em>HFI_0</em>, <em>HFI_1</em>…<em>HFI_6</em> in the figure and that is because <code>"HFI"</code> is used as a factor exposure variable in step 2 and is one-hot-encoded (<code>allowcategorical=F</code>) to the same number of binary variables as its number of levels. For example, <em>HFI_6</em> is a binary variable where individuals with <code>"HFI"</code> as 6 (most healthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. <em>HFI_0</em> is a binary variable where individuals with <code>"HFI"</code> as 0 (most unhealthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. <em>HFI_1</em>…<em>HFI_5</em> has limited use since it only separates the group of people with certain <code>"HFI"</code> value from to the rest, which is a mixture of people with healthier and less healthier diet.</li>
<li>
<code>"BSDS"</code> stands for Baltic Sea Diet Score ranging. A higher <code>"BSDS"</code> suggests healthier diet. <code>"BSDS"</code> is used as a numeric variable ranging from 2 to 25 in the correlation.</li>
<li>
<em>BMI_cat_obese</em>, <em>BMI_cat_overweight</em>, <em>BMI_cat_underweight</em> are the odds ratio generated from the multinomial regression. Since <code>"BMI_cat"</code> is a categorical outcome and multinomial regression is performed in step 2 (<code>multinomial=T</code>), normal weight is uses as a reference and odds ratio of obese, overweight and underweight is produced. (Note that the first level of the factor variable is set as the default reference, in this case it is <em>normal</em>).</li>
</ul>
</li>
<li>Adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code>, the first module (on x-axis) correlates positively with generally healthy food (e.g.&nbsp;<code>"fruits"</code>, <code>"vegatables"</code>) and food index (e.g.&nbsp;<code>"BSDS"</code>) and negatively with unhealthy food (e.g.&nbsp;<code>"Hamburger"</code>, <code>"pizza"</code>). It also reversely associated with <code>"T2D"</code> and <code>"BMI"</code>. From the result from <code>"BMI_cat"</code>, this components also reversely associated with being obese.</li>
<li>Adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code>, the second module (on y-axis) associated positively with generally healthy food (e.g.&nbsp;<code>"fruits"</code>, <code>"vegatables"</code>) and food index (e.g.&nbsp;<code>"BSDS"</code>) and negatively with unhealthy food (e.g.&nbsp;<code>"Hamburger"</code>, <code>"pizza"</code>). However, the module correlates also positively with <code>"T2D"</code>,<code>"BMI"</code>, <em>obese</em>, <em>overweight</em> and negatively associated with <em>underweight</em>.</li>
<li>Based on what we summarized above, the two modules may be associated with a overall healthy eating pattern. And in such pattern, the first module is associated more with the beneficial effect on health and the second module represents the adverse health effect that may be caused by this pattern.</li>
</ul></section><section id="step-4-mediation-analysis-and-visualization" class="level2"><h2 class="anchored" data-anchor-id="step-4-mediation-analysis-and-visualization">Step 4: Mediation analysis and visualization</h2>
<p>There are many things that you could explore further in the following mediation analysis. To narrow down our focus and clearly show our examples, we select <code>"BSDS"</code> (Baltic Sea Diet Score) and <code>"Hamburger"</code> as our exposures, <code>"BMI"</code> and <code>"T2D"</code> as outcome to enter our next step.</p>
<p>This time, we perform the mediation analysis using the conterfactual/potential outcome method (the ´mediation´ package) on our exposures (i.e.&nbsp;<code>"BSDS"</code>, <code>"Hamburger"</code>), mediators (i.e.&nbsp;the first and second modules) and outcome (i.e.&nbsp;<code>"T2D"</code>, <code>"BMI"</code>) of interest, adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code> for both exposure-mediator and mediator-outcome relationship.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the counterfactual mediation analysis, you need to specify contrast values of treatment and controls for each exposure. In brief, the algorithm will compare the scenarios with these 2 exposure values/levels. For my detailed explanation please refer to <a href="https://www.jstatsoft.org/article/view/v059i05" target="_blank">this paper</a> of the <code>mediation</code> R package.</p>
<p>If an exposure variable is continuous (numeric variable), it is recommended that the 2 exposure values is chosen between the range of the exposure variable. If an exposure variable is categorical (factor variable), the 2 exposure levels should be chosen from the levels of the exposure variable.</p>
</div>
</div>
<div class="columns">
<div class="column" style="width: 40%">
<p>Use the following settings for your data analysis. Mediation analysis is then performed using the counterfactual method on the our selected exposures, mediators and our selected outcomes, adjusting for covariates for both exposure-mediator and mediator-outcome relationship.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Note that you need to click <strong><em>Do mediation</em></strong> to start running the mediation analysis.</li>
</ul>
</div>
</div>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_4_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="img/complex_4_1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<p>You could then play around in the “Visualization settings” too see how you want to visualize your plot. You could first only show the proportion mediated(PM) and adjust the limits to make the points more visible.</p>
</div>
<div class="columns">
<div class="column" style="width: 40%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_4_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="img/complex_4_2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_4_3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="img/complex_4_3.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<p>We could see four data points on the figure, which represents the eight combinations of exposures, mediators and outcomes.</p>
<ul>
<li>exposure=BSDS, mediator= module 1, outcome=BMI</li>
<li>exposure=BSDS, mediator= module 2, outcome=BMI</li>
<li>exposure=Hamburger, mediator= module 1, outcome=BMI</li>
<li>exposure=Hamburger, mediator= module 2, outcome=BMI</li>
<li>exposure=BSDS, mediator= module 1, outcome=T2D</li>
<li>exposure=BSDS, mediator= module 2, outcome=T2D</li>
<li>exposure=Hamburger, mediator= module 1, outcome=T2D</li>
<li>exposure=Hamburger, mediator= module 2, outcome=T2D</li>
</ul>
<p>In the figure, we could see the direction and magnitude of proportion mediated for the 2 mediators, all the exposures and outcomes. We also notice that the PM for BSDS-module 1-BMI and BSDS-module 2-BMI mediation is significant.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Note that some confidence intervals are automatically removed from the figure if they are not within the limit.</li>
<li>Note that for some mediations, direct effect and indirect effects are in the opposite direction, implying possibly proportion mediated(PM)&gt;1, since total effect could be smaller than indirect effect.</li>
</ul>
</div>
</div>
<div class="columns">
<p>You then show the adjusted proportion mediated (APM) and adding the layers of correlation and risk estimates, using the settings below.</p>
<div class="column" style="width: 40%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_4_4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="img/complex_4_4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div><div class="column" style="width: 5%">

</div><div class="column" style="width: 45%">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_4_5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="img/complex_4_5.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>By observing this figure, we could see the direction and magnitude of adjusted proportion mediated for the 2 mediators, all the exposures and outcomes. The position of the points is similar what we have seen for proportion mediated. Note that APM for BSDS as exposure and T2D as outcome is smaller than their PM. This is because the indirect and direct effect for this mediation is of similar size but in opposite direction. This leads to a smaller total effect and in turn larger PM, but APM will not be affected by the directionality of the direct and indirect effect.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>No confidence interval is shown for adjusted proportion mediated, as such value can not be directly calculated from the mediation analysis.</p></li>
<li><p>Note that even direct effect and indirect effects are in the opposite direction, adjusted proportion mediated is always smaller than 1, since it uses the sum of the absolute value of indirect and direct effect as denominator. <span class="math display">\[APM=\frac{IE}{|IE|+|DE|}\cdot\frac{|IE+DE|}{IE+DE}=\frac{IE}{IE+DE}\cdot\frac{|IE+DE|}{|IE|+|DE|}=\frac{IE}{|IE|+|DE|}\cdot\frac{IE+DE}{|IE+DE|}\]</span></p></li>
</ul>
</div>
</div>
<p>In step 4, you can also see the barplots showed direct, indirect and total effect for each exposure-mediator-outcome combination. It is a convenient tool to check the direction and magnitude of mediation estimates.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_4_6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="img/complex_4_6.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>Base on the barplot and the triplot with mediation, we have observed significant proportion mediated for BSDS-module 1/2-BMI mediations. Further exploration on indirect, direct and total effect of the mediation analysis could be explored by playing around the <code>which_show</code> argument in the <code>mediation_troplot()</code> function. We will not go into details here.</p>
</section><section id="step-5-compare-correlations-associations-and-mediations" class="level2"><h2 class="anchored" data-anchor-id="step-5-compare-correlations-associations-and-mediations">Step 5: Compare correlations, associations and mediations</h2>
<p>Users can then check the heatmaps of correlations, risk estimations and mediation results at step 5. By removing other PCs, exposures or outcomes in the “Visualization settings”, users may only show correlation, risk estimation and mediation results of their interest.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_5_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="img/complex_5_1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="img/complex_5_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="img/complex_5_2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>One star for p&lt;0.05; Two stars for p&lt;0.01; Three stars for p&lt;0.001.</li>
<li>Note that only the selected exposures, mediators and outcomes that we use to do mediation on will show up in the mediation results. The rows in the heatmaps are mediators and the column represents exposure-outcome pairs. For each exposure_outcome pair, 4 result are shown: <em>IE</em> (indirect effect), <em>TE</em> (total effect), <em>PM</em>(Proportion Mediated) and <em>APM</em>(Adjusted Proportion Mediated). Please see <a href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/workflow.html#5.2" target="_blank">Details section</a> for more information. The “CF” before the names of exposures-outcome pairs means that this mediation is using the Counterfactual method.</li>
</ul>
</div>
</div>
</section><section id="step-6-download-data" class="level2"><h2 class="anchored" data-anchor-id="step-6-download-data">Step 6: Download data</h2>
<p>Relevant data, intermediate results, can then be viewed and downloaded at step 6.</p>
<p><a href="img/complex_6_1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="img/complex_6_1.png" class="img-fluid"></a> <a href="img/complex_6_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="img/complex_6_2.png" class="img-fluid"></a></p>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left"><span class="faux-block">© 2024 Yingxiao Yan <br> CC BY-SA 4.0</span></div>   
    <div class="nav-footer-center"><span class="faux-block"> <a href="https://yingxiao.shinyapps.io/triplotgui/" target="_blank">TriplotGUI</a> <br><a href="https://gitlab.com/YingxiaoYan/TriplotGUI" target="_blank">TriplotGUI Gitlab</a> </span></div>
    <div class="nav-footer-right"><span class="faux-block cyan"> <a href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/" target="_blank">Main page of this tutorial</a> <br><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial" target="_blank">View source of this site on GitLab</a> </span></div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"loop":true,"selector":".lightbox","openEffect":"zoom","descPosition":"bottom","closeEffect":"zoom"});</script>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>