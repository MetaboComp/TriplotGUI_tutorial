<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>TriplotGUI  - Tutorial(complex) - Code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/TriplotGUI_logo_white.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 5,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
      }
</style>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="styles.scss">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/TriplotGUI_logo_black.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">TriplotGUI <i class="fa-brands fa-gitlab" aria-label="gitlab"></i></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./introduction.html" rel="" target="">
 <span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./installation.html" rel="" target="">
 <span class="menu-text">Setup</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workflow.html" rel="" target="">
 <span class="menu-text">Manual</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorial(simple" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tutorial(simple)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorial(simple">
<li>
    <a class="dropdown-item" href="./simple.html" rel="" target="">
 <span class="dropdown-text">User Interface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simple_code.html" rel="" target="">
 <span class="dropdown-text">Code</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorial(complex" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tutorial(complex)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorial(complex">
<li>
    <a class="dropdown-item" href="./complex.html" rel="" target="">
 <span class="dropdown-text">User Interface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./complex_code.html" rel="" target="">
 <span class="dropdown-text">Code</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./papers.html" rel="" target="">
 <span class="menu-text">Papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About us</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/" rel="" target=""><i class="bi bi-folder-symlink" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/yingxiao-yan" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:yingxiao@chalmers.se" rel="" target=""><i class="bi bi-envelope" role="img" aria-label="email">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <div class="quarto-title-block"><div><h1 class="title">Tutorial(complex) - Code</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Complex demo of using TriplotGUI’s code</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Tutorial</h2>
   
  <ul>
<li><a href="#data-description" id="toc-data-description" class="nav-link active" data-scroll-target="#data-description"><span class="header-section-number">1</span> Data description</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question"><span class="header-section-number">2</span> Research question</a></li>
  <li>
<a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration"><span class="header-section-number">3</span> Data exploration</a>
  <ul>
<li><a href="#check-healthynordicdiet_2" id="toc-check-healthynordicdiet_2" class="nav-link" data-scroll-target="#check-healthynordicdiet_2"><span class="header-section-number">3.1</span> Check HealthyNordicDiet_2</a></li>
  <li><a href="#check-datasets" id="toc-check-datasets" class="nav-link" data-scroll-target="#check-datasets"><span class="header-section-number">3.2</span> Check datasets</a></li>
  <li><a href="#check-variables-class" id="toc-check-variables-class" class="nav-link" data-scroll-target="#check-variables-class"><span class="header-section-number">3.3</span> Check variables’ class</a></li>
  <li><a href="#check-sanities-for-variables" id="toc-check-sanities-for-variables" class="nav-link" data-scroll-target="#check-sanities-for-variables"><span class="header-section-number">3.4</span> Check sanities for variables</a></li>
  <li><a href="#build-data-for-analysis" id="toc-build-data-for-analysis" class="nav-link" data-scroll-target="#build-data-for-analysis"><span class="header-section-number">3.5</span> Build data for analysis</a></li>
  </ul>
</li>
  <li>
<a href="#code-example-of-using-triplotgui" id="toc-code-example-of-using-triplotgui" class="nav-link" data-scroll-target="#code-example-of-using-triplotgui"><span class="header-section-number">4</span> Code example of using TriplotGUI</a>
  <ul>
<li><a href="#simple_link" id="toc-simple_link" class="nav-link" data-scroll-target="#simple_link"><span class="header-section-number">4.1</span> Step 1: Data reduction of omics data</a></li>
  <li><a href="#step-2-exposure-correlations-outcome-associations" id="toc-step-2-exposure-correlations-outcome-associations" class="nav-link" data-scroll-target="#step-2-exposure-correlations-outcome-associations"><span class="header-section-number">4.2</span> Step 2: Exposure correlations &amp; Outcome associations</a></li>
  <li><a href="#step-3-visualization-of-triplot" id="toc-step-3-visualization-of-triplot" class="nav-link" data-scroll-target="#step-3-visualization-of-triplot"><span class="header-section-number">4.3</span> Step 3: Visualization of Triplot</a></li>
  <li><a href="#step-4-mediation-analysis-and-visualization" id="toc-step-4-mediation-analysis-and-visualization" class="nav-link" data-scroll-target="#step-4-mediation-analysis-and-visualization"><span class="header-section-number">4.4</span> Step 4: Mediation analysis and visualization</a></li>
  <li><a href="#step-5-compare-correlations-associations-and-mediations" id="toc-step-5-compare-correlations-associations-and-mediations" class="nav-link" data-scroll-target="#step-5-compare-correlations-associations-and-mediations"><span class="header-section-number">4.5</span> Step 5: Compare correlations, associations and mediations</a></li>
  <li><a href="#step-6-download-data" id="toc-step-6-download-data" class="nav-link" data-scroll-target="#step-6-download-data"><span class="header-section-number">4.6</span> Step 6: Download data</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content"><p>Before starting, please make sure you have installed the TriplotGUI package following <a href="./installation.html" target="_blank" style="color:blue">Setup</a>.</p>
<p>The code of at this page can be downloaded <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/HealthyNordicDiet_2_applying_TriplotGUI_code.R" target="_blank">here</a></p>
<section id="data-description" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Data description</h1>
<p>The data used in this tutorial section can be downloaded <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda" target="_blank">here</a> in rda format.</p>
<p>The Data used for this example of code is <strong><em>HealthyNordicDiet_2</em></strong>, modified from the <strong>HealthyNordicDiet</strong> data provided by the <a href="https://gitlab.com/CarlBrunius/triplot/-/blob/master/vignettes/Triplot_Tutorial.md?ref_type=heads" target="_blank"><em>triplot</em></a> package (Schillemans et al.&nbsp;2019). <strong>HealthyNordicDiet</strong> is a synthetic dataset that was simulated from the authentic data used in a case/control study nested within the Swedish prospective Västerbotten Intervention Programme cohort. The original study was set up to explore plasma metabolites that could objectively reflect healthy Nordic dietary patterns in a matched case-control study and to assess associations between such patterns and later development of type 2 diabetes. (Shi et al.&nbsp;2018). The simulated data <strong><em>HealthyNordicDiet_2</em></strong> is a list that contains three data frames:</p>
<ul>
<li>Clinical measurements (ClinData, 11 variables): <code>"ID"</code>,<code>"T2D"</code>(Cases and controls for type 2 diabetes), <code>"PairedInfo"</code>(Pairing/matching information for case and controls, a unique number is assigned to each case-control pairs),<code>"Energy"</code>,<code>"Gender"</code>,<code>"Age"</code>,<code>"BMI"</code>,<code>"Smoking"</code>,<code>"PhysicalActivityIndex"</code>,<code>"Education"</code>,<code>"FastingGlucose"</code>.<br>
</li>
<li>Plasma metabolites predictive of BMI (MetaboliteData, 20 variables)</li>
<li>Dietary intake as measured by food frequency questionnaires (FoodData, 11 variables): <code>"HFI"</code>(Healthy Food Index),<code>"BSDS"</code>(the Baltic Sea Diet Score),<code>"Wholegrains"</code>,<code>"Sausage"</code>,<code>"Pizza"</code>,<code>"Refined.bread"</code>, <code>"Fruits"</code>,<code>"Liquor"</code>,<code>"Wine"</code>,<code>"Hamburger"</code>,<code>"Poultry"</code>,<code>"Fish"</code>,<code>"Margarine"</code>,<code>"Cabbage"</code>,<code>"Carrot"</code>,<code>"low_fat_Dairy"</code>,<code>"Vegetables"</code>
</li>
</ul>
<p>The data frames are row-wise matched by observations and consist of 1000 synthetic observations.</p>
<p><strong>Reference</strong></p>
<p>Shi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., &amp; Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. <em>The American Journal of Clinical Nutrition</em>, 108(3), 564-575. <a href="https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub" target="_blank">10.1093/ajcn/nqy145</a></p>
<p>Schillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. <em>Metabolites</em>. 2019 Jul 6;9(7):133. <a href="https://www.mdpi.com/2218-1989/9/7/133" target="_blank">doi: 10.3390/metabo9070133</a></p>
</section><section id="research-question" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Research question</h1>
<p>We want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI. We assume that metabolites serves as mediators, mediating the effect of dietary exposures on Type 2 diabetes and BMI.</p>
</section><section id="data-exploration" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Data exploration</h1>
<p><strong><em>HealthyNordicDiet_2</em></strong> is loaded in the R environment up on running <code><a href="https://rdrr.io/r/base/library.html">library(TriplotGUI)</a></code>. We will do some data exploration first to see how the data looks like.</p>
<div class="cell styled-output">

</div>
<section id="check-healthynordicdiet_2" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="check-healthynordicdiet_2">
<span class="header-section-number">3.1</span> Check HealthyNordicDiet_2</h2>
<p>Check the <strong><em>HealthyNordicDiet_2</em></strong> list:</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "ClinData"       "MetaboliteData" "FoodData"      </code></pre>
</div>
</div>
</section><section id="check-datasets" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="check-datasets">
<span class="header-section-number">3.2</span> Check datasets</h2>
<p>Check the names of variables in each data:</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">ClinData</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "ID"                    "T2D"                   "PairedInfo"           
 [4] "Energy"                "Gender"                "Age"                  
 [7] "BMI"                   "Smoking"               "PhysicalActivityIndex"
[10] "Education"             "FastingGlucose"       </code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">MetaboliteData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "Pipecolic.acid.betaine"         "lysoPC.18.0."                  
 [3] "HP143.1179.1.55"                "lysoPE.22.6."                  
 [5] "HN151.0065.4.97"                "RP225.1482.9.15"               
 [7] "X3.4.5.Trimethoxycinnamic.acid" "DHA"                           
 [9] "RP383.1671.10.53"               "gama.tocopherol"               
[11] "RP431.3516.11.96"               "RP490.3516.8.99"               
[13] "lysoPC.22.6."                   "Steroid.glucuronide"           
[15] "RP684.5545.13.41"               "RP197.0926.3.17"               
[17] "RP303.6468.9.98"                "RP816.5684.12.52"              
[19] "RP827.5356.11.88"               "RP826.5442.12.17"              
[21] "RN201.1498.8.23"                "RN203.0022.3.00"               
[23] "EPA"                            "PC.18.2.15.0."                 
[25] "RN814.5610.12.14"               "RN153.0190.3.5"                
[27] "RN427.1641.10.59"               "RN457.1742.10.50"              
[29] "RN830.5845.12.46"               "RN446.1541.10.59"              
[31] "RN472.1596.10.53"              </code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">FoodData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "HFI"           "BSDS"          "Wholegrains"   "Sausage"      
 [5] "Pizza"         "Refined.bread" "Fruits"        "Liquor"       
 [9] "Wine"          "Hamburger"     "Poultry"       "Fish"         
[13] "Margarine"     "Cabbage"       "Carrot"        "low_fat_Dairy"
[17] "Vegetables"   </code></pre>
</div>
</div>
</section><section id="check-variables-class" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="check-variables-class">
<span class="header-section-number">3.3</span> Check variables’ class</h2>
<p>We then transform the data to dataframe format and then use TriplotGUI’s <code>checkdata()</code> function in to examine the classes of variables.</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ClinData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">ClinData</span><span class="op">)</span></span>
<span><span class="va">MetaboliteData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">MetaboliteData</span><span class="op">)</span></span>
<span><span class="va">FoodData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">FoodData</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ClinData_check</span> <span class="op">&lt;-</span> <span class="fu">checkdata</span><span class="op">(</span><span class="va">ClinData</span><span class="op">)</span></span>
<span><span class="va">MetaboliteData_check</span> <span class="op">&lt;-</span> <span class="fu">checkdata</span><span class="op">(</span><span class="va">MetaboliteData</span><span class="op">)</span></span>
<span><span class="va">FoodData_check</span> <span class="op">&lt;-</span> <span class="fu">checkdata</span><span class="op">(</span><span class="va">FoodData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ClinData_check</span><span class="op">$</span><span class="va">class_summary_statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$check_class_vector
                   ID                   T2D            PairedInfo 
            "numeric"              "factor"              "factor" 
               Energy                Gender                   Age 
            "numeric"              "factor"             "numeric" 
                  BMI               Smoking PhysicalActivityIndex 
            "numeric"              "factor"              "factor" 
            Education        FastingGlucose 
             "factor"             "numeric" 

$check_class_table
check_class_vector
 factor numeric 
      6       5 </code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MetaboliteData_check</span><span class="op">$</span><span class="va">class_summary_statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$check_class_vector
        Pipecolic.acid.betaine                   lysoPC.18.0. 
                     "numeric"                      "numeric" 
               HP143.1179.1.55                   lysoPE.22.6. 
                     "numeric"                      "numeric" 
               HN151.0065.4.97                RP225.1482.9.15 
                     "numeric"                      "numeric" 
X3.4.5.Trimethoxycinnamic.acid                            DHA 
                     "numeric"                      "numeric" 
              RP383.1671.10.53                gama.tocopherol 
                     "numeric"                      "numeric" 
              RP431.3516.11.96                RP490.3516.8.99 
                     "numeric"                      "numeric" 
                  lysoPC.22.6.            Steroid.glucuronide 
                     "numeric"                      "numeric" 
              RP684.5545.13.41                RP197.0926.3.17 
                     "numeric"                      "numeric" 
               RP303.6468.9.98               RP816.5684.12.52 
                     "numeric"                      "numeric" 
              RP827.5356.11.88               RP826.5442.12.17 
                     "numeric"                      "numeric" 
               RN201.1498.8.23                RN203.0022.3.00 
                     "numeric"                      "numeric" 
                           EPA                  PC.18.2.15.0. 
                     "numeric"                      "numeric" 
              RN814.5610.12.14                 RN153.0190.3.5 
                     "numeric"                      "numeric" 
              RN427.1641.10.59               RN457.1742.10.50 
                     "numeric"                      "numeric" 
              RN830.5845.12.46               RN446.1541.10.59 
                     "numeric"                      "numeric" 
              RN472.1596.10.53 
                     "numeric" 

$check_class_table
check_class_vector
numeric 
     31 </code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FoodData_check</span><span class="op">$</span><span class="va">class_summary_statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$check_class_vector
          HFI          BSDS   Wholegrains       Sausage         Pizza 
     "factor"     "numeric"     "numeric"     "numeric"     "numeric" 
Refined.bread        Fruits        Liquor          Wine     Hamburger 
    "numeric"     "numeric"     "numeric"     "numeric"     "numeric" 
      Poultry          Fish     Margarine       Cabbage        Carrot 
    "numeric"     "numeric"     "numeric"     "numeric"     "numeric" 
low_fat_Dairy    Vegetables 
    "numeric"     "numeric" 

$check_class_table
check_class_vector
 factor numeric 
      1      16 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that in the given data, <code>"HFI"</code>(Healthy Food Index) is a factor variable and <code>"BSDS"</code>(the Baltic Sea Diet Score) is a numeric variable. You could use <code>table(FoodData$HFI)</code> and <code>table(FoodData$BSDS)</code> to check the difference.</p>
</div>
</div>
</section><section id="check-sanities-for-variables" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="check-sanities-for-variables">
<span class="header-section-number">3.4</span> Check sanities for variables</h2>
<p>Whether each variable contains missing (NA) or abnormal values (e.g.&nbsp;NAN, negative values, indefinite values, blank values) can also be checked.</p>
<p>The previous <code>checkdata()</code> function can also generate a table to summarize how many observations contain NA, NAN, zero, negative, indefinite(inf) and blank values(” “) and the percentages, for each variable in each data frame.</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>  <span class="co">## You may need to install.packages("kableExtra") first </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ClinData_check</span><span class="op">$</span><span class="va">everycolumn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ID</th>
<th style="text-align: right;">T2D</th>
<th style="text-align: right;">PairedInfo</th>
<th style="text-align: right;">Energy</th>
<th style="text-align: right;">Gender</th>
<th style="text-align: right;">Age</th>
<th style="text-align: right;">BMI</th>
<th style="text-align: right;">Smoking</th>
<th style="text-align: right;">PhysicalActivityIndex</th>
<th style="text-align: right;">Education</th>
<th style="text-align: right;">FastingGlucose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NA_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NaN_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NaN_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">negative_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">negative_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inf_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">inf_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blank_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blank_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">MetaboliteData_check</span><span class="op">$</span><span class="va">everycolumn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 0%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Pipecolic.acid.betaine</th>
<th style="text-align: right;">lysoPC.18.0.</th>
<th style="text-align: right;">HP143.1179.1.55</th>
<th style="text-align: right;">lysoPE.22.6.</th>
<th style="text-align: right;">HN151.0065.4.97</th>
<th style="text-align: right;">RP225.1482.9.15</th>
<th style="text-align: right;">X3.4.5.Trimethoxycinnamic.acid</th>
<th style="text-align: right;">DHA</th>
<th style="text-align: right;">RP383.1671.10.53</th>
<th style="text-align: right;">gama.tocopherol</th>
<th style="text-align: right;">RP431.3516.11.96</th>
<th style="text-align: right;">RP490.3516.8.99</th>
<th style="text-align: right;">lysoPC.22.6.</th>
<th style="text-align: right;">Steroid.glucuronide</th>
<th style="text-align: right;">RP684.5545.13.41</th>
<th style="text-align: right;">RP197.0926.3.17</th>
<th style="text-align: right;">RP303.6468.9.98</th>
<th style="text-align: right;">RP816.5684.12.52</th>
<th style="text-align: right;">RP827.5356.11.88</th>
<th style="text-align: right;">RP826.5442.12.17</th>
<th style="text-align: right;">RN201.1498.8.23</th>
<th style="text-align: right;">RN203.0022.3.00</th>
<th style="text-align: right;">EPA</th>
<th style="text-align: right;">PC.18.2.15.0.</th>
<th style="text-align: right;">RN814.5610.12.14</th>
<th style="text-align: right;">RN153.0190.3.5</th>
<th style="text-align: right;">RN427.1641.10.59</th>
<th style="text-align: right;">RN457.1742.10.50</th>
<th style="text-align: right;">RN830.5845.12.46</th>
<th style="text-align: right;">RN446.1541.10.59</th>
<th style="text-align: right;">RN472.1596.10.53</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NA_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NaN_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NaN_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">negative_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">negative_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inf_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">inf_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blank_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blank_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">FoodData_check</span><span class="op">$</span><span class="va">everycolumn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">HFI</th>
<th style="text-align: right;">BSDS</th>
<th style="text-align: right;">Wholegrains</th>
<th style="text-align: right;">Sausage</th>
<th style="text-align: right;">Pizza</th>
<th style="text-align: right;">Refined.bread</th>
<th style="text-align: right;">Fruits</th>
<th style="text-align: right;">Liquor</th>
<th style="text-align: right;">Wine</th>
<th style="text-align: right;">Hamburger</th>
<th style="text-align: right;">Poultry</th>
<th style="text-align: right;">Fish</th>
<th style="text-align: right;">Margarine</th>
<th style="text-align: right;">Cabbage</th>
<th style="text-align: right;">Carrot</th>
<th style="text-align: right;">low_fat_Dairy</th>
<th style="text-align: right;">Vegetables</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NA_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NaN_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">NaN_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">negative_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">negative_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">63.000</td>
<td style="text-align: right;">139.000</td>
<td style="text-align: right;">195.000</td>
<td style="text-align: right;">155.000</td>
<td style="text-align: right;">180.00</td>
<td style="text-align: right;">367.000</td>
<td style="text-align: right;">288.000</td>
<td style="text-align: right;">231.000</td>
<td style="text-align: right;">117.000</td>
<td style="text-align: right;">79.000</td>
<td style="text-align: right;">41.000</td>
<td style="text-align: right;">253.000</td>
<td style="text-align: right;">225.000</td>
<td style="text-align: right;">237.000</td>
<td style="text-align: right;">192.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.195</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.367</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">0.237</td>
<td style="text-align: right;">0.192</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inf_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">inf_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blank_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">blank_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You shall only continue when the class of variables are correct and the missing or abnormal values in the variable are properly handled.</p>
</div>
</div>
</section><section id="build-data-for-analysis" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="build-data-for-analysis">
<span class="header-section-number">3.5</span> Build data for analysis</h2>
<p>We treat food data as our exposures and BMI and type 2 diabetes as outcomes. Note that BMI is a continuous variable. We can additionally construct BMI as a categorical outcome using the criteria below and see how this may differ the result.</p>
<ul>
<li>BMI &lt;= 18.5: Underweight</li>
<li>18.5 &lt;BMI &lt;= 25: Normal</li>
<li>25 &lt; BMI &lt;= 30: Overweight</li>
<li>30 &lt; BMI: Obese</li>
</ul>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BMI</span> <span class="op">&lt;-</span> <span class="va">ClinData</span><span class="op">[</span>,<span class="st">"BMI"</span><span class="op">]</span></span>
<span><span class="va">BMI_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BMI</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BMI</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">18.5</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">BMI_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"underweight"</span></span>
<span>  <span class="op">}</span><span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">18.5</span><span class="op">&amp;</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">25</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">BMI_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"normal"</span></span>
<span>  <span class="op">}</span><span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">25</span><span class="op">&amp;</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">30</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">BMI_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"overweight"</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">BMI_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"obese"</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">BMI_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">BMI_cat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We want to explore the exposure-outcome relationships through the metabolomics data, using metabolites as assumed mediators. Gender, age, education, physical activity and smoking are used as potential confounders for exposure-mediator and mediator-outcome association. Auxiliary information regarding case-control matches, fasting glucose level, education and physical activity are also provided.</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exposure2</span> <span class="op">&lt;-</span> <span class="va">FoodData</span></span>
<span><span class="va">Omics2</span> <span class="op">&lt;-</span> <span class="va">MetaboliteData</span></span>
<span><span class="va">outcome2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span><span class="va">ClinData</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T2D"</span>,<span class="st">"BMI"</span><span class="op">)</span><span class="op">]</span>, <span class="va">BMI_cat</span><span class="op">)</span></span>
<span><span class="va">covariates2</span> <span class="op">&lt;-</span> <span class="va">ClinData</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span> ,<span class="st">"Age"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>,<span class="st">"Smoking"</span> <span class="op">)</span><span class="op">]</span></span>
<span><span class="va">auxilary2</span> <span class="op">&lt;-</span> <span class="va">ClinData</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PairedInfo"</span>,<span class="st">"FastingGlucose"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>, <span class="st">"Energy"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="code-example-of-using-triplotgui" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Code example of using TriplotGUI</h1>
<p>We will use a complex settings in this example. Please go to <a href="./simple_code.html" target="_blank">Tutorial(simple)</a>.if you want to try simple settings.</p>
<section id="simple_link" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="simple_link">
<span class="header-section-number">4.1</span> Step 1: Data reduction of omics data</h2>
<p>Using <code>TriplotGUI</code> package, first we perform dimension reduction, using weighted correlation network analysis (WGCNA) on metabolomics data.</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using the complex settings</span></span>
<span><span class="va">reduced_Omics2</span> <span class="op">&lt;-</span> <span class="fu">PCAorWGCNA_plots</span><span class="op">(</span>dataframe <span class="op">=</span> <span class="va">Omics2</span>,</span>
<span>                                   plottype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scree"</span>,<span class="st">"score"</span>,<span class="st">"loading"</span>,<span class="st">"scoreloading"</span><span class="op">)</span>,</span>
<span>                                   pc_type <span class="op">=</span> <span class="st">"principal"</span>, </span>
<span><span class="co"># Users can choose freely to use principal() instead of prcomp() to perform PCA.The result should be very similar, but principal() allows more functionalities</span></span>
<span>                                   first_PC <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                   second_PC<span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                   option <span class="op">=</span> <span class="st">"WGCNA"</span>,</span>
<span><span class="co"># In this example we use WGCNA to perform data reduction, therefore specifying `option="WGCNA"`.</span></span>
<span>                                   scale <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                   center <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                   eigen_loading <span class="op">=</span> <span class="st">"loading"</span>,</span>
<span><span class="co"># If you want to show loading or scale it to eigevalues.</span></span>
<span>                                   rotate <span class="op">=</span> <span class="st">"none"</span>,</span>
<span><span class="co"># This argument is inherited from the principal() function</span></span>
<span>                                   size_variable <span class="op">=</span> <span class="va">auxilary2</span><span class="op">$</span><span class="va">FastingGlucose</span>,</span>
<span>                                   size_variable_name <span class="op">=</span> <span class="st">"FastigGlucose"</span>,</span>
<span>                                   color_variable <span class="op">=</span> <span class="va">auxilary2</span><span class="op">$</span><span class="va">Education</span>,</span>
<span>                                   color_variable_name <span class="op">=</span> <span class="st">"Education"</span>,</span>
<span>                                   shape_variable <span class="op">=</span> <span class="va">auxilary2</span><span class="op">$</span><span class="va">PhysicalActivityIndex</span>,</span>
<span>                                   shape_variable_name <span class="op">=</span> <span class="st">"PhysicalActivityIndex"</span>,</span>
<span><span class="co"># The size,shape,color variables are used to differentiate points on the score plot and biplot </span></span>
<span>                                   loadings_name <span class="op">=</span> <span class="cn">T</span>,</span>
<span><span class="co"># Show the names of loadings</span></span>
<span>                                   loadings_cutpercent <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span><span class="co"># The loadings bigger than 20% of all the loadings will show up</span></span>
<span>                                   minModuleSize <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="co"># The mimimum number of variable in each cluster of WGCNA</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>In WGCNA, Omics variables are separated into clusters. PCA are first performed on each cluster and the first principal component of each cluster will be used as the principal components (We call them modules) of WGCNA.</li>
<li>You could try out the arguments of the <code>PCAorWGCNA_plots()</code> function and view the whole function <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCAorWGCNA_plots.R?ref_type=heads" target="_blank">here</a>
</li>
<li>One important argument in the <code>PCAorWGCNA_plots()</code> is <code>minModuleSize</code>, which defines the minimum number of variables in each cluster. If this number is specified too high, for example, if you have 20 variables in total and you specify <code>minModuleSize=15</code>, you may end up having all the 20 variables in one cluster. In this case, only the first principal component of the cluster will be used and be shown on both axes of the generated triplots.</li>
</ul>
</div>
</div>
<p>You can see scree plot, score plot, loadings plot and biplot at this stage.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">scree_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_6A-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6A-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>In the scree plot, each cluster is named with different colors, and the column heights represents how much variance are explained by that cluster among the total variance. The darker color represents variance explained by the first principal component/module of each cluster. You may notice that in the grey cluster there is only darker color, not the lighter color. This is because there is only one variable in that cluster - which will also be used as its first principal component/module. (Even though we specified <code>minModuleSize=2</code>, sometimes there are variables left out by clustering and become clusters of their own.)</p>
<p>The clusters are listed from left to right base on the number of variables in each cluster. The left side cluster has the most number of variables and right side cluster has the least number of variables.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">score_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_6B-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6B-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>In the score plot, as the function previously specified, the observations are colored by education level, and the observations with different physical activity index are marked with different shape and the observations with different fasting glucose level are plotted in different size.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">loading_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_6C-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6C-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>In the loading plot, you can see that the loadings are all in the direction along the axis. This is because we use first principal components/modules in each cluster. (It is not possible for a loading to be in the direction of another axis since the another axis represents a different principal component analysis.)</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">scoreloading_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_6D-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6D-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>The biplot with both score and loading looks a bit messy since there are so many things on the plot.</p>
<p>We then build a TPObject, which is used for saving information and passing them through steps in TriplotGUI.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">scores</span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">loadings</span></span>
<span><span class="va">variance</span> <span class="op">&lt;-</span> <span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">variance</span></span>
<span><span class="va">TPObject1</span> <span class="op">&lt;-</span> <span class="fu">makeTPO</span><span class="op">(</span>scores <span class="op">=</span> <span class="va">scores</span>,</span>
<span>                     loadings <span class="op">=</span> <span class="va">loadings</span>,</span>
<span>                     variance <span class="op">=</span> <span class="va">variance</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Making TriPlotObject (TPO)
--------------------------

Score matrix has 1000 observations and 5 components.

TPO has 0 attached correlations.
TPO has 0 attached risks.</code></pre>
</div>
</div>
</section><section id="step-2-exposure-correlations-outcome-associations" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="step-2-exposure-correlations-outcome-associations">
<span class="header-section-number">4.2</span> Step 2: Exposure correlations &amp; Outcome associations</h2>
<p>The correlations between modules and food items were calculated using Pearson correlations, adjusting for confounders. The associations between modules and risk markers were investigated using linear regression.</p>
<p>Correlation matrix of correlation coefficients and p values between the modules saved in the TPObject and the dietary variables in the exposure data is generated, using a pair-wise Pearson correlations, adjusting for confounders.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Correlations_object</span> <span class="op">&lt;-</span> <span class="fu">makeCorr</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject1</span>,</span>
<span>                                corrData <span class="op">=</span> <span class="va">exposure2</span>,</span>
<span>                                use <span class="op">=</span> <span class="st">'pairwise'</span>, </span>
<span>                                <span class="co"># use inherit from cor() function </span></span>
<span>                                method <span class="op">=</span> <span class="st">'pearson'</span>,</span>
<span>                                <span class="co"># method inherit from cor() function </span></span>
<span>                                allowcategorical <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                                <span class="co"># one-hot-encoding on categorical exposures</span></span>
<span>                                partial <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                <span class="co"># perform confonder adjustment</span></span>
<span>                                confounder <span class="op">=</span> <span class="va">covariates2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<p><code>allowcategorical=F</code> performs one-hot-encoding to transform categorical exposures variables with n&gt;2 classes to n binary variables. You can use <code>Correlations_object$cor_estimate</code> to check that each HFI level is separated in to a binary variable and the correlation coefficients between modules and the binary variables were calculated.</p>
<p>If <code>allowcategorical=T</code> is specified, then no transformation is made on the <code>"HFI"</code> variable. Linear models regressing modules on the <code>"HFI"</code> variable are used for correlation analysis. The correlation coefficients are calculated as the square root of the proportion of sum of squares for HFI in the total sum of squares.</p>
</li>
<li><p><code>partial=T</code> specifies that the confounders will be adjusted.</p></li>
</ul>
</div>
</div>
<p>The result of correlations are then added into the TPObject.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPObject2</span> <span class="op">&lt;-</span> <span class="fu">addCorr</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject1</span>,</span>
<span>                     Corr <span class="op">=</span> <span class="va">Correlations_object</span><span class="op">$</span><span class="va">cor_estimate</span>,</span>
<span>                     Corr_p <span class="op">=</span> <span class="va">Correlations_object</span><span class="op">$</span><span class="va">cor_pvalue</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Adding correlation to TPO
-------------------------
Please ensure same number of components in TPO and correlation matrix

TPO has 23 attached correlations.
TPO has 0 attached risks.</code></pre>
</div>
</div>
<p>Matrices of risk estimates and p values between the modules saved in the TPObject and the outcome variables are generated, adjusting for confounders.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Risks_object</span> <span class="op">&lt;-</span> <span class="fu">coefficient_get</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject2</span>,</span>
<span>                                outcome <span class="op">=</span> <span class="va">outcome2</span>,</span>
<span>                                confounder <span class="op">=</span> <span class="va">covariates2</span>,</span>
<span>                                partial <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                <span class="co"># performs confounder adjustment</span></span>
<span>                                multinomial <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                <span class="co"># multinomial regression is used</span></span>
<span>                                pair <span class="op">=</span> <span class="va">auxilary2</span><span class="op">$</span><span class="va">PairedInfo</span>,</span>
<span>                                <span class="co"># use the pairing information of case and control</span></span>
<span>                                CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span>                                <span class="co"># confidence interval</span></span>
<span>                                <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>When <code>pair</code> information is not provided:
<ul>
<li>
<code>multinomial=F</code> means that one-hot-encoding will be first performed to transform outcome’s categorical variables with n &gt; 2 classes to n binary variables. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</li>
<li>If specifying <code>multinomial=T</code>, multinomial regression will be performed on outcome’s categorical outcome variable with n &gt; 2 classes, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</li>
</ul>
</li>
<li>When <code>pair</code> information for case - control matches is provided:
<ul>
<li>
<code>multinomial=F</code> means that one-hot-encoding will be first performed on outcome’s categorical variables with n &gt; 2 classes. And then conditional logistic regression will be performed on the binary variables and linear mixed model will be performed on continuous variables, using the pairing information.</li>
<li>If specifying <code>multinomial=T</code>, the pairing information will be ignored and not used (since the outcomes can have more than 2 classes), multinomial regression will be performed on outcome’s categorical variable, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</li>
</ul>
</li>
<li>
<code>partial=T</code> specifies that the confounders will be adjusted.</li>
</ul>
</div>
</div>
<p>The result of risk estimates are then added into the TPObject.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPObject3</span> <span class="op">&lt;-</span> <span class="fu">addRisk</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject2</span>, </span>
<span>                     Risk <span class="op">=</span> <span class="va">Risks_object</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Adding risk to TPO
------------------
Please add risks one by one with component in rows and estimates, se:s and (optionally) p-values in columns
Please ensure same number of components in TPO and risk matrix

TPO has 23 attached correlations.
TPO has 5 attached risks.</code></pre>
</div>
</div>
</section><section id="step-3-visualization-of-triplot" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="step-3-visualization-of-triplot">
<span class="header-section-number">4.3</span> Step 3: Visualization of Triplot</h2>
<p>Then we can generate Triplot using the TPObject: Note that Triplot can be generated from any TPObject. You can try out different argument in the <code>TriplotGUI()</code> function. The function is a wrapper of <code>PCA_TriplotGUI()</code> and <code>WGCNA_TriplotGUI()</code>. You can view the functions respectively here: <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/TriplotGUI.R?ref_type=heads" target="_blank"><code>TriplotGUI()</code></a>, <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCA_TriplotGUI.R?ref_type=heads" target="_blank"><code>PCA_TriplotGUI()</code></a>, <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/WGCNA_TriplotGUI.R?ref_type=heads" target="_blank"><code>WGCNA_TriplotGUI()</code></a>.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object3</span> <span class="op">&lt;-</span> <span class="fu">TriplotGUI</span><span class="op">(</span><span class="va">TPObject3</span>,</span>
<span>                              first_PC <span class="op">=</span> <span class="fl">1</span>, <span class="co">## The first PC to map</span></span>
<span>                              second_PC <span class="op">=</span> <span class="fl">2</span>, <span class="co">## The first PC to map</span></span>
<span>                              plotLoads <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">##Whether to plot loadings (TRUE; default) or suppress them (FALSE)</span></span>
<span>                              plotScores <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">##Whether to plot scores (TRUE) or suppress them (FALSE; default)</span></span>
<span>                              plotCorr <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">##Whether to plot correlations (TRUE; default) or suppress them (FALSE)</span></span>
<span>                              plotRisk <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span>                              <span class="co">###############################################</span></span>
<span>                              <span class="co">##For loadings</span></span>
<span>                              loadLabels <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">###Whether to plot variable loading labels (TRUE; default) or not (FALSE)</span></span>
<span>                              loadArrowLength <span class="op">=</span> <span class="fl">0.02</span>, <span class="co">###Length of arrow tip , set it as 0 if you want to remove it</span></span>
<span>                              loadCut <span class="op">=</span> <span class="fl">0</span>, <span class="co">###lower limit Loadings below the cut are plotted in light grey and without label</span></span>
<span>                              loadLim <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##higher limit,Plot range for loadings</span></span>
<span>                              <span class="co">###############################################</span></span>
<span>                              <span class="co">##For correlations</span></span>
<span>                              colCorr <span class="op">=</span> <span class="st">"blue"</span>, <span class="co">##Color vector for correlations</span></span>
<span>                              pchCorr <span class="op">=</span> <span class="fl">16</span>, <span class="co">##Plotting character for correlations</span></span>
<span>                              whichCorr <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##Which correlations to plot (vector of numbers)</span></span>
<span>                              corLim <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##Plot range for correlations</span></span>
<span>                              corrLabels <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                              <span class="co">###############################################</span></span>
<span>                              <span class="co">##For risks</span></span>
<span>                              colRisk <span class="op">=</span> <span class="st">"red"</span>, <span class="co">##Color vector for risk estimates</span></span>
<span>                              pchRisk <span class="op">=</span> <span class="fl">15</span>, <span class="co">##Plotting character for risk estimates</span></span>
<span>                              whichRisk <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##Which risk estimates to plot (vector of numbers)</span></span>
<span>                              riskLim <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##Plot range for risks</span></span>
<span>                              riskWhisker_percentage <span class="op">=</span> <span class="fl">0.1</span>, <span class="co">## whisker length is how many percentage of confidence interval</span></span>
<span>                              riskLabels <span class="op">=</span> <span class="cn">T</span>, size <span class="op">=</span> <span class="fl">3</span>, <span class="co"># the size of points ont he plot</span></span>
<span>                              riskOR <span class="op">=</span> <span class="cn">T</span></span>
<span>                              <span class="co"># plot the risk estimates as odds ratio</span></span>
<span>                              <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We then plot the triplot.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object3</span><span class="op">$</span><span class="va">triplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_10-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>In the triplot, the black arrows are loadings representing Omics variables. Blue circle points represents exposure correlations with the modules and the red square points represents outcome associations with the modules. So what information can we get from this figure? Lets us list a few points:</p>
<ul>
<li>Having a brief look, the generally healthy food (e.g.&nbsp;<code>"Fruits"</code>, <code>"Vegetables"</code>) is on the first dimension of the figure and the generally unhealthy food (e.g.&nbsp;<code>"Hamburger"</code>, <code>"Sausage"</code>, <code>"Margarine"</code>) is on the third dimension of the figure. The numeric outcome <code>"BMI"</code>, binary outcome <code>"T2D"</code>, and one-hot-encoded categorical <code>"BMI_cat"</code> outcome is on the second and fourth dimension of the figure.</li>
<li>Explanation on some variables in the plot:
<ul>
<li>
<code>"HFI"</code> stands for healthy food index. A higher <code>"HFI"</code> suggests healthier diet. <code>"HFI"</code> ranges from 0 to 6. You can see that there are <em>HFI_0</em>, <em>HFI_1</em>…<em>HFI_6</em> in the figure and that is because <code>"HFI"</code> is used as a factor exposure variable in step 2 and is one-hot-encoded (<code>allowcategorical=F</code>) to the same number of binary variables as its number of levels. For example, <em>HFI_6</em> is a binary variable where individuals with <code>"HFI"</code> as 6 (most healthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. <em>HFI_0</em> is a binary variable where individuals with <code>"HFI"</code> as 0 (most unhealthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. <em>HFI_1</em>…<em>HFI_5</em> has limited use since it only separates the group of people with certain <code>"HFI"</code> value from to the rest, which is a mixture of people with healthier and less healthier diet.</li>
<li>
<code>"BSDS"</code> stands for Baltic Sea Diet Score ranging. A higher <code>"BSDS"</code> suggests healthier diet. <code>"BSDS"</code> is used as a numeric variable ranging from 2 to 25 in the correlation.</li>
<li>
<em>BMI_cat_obese</em>, <em>BMI_cat_overweight</em>, <em>BMI_cat_underweight</em> are the odds ratio generated from the multinomial regression. Since <code>"BMI_cat"</code> is a categorical outcome and multinomial regression is performed in step 2 (<code>multinomial=T</code>), normal weight is uses as a reference and odds ratio of obese, overweight and underweight is produced. (Note that the first level of the factor variable is set as the default reference, in this case it is <em>normal</em>).</li>
</ul>
</li>
<li>Adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code>, the first module (on x-axis) correlates positively with generally healthy food (e.g.&nbsp;<code>"fruits"</code>, <code>"vegatables"</code>) and food index (e.g.&nbsp;<code>"BSDS"</code>) and negatively with unhealthy food (e.g.&nbsp;<code>"Hamburger"</code>, <code>"pizza"</code>). It also reversely associated with <code>"T2D"</code> and <code>"BMI"</code>. From the result from <code>"BMI_cat"</code>, this components also reversely associated with being obese.</li>
<li>Adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code>, the second module (on y-axis) associated positively with generally healthy food (e.g.&nbsp;<code>"fruits"</code>, <code>"vegatables"</code>) and food index (e.g.&nbsp;<code>"BSDS"</code>) and negatively with unhealthy food (e.g.&nbsp;<code>"Hamburger"</code>, <code>"pizza"</code>). However, the module correlates also positively with <code>"T2D"</code>,<code>"BMI"</code>, <em>obese</em>, <em>overweight</em> and negatively associated with <em>underweight</em>.</li>
<li>Based on what we summarized above, the two modules may be associated with a overall healthy eating pattern. And in such pattern, the first module is associated more with the beneficial effect on health and the second module represents the adverse health effect that may be caused by this pattern.</li>
</ul></section><section id="step-4-mediation-analysis-and-visualization" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="step-4-mediation-analysis-and-visualization">
<span class="header-section-number">4.4</span> Step 4: Mediation analysis and visualization</h2>
<p>There are many things that you could explore further in the following mediation analysis. To narrow down our focus and clearly show our examples, we select <code>"BSDS"</code> (Baltic Sea Diet Score) and <code>"Hamburger"</code> as our exposures, <code>"BMI"</code> and <code>"T2D"</code> as outcome to enter our next step.</p>
<p>This time, we perform the mediation analysis using the conterfactual/potential outcome method (the ´mediation´ package) on our exposures (i.e.&nbsp;<code>"BSDS"</code>, <code>"Hamburger"</code>), mediators (i.e.&nbsp;the first and second modules) and outcome (i.e.&nbsp;<code>"T2D"</code>, <code>"BMI"</code>) of interest, adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code> for both exposure-mediator and mediator-outcome relationship.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the counterfactual mediation analysis, you need to specify contrast values of treatment and controls for each exposure. In brief, the algorithm will compare the scenarios with these 2 exposure values/levels. For my detailed explanation please refer to <a href="https://www.jstatsoft.org/article/view/v059i05" target="_blank">this paper</a> of the <code>mediation</code> R package.</p>
<p>If an exposure variable is continuous (numeric variable), it is recommended that the 2 exposure values is chosen between the range of the exposure variable. If an exposure variable is categorical (factor variable), the 2 exposure levels should be chosen from the levels of the exposure variable.</p>
</div>
</div>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mediation_object3</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">get_mediation_counterfactual</span> <span class="op">(</span>mediator <span class="op">=</span> <span class="va">TPObject3</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, </span>
<span>                             <span class="co"># Specfiying at least 2 components so that there can be a 2-dimensional plot</span></span>
<span>                               exposure<span class="op">=</span><span class="va">exposure2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hamburger"</span>,<span class="st">"BSDS"</span><span class="op">)</span>,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>                             outcome <span class="op">=</span> <span class="va">outcome2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BMI"</span>,<span class="st">"T2D"</span><span class="op">)</span>,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>                             exposure_treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">19</span><span class="op">)</span>,</span>
<span>                             exposure_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                             confounder_ME <span class="op">=</span> <span class="va">covariates2</span>,</span>
<span>                             confounder_OE <span class="op">=</span> <span class="va">covariates2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Look at the barplot to have a more direct view on direct, indirect and total effects for each combination of exposure, mediator(princial component) and outcome.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mediation_plot_object3</span> <span class="op">&lt;-</span> <span class="fu">plot_mediation</span><span class="op">(</span><span class="va">mediation_object3</span>,</span>
<span>                                         cex <span class="op">=</span> <span class="fl">2</span><span class="co">#,</span></span>
<span>                                         <span class="co"># size of the text</span></span>
<span>                                         <span class="co">#by_row = "one_column"</span></span>
<span>                                         <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mediation_plot_object3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_11-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The barplot showed direct, indirect and total effect for each exposure-mediator-outcome combination. It is a convenient tool to check the direction and magnitude of mediation estimates.</p>
<ul>
<li>Red color represents significant positive effect (p&lt;0.05); Blue color represents significant negative effect (p&lt;0.05). Grey represents insignificant effect.</li>
<li>One star for p&lt;0.05; Two stars for p&lt;0.01; Three stars for p&lt;0.001.</li>
</ul>
</div>
</div>
<p>Add the mediation result into the TPObject.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPObject4</span> <span class="op">&lt;-</span> <span class="fu">add_mediation</span><span class="op">(</span><span class="va">TPObject3</span>, </span>
<span><span class="va">mediation_object3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Adding mediation to TPO
-------------------------
Note that the exposures, mediators and outcomes are selected and not necessarily reflect total number of variables

TPO mediation has used 2 mediators, 2 exposures, 2 outcomes
Mediators are turquoise, blue 
Exposures are Hamburger, BSDS 
Outcomes are BMI, T2D</code></pre>
</div>
</div>
<p>Make the triplot with mediation. We showed the aruguments you could use in the function here with default values.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mediation_triplot</span><span class="op">(</span></span>
<span>    <span class="va">TPObject4</span>,</span>
<span>    which_show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"APM"</span>,<span class="st">"PM"</span><span class="op">)</span>,</span>
<span>    <span class="co">##Which mediation estimate to show</span></span>
<span>    first_PC <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    <span class="co">##The first PC to map</span></span>
<span>    second_PC <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    <span class="co">##The second PC to map</span></span>
<span>    plotMed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co">##Whether to plot mediation estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span>    plotCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co">##Whether to plot correlations (TRUE; default) or suppress them (FALSE)</span></span>
<span>    plotRisk <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    <span class="co">##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span>    <span class="co">###############################################</span></span>
<span>    <span class="co">##For correlations</span></span>
<span>    colCorr <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    <span class="co">##Color vector for correlations</span></span>
<span>    pchCorr <span class="op">=</span> <span class="fl">16</span>,</span>
<span>    <span class="co">##Plotting character for correlations</span></span>
<span>    corrLim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="co">##Plot range for correlations</span></span>
<span>    corrLabels <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    <span class="co">##Add labels on exposures</span></span>
<span>    <span class="co">###############################################</span></span>
<span>    <span class="co">##For risks</span></span>
<span>    colRisk <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    <span class="co">##Color vector for risk estimates</span></span>
<span>    pchRisk <span class="op">=</span> <span class="fl">15</span>,</span>
<span>    <span class="co">##Plotting character for risk estimates</span></span>
<span>    riskLim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="co">##Plot range for risks</span></span>
<span>    Whisker_percentage_risk <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    <span class="co">##whisker length is how many percentage of confidence interval</span></span>
<span>    riskLabels <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    <span class="co">##Add labels on outcomes</span></span>
<span>    riskOR <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    <span class="co">#plot the risk estimates as odds ratio</span></span>
<span>    <span class="co">###############################################</span></span>
<span>    <span class="co">##For mediations</span></span>
<span>    colmed <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>    <span class="co">##Color vector for mediation estimates</span></span>
<span>    pchmed <span class="op">=</span> <span class="fl">17</span>,</span>
<span>    <span class="co">##Plotting character for mediation estimates</span></span>
<span>    medLim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    <span class="co">##Plot range for mediations</span></span>
<span>    Whisker_percentage_med<span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>    <span class="co">##whisker length is how many percentage of confidence interval</span></span>
<span>    medLabels <span class="op">=</span> <span class="cn">T</span>,</span>
<span>    <span class="co">##Add labels on mediation estimates</span></span>
<span>    <span class="co">#########################################</span></span>
<span>    </span>
<span>    size <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="co"># the size of points ont he plot</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Only showing the mediation results.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span><span class="op">$</span><span class="va">mediation_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_13-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>Note that only the proportion mediated (PM) and adjusted proportion mediated(APM) is presented as darkgreen triangle points on the mediation plot. This is because we specified that we only want to show them using <code>which_show = c("PM", "APM")</code> in the <code>mediation_triplot()</code> function.</p>
<p>The plot is a bit messy, all the points are crowded together. You could specify <code>which_show = c("PM")</code> and <code>which_show = c(APM")</code> respectively and re-run the <code>mediation_triplot()</code> function to see proportion mediated and adjusted proportion mediated separately. We first show the result of specifying <code>which_show = c("PM")</code> here.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mediation_triplot</span><span class="op">(</span></span>
<span>    <span class="va">TPObject4</span>,</span>
<span>    which_show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PM"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span><span class="op">$</span><span class="va">mediation_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_13B-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_13B-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>We could see four data points on the figure, which represents the eight combinations of exposures, mediators and outcomes.</p>
<ul>
<li>exposure=BSDS, mediator= module 1, outcome=BMI</li>
<li>exposure=BSDS, mediator= module 2, outcome=BMI</li>
<li>exposure=Hamburger, mediator= module 1, outcome=BMI</li>
<li>exposure=Hamburger, mediator= module 2, outcome=BMI</li>
<li>exposure=BSDS, mediator= module 1, outcome=T2D</li>
<li>exposure=BSDS, mediator= module 2, outcome=T2D</li>
<li>exposure=Hamburger, mediator= module 1, outcome=T2D</li>
<li>exposure=Hamburger, mediator= module 2, outcome=T2D</li>
</ul>
<p>We could view from the confidence intervals on the figure already that some PM is not significant. A huge confidence interval presented on the plot has pushed the triangle points to the origin. We want to zoom in and see which dimensions the points are in.</p>
<p>We therefore adjust the limit of the proportion mediated to zoom in on the points. <code>"medLim = 2.5"</code> means that the limit showing on the plot will be from -2.5 to 2.5.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mediation_triplot</span><span class="op">(</span></span>
<span>    <span class="va">TPObject4</span>,</span>
<span>    which_show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PM"</span><span class="op">)</span>,</span>
<span>    medLim <span class="op">=</span> <span class="fl">2.5</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span><span class="op">$</span><span class="va">mediation_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_errorbarh()`).</code></pre>
</div>
<details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_13D-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_13D-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>In the figure, we could see the direction and magnitude of proportion mediated for the 2 mediators, all the exposures and outcomes. We also notice that the PM for BSDS-module 1-BMI and BSDS-module 2-BMI mediation is significant.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Note that some confidence intervals are automatically removed from the figure if they are not within the limit.</li>
<li>Note that for some mediations, direct effect and indirect effects are in the opposite direction, implying possibly proportion mediated(PM)&gt;1, since total effect could be smaller than indirect effect.</li>
</ul>
</div>
</div>
<p>we then further look at the adjusted proportion mediated (APM):</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">mediation_triplot</span><span class="op">(</span></span>
<span>    <span class="va">TPObject4</span>,</span>
<span>    which_show <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"APM"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span><span class="op">$</span><span class="va">mediation_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_13F-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_13F-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>By observing this figure, we could see the direction and magnitude of adjusted proportion mediated for the 2 mediators, all the exposures and outcomes. The position of the points is similar what we have seen for proportion mediated. Note that APM for BSDS as exposure and T2D as outcome is smaller than their PM. This is because the indirect and direct effect for this mediation is of similar size but in opposite direction. This leads to a smaller total effect and in turn larger PM, but APM will not be affected by the directionality of the direct and indirect effect.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>No confidence interval is shown for adjusted proportion mediated, as such value can not be directly calculated from the mediation analysis.</p></li>
<li><p>Note that even direct effect and indirect effects are in the opposite direction, adjusted proportion mediated is always smaller than 1, since it uses the sum of the absolute value of indirect and direct effect as denominator. <span class="math display">\[APM=\frac{IE}{|IE|+|DE|}\cdot\frac{|IE+DE|}{IE+DE}=\frac{IE}{IE+DE}\cdot\frac{|IE+DE|}{|IE|+|DE|}=\frac{IE}{|IE|+|DE|}\cdot\frac{IE+DE}{|IE+DE|}\]</span></p></li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want, you could specify <code>which_show = c("PM", "APM", "IE","TE")</code> in the <code>mediation_troplot()</code> to show all the estimates (IE for indirect effect and TE for total effect). However, it is not recommended, since the plot will get even messier if you put estimates and proportion mediated on the same plot.</p>
<p>If you go to <a href="./simple_code.html" target="_blank">Tutorial(simple)</a>, you can view the plot when showing <code>"IE"</code> and <code>"TE"</code>.</p>
</div>
</div>
<p>Plotting the triplot with mediation,</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object4</span><span class="op">$</span><span class="va">final_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_14-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>Base on the barplot and the triplot with mediation, we have observed significant proportion mediated for BSDS-module 1/2-BMI mediations. Further exploration on indirect, direct and total effect of the mediation analysis could be explored by playing around the <code>which_show</code> argument in the <code>mediation_troplot()</code> function. We will not go into details here.</p>
</section><section id="step-5-compare-correlations-associations-and-mediations" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="step-5-compare-correlations-associations-and-mediations">
<span class="header-section-number">4.5</span> Step 5: Compare correlations, associations and mediations</h2>
<p>Users can check the heatmaps of correlations, risk estimations and mediation results from the TPObject through the <code>checkTPO_ggplot()</code> function in TriplotGUI.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span> <span class="op">&lt;-</span> <span class="fu">checkTPO_ggplot</span><span class="op">(</span><span class="va">TPObject4</span>,</span>
<span>                                  which_med <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IE"</span>,<span class="st">"TE"</span>,<span class="st">"PM"</span>,<span class="st">"APM"</span><span class="op">)</span>,</span>
<span>                                  <span class="co">## What type of mediation estimate or proportion mediated to show on the heatmap</span></span>
<span>                                  which_PC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"turquoise"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                                  <span class="co">## What mediators (principal component) you want to show</span></span>
<span>                                  which_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hamburger"</span>,<span class="st">"BSDS"</span><span class="op">)</span>,</span>
<span>                                  <span class="co">## What exposure variables you want to show</span></span>
<span>                                  which_risk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T2D"</span>,<span class="st">"BMI"</span><span class="op">)</span></span>
<span>                                  <span class="co">## What outcome variables you want to show</span></span>
<span>                                  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Correlation coefficients and p values between modules and exposures:</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span><span class="op">$</span><span class="va">corr_coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_15A-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_15A-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>Risk estimates(beta coefficients) and p values between modules and outcomes:</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span><span class="op">$</span><span class="va">risk_coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_15B-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_15B-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>Mediation estimates and p values for indirect effect(IE) and total effect(TE), proportion mediated(PM) and adjusted proportion mediated(APM): See <a href="./workflow.html" target="_blank">Manual</a> for more details:</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span><span class="op">$</span><span class="va">med_coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_15C-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_15C-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>You could also View the three plots aboved combinedly.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span><span class="op">$</span><span class="va">corr_risk_med_coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div class="quarto-figure quarto-figure-right">
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_15D-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_15D-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>One star for p&lt;0.05; Two stars for p&lt;0.01; Three stars for p&lt;0.001.</li>
<li>Note that in the plot of <code>checkTPbject4$med_coefficients</code>, only the selected exposures, mediators and outcomes that we use to do mediation on will show up. The rows in the heatmaps are mediators and the column represents exposure-outcome pairs. For each exposure_outcome pair, 4 result are shown: <em>IE</em> (indirect effect), <em>TE</em> (total effect), <em>PM</em>(Proportion Mediated) and <em>APM</em>(Adjusted Proportion Mediated). Please see <a href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/workflow.html#5.2" target="_blank">manual</a> section for more information. The “CF” before the names of exposures-outcome pairs means that this mediation is using the Counterfactual method.</li>
</ul>
</div>
</div>
</section><section id="step-6-download-data" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="step-6-download-data">
<span class="header-section-number">4.6</span> Step 6: Download data</h2>
<p>We can save all your output, including data, results and visualization output through the <code><a href="https://rdrr.io/r/base/save.html">save()</a></code> function as an rda file.</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">exposure2</span>,<span class="va">Omics2</span>,<span class="va">outcome2</span>,<span class="va">covariates2</span>,<span class="va">auxilariy2</span>,</span>
<span>     <span class="va">reduced_Omics2</span>,<span class="va">Correlations_object</span>,<span class="va">Risks_objects</span>,</span>
<span>     <span class="va">mediation_object3</span>,<span class="va">mediation_plot_object3</span>,</span>
<span>     <span class="va">TPObject1</span>,<span class="va">TPObject2</span>,<span class="va">TPObject3</span>,<span class="va">TPObject4</span>,</span>
<span>     <span class="va">checkTPObject4</span>,</span>
<span>     <span class="st">"Tutorial_complex_output.rda"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb60" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tutorial(complex) - Code"</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co">   - lightbox</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> auto</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Complex demo of using TriplotGUI's code"</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner-color:</span><span class="co"> white</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-categories:</span><span class="co"> false</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="an">page-layout:</span><span class="co"> full</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co">    margin-top: 0em</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="co">    margin-bottom: 0em</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="co">    padding-top: 0em</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co">    padding-bottom: 0em</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="co">    minimal: true</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-responsive: true</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: Tutorial</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true  ## add number in the session or not</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 4</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight: tango</span></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged  ## kable is another option How the dataframe looks like </span></span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a><span class="co">    standalone: false  ### specifies if all assets and libraries must be integrated into the output html file as a standalone document.</span></span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-align: right</span></span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:  solar</span></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a><span class="an">geometry:</span><span class="co"> margin=lin  </span></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="do">##This is a function that combines html and rmarkdown. It aims to generate a button that could hide output or plot (fold.output=T or fold.plot=T).</span></span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>hooks <span class="ot">=</span> knitr<span class="sc">::</span>knit_hooks<span class="sc">$</span><span class="fu">get</span>()</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>hook_foldable <span class="ot">=</span> <span class="cf">function</span>(type) {</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">force</span>(type)</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x, options) {</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">=</span> hooks[[type]](x, options)</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">isTRUE</span>(options[[<span class="fu">paste0</span>(<span class="st">"fold."</span>, type)]])) <span class="fu">return</span>(res)</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;details&gt;&lt;summary&gt;"</span>, type, <span class="st">"&lt;/summary&gt;</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>      res,</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>      <span class="st">"</span><span class="sc">\n\n</span><span class="st">&lt;/details&gt;"</span></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>knit_hooks<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="fu">hook_foldable</span>(<span class="st">"output"</span>),</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="fu">hook_foldable</span>(<span class="st">"plot"</span>)</span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>Before starting, please make sure you have installed the TriplotGUI package following <span class="co">[</span><span class="ot">Setup</span><span class="co">](installation.qmd)</span>{target="_blank" style="color:blue"}.</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>The code of at this page can be downloaded <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/HealthyNordicDiet_2_applying_TriplotGUI_code.R)</span>{target="_blank"}</span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data description</span></span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>The data used in this tutorial section can be downloaded <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda)</span>{target="_blank"} in rda format.</span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a>The Data used for this example of code is ***HealthyNordicDiet_2***, modified from the **HealthyNordicDiet** data provided by the [*triplot*](https://gitlab.com/CarlBrunius/triplot/-/blob/master/vignettes/Triplot_Tutorial.md?ref_type=heads){target="_blank"} package (Schillemans et al. 2019). **HealthyNordicDiet** is a synthetic dataset that was simulated from the authentic data used in a case/control study nested within the Swedish prospective Västerbotten Intervention Programme cohort. The original study was set up to explore plasma metabolites that could objectively reflect healthy Nordic dietary patterns in a matched case-control study and to assess associations between such patterns and later development of type 2 diabetes. (Shi et al. 2018). The simulated data ***HealthyNordicDiet_2*** is a list that contains three data frames:</span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Clinical measurements (ClinData, 11 variables): <span class="in">`"ID"`</span>,<span class="in">`"T2D"`</span>(Cases and controls for type 2 diabetes), <span class="in">`"PairedInfo"`</span>(Pairing/matching information for case and controls, a unique number is assigned to each case-control pairs),<span class="in">`"Energy"`</span>,<span class="in">`"Gender"`</span>,<span class="in">`"Age"`</span>,<span class="in">`"BMI"`</span>,<span class="in">`"Smoking"`</span>,<span class="in">`"PhysicalActivityIndex"`</span>,<span class="in">`"Education"`</span>,<span class="in">`"FastingGlucose"`</span>.\</span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Plasma metabolites predictive of BMI (MetaboliteData, 20 variables)</span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dietary intake as measured by food frequency questionnaires (FoodData, 11 variables): <span class="in">`"HFI"`</span>(Healthy Food Index),<span class="in">`"BSDS"`</span>(the Baltic Sea Diet Score),<span class="in">`"Wholegrains"`</span>,<span class="in">`"Sausage"`</span>,<span class="in">`"Pizza"`</span>,<span class="in">`"Refined.bread"`</span>, <span class="in">`"Fruits"`</span>,<span class="in">`"Liquor"`</span>,<span class="in">`"Wine"`</span>,<span class="in">`"Hamburger"`</span>,<span class="in">`"Poultry"`</span>,<span class="in">`"Fish"`</span>,<span class="in">`"Margarine"`</span>,<span class="in">`"Cabbage"`</span>,<span class="in">`"Carrot"`</span>,<span class="in">`"low_fat_Dairy"`</span>,<span class="in">`"Vegetables"`</span></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a>The data frames are row-wise matched by observations and consist of 1000 synthetic observations.</span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>**Reference**</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a>Shi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., &amp; Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. *The American Journal of Clinical Nutrition*, 108(3), 564-575. <span class="co">[</span><span class="ot">10.1093/ajcn/nqy145</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub)</span>{target="_blank"}</span>
<span id="cb60-81"><a href="#cb60-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-82"><a href="#cb60-82" aria-hidden="true" tabindex="-1"></a>Schillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. *Metabolites*. 2019 Jul 6;9(7):133. <span class="co">[</span><span class="ot">doi: 10.3390/metabo9070133</span><span class="co">](https://www.mdpi.com/2218-1989/9/7/133)</span>{target="_blank"}</span>
<span id="cb60-83"><a href="#cb60-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-84"><a href="#cb60-84" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research question</span></span>
<span id="cb60-85"><a href="#cb60-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-86"><a href="#cb60-86" aria-hidden="true" tabindex="-1"></a>We want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI. We assume that metabolites serves as mediators, mediating the effect of dietary exposures on Type 2 diabetes and BMI.</span>
<span id="cb60-87"><a href="#cb60-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-88"><a href="#cb60-88" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data exploration</span></span>
<span id="cb60-89"><a href="#cb60-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-90"><a href="#cb60-90" aria-hidden="true" tabindex="-1"></a>***HealthyNordicDiet_2*** is loaded in the R environment up on running <span class="in">`library(TriplotGUI)`</span>. We will do some data exploration first to see how the data looks like.</span>
<span id="cb60-91"><a href="#cb60-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-92"><a href="#cb60-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r noshowcode_runcode_noshowoutput_1}</span></span>
<span id="cb60-93"><a href="#cb60-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-94"><a href="#cb60-94" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb60-95"><a href="#cb60-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-96"><a href="#cb60-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-97"><a href="#cb60-97" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TriplotGUI)</span>
<span id="cb60-98"><a href="#cb60-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-99"><a href="#cb60-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-100"><a href="#cb60-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-101"><a href="#cb60-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check HealthyNordicDiet_2</span></span>
<span id="cb60-102"><a href="#cb60-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-103"><a href="#cb60-103" aria-hidden="true" tabindex="-1"></a>Check the ***HealthyNordicDiet_2*** list:</span>
<span id="cb60-104"><a href="#cb60-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-105"><a href="#cb60-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_1}</span></span>
<span id="cb60-106"><a href="#cb60-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-107"><a href="#cb60-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-108"><a href="#cb60-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-109"><a href="#cb60-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-110"><a href="#cb60-110" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(HealthyNordicDiet_2)</span>
<span id="cb60-111"><a href="#cb60-111" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(HealthyNordicDiet_2)</span>
<span id="cb60-112"><a href="#cb60-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-113"><a href="#cb60-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-114"><a href="#cb60-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check datasets</span></span>
<span id="cb60-115"><a href="#cb60-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-116"><a href="#cb60-116" aria-hidden="true" tabindex="-1"></a>Check the names of variables in each data:</span>
<span id="cb60-117"><a href="#cb60-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-118"><a href="#cb60-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_2}</span></span>
<span id="cb60-119"><a href="#cb60-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-120"><a href="#cb60-120" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-121"><a href="#cb60-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-122"><a href="#cb60-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-123"><a href="#cb60-123" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HealthyNordicDiet_2<span class="sc">$</span>ClinData)  </span>
<span id="cb60-124"><a href="#cb60-124" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HealthyNordicDiet_2<span class="sc">$</span>MetaboliteData)</span>
<span id="cb60-125"><a href="#cb60-125" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HealthyNordicDiet_2<span class="sc">$</span>FoodData)</span>
<span id="cb60-126"><a href="#cb60-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-127"><a href="#cb60-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-128"><a href="#cb60-128" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check variables' class</span></span>
<span id="cb60-129"><a href="#cb60-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-130"><a href="#cb60-130" aria-hidden="true" tabindex="-1"></a>We then transform the data to dataframe format and then use TriplotGUI's <span class="in">`checkdata()`</span> function in to examine the classes of variables.</span>
<span id="cb60-131"><a href="#cb60-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-132"><a href="#cb60-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_1}</span></span>
<span id="cb60-133"><a href="#cb60-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-134"><a href="#cb60-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-135"><a href="#cb60-135" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-136"><a href="#cb60-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-137"><a href="#cb60-137" aria-hidden="true" tabindex="-1"></a>ClinData <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(HealthyNordicDiet_2<span class="sc">$</span>ClinData)</span>
<span id="cb60-138"><a href="#cb60-138" aria-hidden="true" tabindex="-1"></a>MetaboliteData <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(HealthyNordicDiet_2<span class="sc">$</span>MetaboliteData)</span>
<span id="cb60-139"><a href="#cb60-139" aria-hidden="true" tabindex="-1"></a>FoodData <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(HealthyNordicDiet_2<span class="sc">$</span>FoodData)</span>
<span id="cb60-140"><a href="#cb60-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-141"><a href="#cb60-141" aria-hidden="true" tabindex="-1"></a>ClinData_check <span class="ot">&lt;-</span> <span class="fu">checkdata</span>(ClinData)</span>
<span id="cb60-142"><a href="#cb60-142" aria-hidden="true" tabindex="-1"></a>MetaboliteData_check <span class="ot">&lt;-</span> <span class="fu">checkdata</span>(MetaboliteData)</span>
<span id="cb60-143"><a href="#cb60-143" aria-hidden="true" tabindex="-1"></a>FoodData_check <span class="ot">&lt;-</span> <span class="fu">checkdata</span>(FoodData)</span>
<span id="cb60-144"><a href="#cb60-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-145"><a href="#cb60-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-146"><a href="#cb60-146" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_3}</span></span>
<span id="cb60-147"><a href="#cb60-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-148"><a href="#cb60-148" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-149"><a href="#cb60-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-150"><a href="#cb60-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-151"><a href="#cb60-151" aria-hidden="true" tabindex="-1"></a>ClinData_check<span class="sc">$</span>class_summary_statistics</span>
<span id="cb60-152"><a href="#cb60-152" aria-hidden="true" tabindex="-1"></a>MetaboliteData_check<span class="sc">$</span>class_summary_statistics</span>
<span id="cb60-153"><a href="#cb60-153" aria-hidden="true" tabindex="-1"></a>FoodData_check<span class="sc">$</span>class_summary_statistics</span>
<span id="cb60-154"><a href="#cb60-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-155"><a href="#cb60-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-156"><a href="#cb60-156" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-157"><a href="#cb60-157" aria-hidden="true" tabindex="-1"></a>Note that in the given data, <span class="in">`"HFI"`</span>(Healthy Food Index) is a factor variable and <span class="in">`"BSDS"`</span>(the Baltic Sea Diet Score) is a numeric variable. You could use <span class="in">`table(FoodData$HFI)`</span> and <span class="in">`table(FoodData$BSDS)`</span> to check the difference.</span>
<span id="cb60-158"><a href="#cb60-158" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-159"><a href="#cb60-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-160"><a href="#cb60-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check sanities for variables</span></span>
<span id="cb60-161"><a href="#cb60-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-162"><a href="#cb60-162" aria-hidden="true" tabindex="-1"></a>Whether each variable contains missing (NA) or abnormal values (e.g. NAN, negative values, indefinite values, blank values) can also be checked.</span>
<span id="cb60-163"><a href="#cb60-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-164"><a href="#cb60-164" aria-hidden="true" tabindex="-1"></a>The previous <span class="in">`checkdata()`</span> function can also generate a table to summarize how many observations contain NA, NAN, zero, negative, indefinite(inf) and blank values(" ") and the percentages, for each variable in each data frame.</span>
<span id="cb60-165"><a href="#cb60-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-166"><a href="#cb60-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_1_1}</span></span>
<span id="cb60-167"><a href="#cb60-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-168"><a href="#cb60-168" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-169"><a href="#cb60-169" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-170"><a href="#cb60-170" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-171"><a href="#cb60-171" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)  <span class="do">## You may need to install.packages("kableExtra") first </span></span>
<span id="cb60-172"><a href="#cb60-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-173"><a href="#cb60-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-174"><a href="#cb60-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_4}</span></span>
<span id="cb60-175"><a href="#cb60-175" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-176"><a href="#cb60-176" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-177"><a href="#cb60-177" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-178"><a href="#cb60-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-179"><a href="#cb60-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-180"><a href="#cb60-180" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ClinData_check<span class="sc">$</span>everycolumn)</span>
<span id="cb60-181"><a href="#cb60-181" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(MetaboliteData_check<span class="sc">$</span>everycolumn)</span>
<span id="cb60-182"><a href="#cb60-182" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(FoodData_check<span class="sc">$</span>everycolumn)</span>
<span id="cb60-183"><a href="#cb60-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-184"><a href="#cb60-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-185"><a href="#cb60-185" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-186"><a href="#cb60-186" aria-hidden="true" tabindex="-1"></a>You shall only continue when the class of variables are correct and the missing or abnormal values in the variable are properly handled.</span>
<span id="cb60-187"><a href="#cb60-187" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-188"><a href="#cb60-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-189"><a href="#cb60-189" aria-hidden="true" tabindex="-1"></a><span class="fu">## Build data for analysis</span></span>
<span id="cb60-190"><a href="#cb60-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-191"><a href="#cb60-191" aria-hidden="true" tabindex="-1"></a>We treat food data as our exposures and BMI and type 2 diabetes as outcomes. Note that BMI is a continuous variable. We can additionally construct BMI as a categorical outcome using the criteria below and see how this may differ the result.</span>
<span id="cb60-192"><a href="#cb60-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-193"><a href="#cb60-193" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>BMI <span class="sc">\&lt;</span>= 18.5: Underweight</span>
<span id="cb60-194"><a href="#cb60-194" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>18.5 <span class="sc">\&lt;</span>BMI <span class="sc">\&lt;</span>= 25: Normal</span>
<span id="cb60-195"><a href="#cb60-195" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>25 <span class="sc">\&lt;</span> BMI <span class="sc">\&lt;</span>= 30: Overweight</span>
<span id="cb60-196"><a href="#cb60-196" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>30 <span class="sc">\&lt;</span> BMI: Obese</span>
<span id="cb60-197"><a href="#cb60-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-198"><a href="#cb60-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_4_1}</span></span>
<span id="cb60-199"><a href="#cb60-199" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-200"><a href="#cb60-200" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-201"><a href="#cb60-201" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-202"><a href="#cb60-202" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-203"><a href="#cb60-203" aria-hidden="true" tabindex="-1"></a>BMI <span class="ot">&lt;-</span> ClinData[,<span class="st">"BMI"</span>]</span>
<span id="cb60-204"><a href="#cb60-204" aria-hidden="true" tabindex="-1"></a>BMI_cat <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(BMI))</span>
<span id="cb60-205"><a href="#cb60-205" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(BMI)){</span>
<span id="cb60-206"><a href="#cb60-206" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(BMI[i] <span class="sc">&lt;=</span> <span class="fl">18.5</span>){</span>
<span id="cb60-207"><a href="#cb60-207" aria-hidden="true" tabindex="-1"></a>    BMI_cat[i] <span class="ot">&lt;-</span> <span class="st">"underweight"</span></span>
<span id="cb60-208"><a href="#cb60-208" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span> (BMI[i] <span class="sc">&gt;</span> <span class="fl">18.5</span><span class="sc">&amp;</span>BMI[i] <span class="sc">&lt;=</span> <span class="dv">25</span>){</span>
<span id="cb60-209"><a href="#cb60-209" aria-hidden="true" tabindex="-1"></a>    BMI_cat[i] <span class="ot">&lt;-</span> <span class="st">"normal"</span></span>
<span id="cb60-210"><a href="#cb60-210" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(BMI[i] <span class="sc">&gt;</span> <span class="dv">25</span><span class="sc">&amp;</span>BMI[i] <span class="sc">&lt;=</span> <span class="dv">30</span>){</span>
<span id="cb60-211"><a href="#cb60-211" aria-hidden="true" tabindex="-1"></a>    BMI_cat[i] <span class="ot">&lt;-</span> <span class="st">"overweight"</span></span>
<span id="cb60-212"><a href="#cb60-212" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb60-213"><a href="#cb60-213" aria-hidden="true" tabindex="-1"></a>    BMI_cat[i] <span class="ot">&lt;-</span> <span class="st">"obese"</span></span>
<span id="cb60-214"><a href="#cb60-214" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-215"><a href="#cb60-215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb60-216"><a href="#cb60-216" aria-hidden="true" tabindex="-1"></a>BMI_cat <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(BMI_cat)</span>
<span id="cb60-217"><a href="#cb60-217" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-218"><a href="#cb60-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-219"><a href="#cb60-219" aria-hidden="true" tabindex="-1"></a>We want to explore the exposure-outcome relationships through the metabolomics data, using metabolites as assumed mediators. Gender, age, education, physical activity and smoking are used as potential confounders for exposure-mediator and mediator-outcome association. Auxiliary information regarding case-control matches, fasting glucose level, education and physical activity are also provided.</span>
<span id="cb60-220"><a href="#cb60-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-221"><a href="#cb60-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_5}</span></span>
<span id="cb60-222"><a href="#cb60-222" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-223"><a href="#cb60-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-224"><a href="#cb60-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-225"><a href="#cb60-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-226"><a href="#cb60-226" aria-hidden="true" tabindex="-1"></a>exposure2 <span class="ot">&lt;-</span> FoodData</span>
<span id="cb60-227"><a href="#cb60-227" aria-hidden="true" tabindex="-1"></a>Omics2 <span class="ot">&lt;-</span> MetaboliteData</span>
<span id="cb60-228"><a href="#cb60-228" aria-hidden="true" tabindex="-1"></a>outcome2 <span class="ot">&lt;-</span> <span class="fu">cbind.data.frame</span>(ClinData[,<span class="fu">c</span>(<span class="st">"T2D"</span>,<span class="st">"BMI"</span>)], BMI_cat)</span>
<span id="cb60-229"><a href="#cb60-229" aria-hidden="true" tabindex="-1"></a>covariates2 <span class="ot">&lt;-</span> ClinData[, <span class="fu">c</span>(<span class="st">"Gender"</span> ,<span class="st">"Age"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>,<span class="st">"Smoking"</span> )]</span>
<span id="cb60-230"><a href="#cb60-230" aria-hidden="true" tabindex="-1"></a>auxilary2 <span class="ot">&lt;-</span> ClinData[, <span class="fu">c</span>(<span class="st">"PairedInfo"</span>,<span class="st">"FastingGlucose"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>, <span class="st">"Energy"</span>)]</span>
<span id="cb60-231"><a href="#cb60-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-232"><a href="#cb60-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-233"><a href="#cb60-233" aria-hidden="true" tabindex="-1"></a><span class="fu"># Code example of using TriplotGUI</span></span>
<span id="cb60-234"><a href="#cb60-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-235"><a href="#cb60-235" aria-hidden="true" tabindex="-1"></a>We will use a complex settings in this example. Please go to <span class="co">[</span><span class="ot">Tutorial(simple)</span><span class="co">](simple_code.qmd)</span>{target="_blank"}.if you want to try simple settings.</span>
<span id="cb60-236"><a href="#cb60-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-237"><a href="#cb60-237" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 1: Data reduction of omics data {#simple_link}</span></span>
<span id="cb60-238"><a href="#cb60-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-239"><a href="#cb60-239" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`TriplotGUI`</span> package, first we perform dimension reduction, using weighted correlation network analysis (WGCNA) on metabolomics data.</span>
<span id="cb60-240"><a href="#cb60-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-241"><a href="#cb60-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_2}</span></span>
<span id="cb60-242"><a href="#cb60-242" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-243"><a href="#cb60-243" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-244"><a href="#cb60-244" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-245"><a href="#cb60-245" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-246"><a href="#cb60-246" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the complex settings</span></span>
<span id="cb60-247"><a href="#cb60-247" aria-hidden="true" tabindex="-1"></a>reduced_Omics2 <span class="ot">&lt;-</span> <span class="fu">PCAorWGCNA_plots</span>(<span class="at">dataframe =</span> Omics2,</span>
<span id="cb60-248"><a href="#cb60-248" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">plottype =</span> <span class="fu">c</span>(<span class="st">"scree"</span>,<span class="st">"score"</span>,<span class="st">"loading"</span>,<span class="st">"scoreloading"</span>),</span>
<span id="cb60-249"><a href="#cb60-249" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">pc_type =</span> <span class="st">"principal"</span>, </span>
<span id="cb60-250"><a href="#cb60-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Users can choose freely to use principal() instead of prcomp() to perform PCA.The result should be very similar, but principal() allows more functionalities</span></span>
<span id="cb60-251"><a href="#cb60-251" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">first_PC =</span> <span class="dv">1</span>,</span>
<span id="cb60-252"><a href="#cb60-252" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">second_PC=</span> <span class="dv">2</span>,</span>
<span id="cb60-253"><a href="#cb60-253" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">option =</span> <span class="st">"WGCNA"</span>,</span>
<span id="cb60-254"><a href="#cb60-254" aria-hidden="true" tabindex="-1"></a><span class="co"># In this example we use WGCNA to perform data reduction, therefore specifying `option="WGCNA"`.</span></span>
<span id="cb60-255"><a href="#cb60-255" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">scale =</span> T,</span>
<span id="cb60-256"><a href="#cb60-256" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">center =</span> T,</span>
<span id="cb60-257"><a href="#cb60-257" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">eigen_loading =</span> <span class="st">"loading"</span>,</span>
<span id="cb60-258"><a href="#cb60-258" aria-hidden="true" tabindex="-1"></a><span class="co"># If you want to show loading or scale it to eigevalues.</span></span>
<span id="cb60-259"><a href="#cb60-259" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">rotate =</span> <span class="st">"none"</span>,</span>
<span id="cb60-260"><a href="#cb60-260" aria-hidden="true" tabindex="-1"></a><span class="co"># This argument is inherited from the principal() function</span></span>
<span id="cb60-261"><a href="#cb60-261" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size_variable =</span> auxilary2<span class="sc">$</span>FastingGlucose,</span>
<span id="cb60-262"><a href="#cb60-262" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">size_variable_name =</span> <span class="st">"FastigGlucose"</span>,</span>
<span id="cb60-263"><a href="#cb60-263" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color_variable =</span> auxilary2<span class="sc">$</span>Education,</span>
<span id="cb60-264"><a href="#cb60-264" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color_variable_name =</span> <span class="st">"Education"</span>,</span>
<span id="cb60-265"><a href="#cb60-265" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">shape_variable =</span> auxilary2<span class="sc">$</span>PhysicalActivityIndex,</span>
<span id="cb60-266"><a href="#cb60-266" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">shape_variable_name =</span> <span class="st">"PhysicalActivityIndex"</span>,</span>
<span id="cb60-267"><a href="#cb60-267" aria-hidden="true" tabindex="-1"></a><span class="co"># The size,shape,color variables are used to differentiate points on the score plot and biplot </span></span>
<span id="cb60-268"><a href="#cb60-268" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">loadings_name =</span> T,</span>
<span id="cb60-269"><a href="#cb60-269" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the names of loadings</span></span>
<span id="cb60-270"><a href="#cb60-270" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">loadings_cutpercent =</span> <span class="fl">0.2</span>,</span>
<span id="cb60-271"><a href="#cb60-271" aria-hidden="true" tabindex="-1"></a><span class="co"># The loadings bigger than 20% of all the loadings will show up</span></span>
<span id="cb60-272"><a href="#cb60-272" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">minModuleSize =</span> <span class="dv">3</span></span>
<span id="cb60-273"><a href="#cb60-273" aria-hidden="true" tabindex="-1"></a><span class="co"># The mimimum number of variable in each cluster of WGCNA</span></span>
<span id="cb60-274"><a href="#cb60-274" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-275"><a href="#cb60-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-276"><a href="#cb60-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-277"><a href="#cb60-277" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-278"><a href="#cb60-278" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In WGCNA, Omics variables are separated into clusters. PCA are first performed on each cluster and the first principal component of each cluster will be used as the principal components (We call them modules) of WGCNA.</span>
<span id="cb60-279"><a href="#cb60-279" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>You could try out the arguments of the <span class="in">`PCAorWGCNA_plots()`</span> function and view the whole function <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCAorWGCNA_plots.R?ref_type=heads)</span>{target="_blank"}</span>
<span id="cb60-280"><a href="#cb60-280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>One important argument in the <span class="in">`PCAorWGCNA_plots()`</span> is <span class="in">`minModuleSize`</span>, which defines the minimum number of variables in each cluster. If this number is specified too high, for example, if you have 20 variables in total and you specify <span class="in">`minModuleSize=15`</span>, you may end up having all the 20 variables in one cluster. In this case, only the first principal component of the cluster will be used and be shown on both axes of the generated triplots.</span>
<span id="cb60-281"><a href="#cb60-281" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-282"><a href="#cb60-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-283"><a href="#cb60-283" aria-hidden="true" tabindex="-1"></a>You can see scree plot, score plot, loadings plot and biplot at this stage.</span>
<span id="cb60-284"><a href="#cb60-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-285"><a href="#cb60-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6A}</span></span>
<span id="cb60-286"><a href="#cb60-286" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-287"><a href="#cb60-287" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-288"><a href="#cb60-288" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-289"><a href="#cb60-289" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-290"><a href="#cb60-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-291"><a href="#cb60-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-292"><a href="#cb60-292" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="sc">$</span>scree_plot</span>
<span id="cb60-293"><a href="#cb60-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-294"><a href="#cb60-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-295"><a href="#cb60-295" aria-hidden="true" tabindex="-1"></a>In the scree plot, each cluster is named with different colors, and the column heights represents how much variance are explained by that cluster among the total variance. The darker color represents variance explained by the first principal component/module of each cluster. You may notice that in the grey cluster there is only darker color, not the lighter color. This is because there is only one variable in that cluster - which will also be used as its first principal component/module. (Even though we specified <span class="in">`minModuleSize=2`</span>, sometimes there are variables left out by clustering and become clusters of their own.)</span>
<span id="cb60-296"><a href="#cb60-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-297"><a href="#cb60-297" aria-hidden="true" tabindex="-1"></a>The clusters are listed from left to right base on the number of variables in each cluster. The left side cluster has the most number of variables and right side cluster has the least number of variables.</span>
<span id="cb60-298"><a href="#cb60-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-299"><a href="#cb60-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6B}</span></span>
<span id="cb60-300"><a href="#cb60-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-301"><a href="#cb60-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-302"><a href="#cb60-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-303"><a href="#cb60-303" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-304"><a href="#cb60-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-305"><a href="#cb60-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-306"><a href="#cb60-306" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="sc">$</span>score_plot</span>
<span id="cb60-307"><a href="#cb60-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-308"><a href="#cb60-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-309"><a href="#cb60-309" aria-hidden="true" tabindex="-1"></a>In the score plot, as the function previously specified, the observations are colored by education level, and the observations with different physical activity index are marked with different shape and the observations with different fasting glucose level are plotted in different size.</span>
<span id="cb60-310"><a href="#cb60-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-311"><a href="#cb60-311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6C}</span></span>
<span id="cb60-312"><a href="#cb60-312" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-313"><a href="#cb60-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-314"><a href="#cb60-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-315"><a href="#cb60-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-316"><a href="#cb60-316" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-317"><a href="#cb60-317" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-318"><a href="#cb60-318" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="sc">$</span>loading_plot</span>
<span id="cb60-319"><a href="#cb60-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-320"><a href="#cb60-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-321"><a href="#cb60-321" aria-hidden="true" tabindex="-1"></a>In the loading plot, you can see that the loadings are all in the direction along the axis. This is because we use first principal components/modules in each cluster. (It is not possible for a loading to be in the direction of another axis since the another axis represents a different principal component analysis.)</span>
<span id="cb60-322"><a href="#cb60-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-323"><a href="#cb60-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6D}</span></span>
<span id="cb60-324"><a href="#cb60-324" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-325"><a href="#cb60-325" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-326"><a href="#cb60-326" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-327"><a href="#cb60-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-328"><a href="#cb60-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-329"><a href="#cb60-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-330"><a href="#cb60-330" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="sc">$</span>scoreloading_plot</span>
<span id="cb60-331"><a href="#cb60-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-332"><a href="#cb60-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-333"><a href="#cb60-333" aria-hidden="true" tabindex="-1"></a>The biplot with both score and loading looks a bit messy since there are so many things on the plot.</span>
<span id="cb60-334"><a href="#cb60-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-335"><a href="#cb60-335" aria-hidden="true" tabindex="-1"></a>We then build a TPObject, which is used for saving information and passing them through steps in TriplotGUI.</span>
<span id="cb60-336"><a href="#cb60-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-337"><a href="#cb60-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_7}</span></span>
<span id="cb60-338"><a href="#cb60-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-339"><a href="#cb60-339" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-340"><a href="#cb60-340" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-341"><a href="#cb60-341" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-342"><a href="#cb60-342" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb60-343"><a href="#cb60-343" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> reduced_Omics2<span class="sc">$</span>object<span class="sc">$</span>scores</span>
<span id="cb60-344"><a href="#cb60-344" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> reduced_Omics2<span class="sc">$</span>object<span class="sc">$</span>loadings</span>
<span id="cb60-345"><a href="#cb60-345" aria-hidden="true" tabindex="-1"></a>variance <span class="ot">&lt;-</span> reduced_Omics2<span class="sc">$</span>object<span class="sc">$</span>variance</span>
<span id="cb60-346"><a href="#cb60-346" aria-hidden="true" tabindex="-1"></a>TPObject1 <span class="ot">&lt;-</span> <span class="fu">makeTPO</span>(<span class="at">scores =</span> scores,</span>
<span id="cb60-347"><a href="#cb60-347" aria-hidden="true" tabindex="-1"></a>                     <span class="at">loadings =</span> loadings,</span>
<span id="cb60-348"><a href="#cb60-348" aria-hidden="true" tabindex="-1"></a>                     <span class="at">variance =</span> variance)</span>
<span id="cb60-349"><a href="#cb60-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-350"><a href="#cb60-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-351"><a href="#cb60-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-352"><a href="#cb60-352" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 2: Exposure correlations &amp; Outcome associations</span></span>
<span id="cb60-353"><a href="#cb60-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-354"><a href="#cb60-354" aria-hidden="true" tabindex="-1"></a>The correlations between modules and food items were calculated using Pearson correlations, adjusting for confounders. The associations between modules and risk markers were investigated using linear regression.</span>
<span id="cb60-355"><a href="#cb60-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-356"><a href="#cb60-356" aria-hidden="true" tabindex="-1"></a>Correlation matrix of correlation coefficients and p values between the modules saved in the TPObject and the dietary variables in the exposure data is generated, using a pair-wise Pearson correlations, adjusting for confounders.</span>
<span id="cb60-357"><a href="#cb60-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-358"><a href="#cb60-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_3}</span></span>
<span id="cb60-359"><a href="#cb60-359" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-360"><a href="#cb60-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-361"><a href="#cb60-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-362"><a href="#cb60-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-363"><a href="#cb60-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb60-364"><a href="#cb60-364" aria-hidden="true" tabindex="-1"></a>Correlations_object <span class="ot">&lt;-</span> <span class="fu">makeCorr</span>(<span class="at">TPObject =</span> TPObject1,</span>
<span id="cb60-365"><a href="#cb60-365" aria-hidden="true" tabindex="-1"></a>                                <span class="at">corrData =</span> exposure2,</span>
<span id="cb60-366"><a href="#cb60-366" aria-hidden="true" tabindex="-1"></a>                                <span class="at">use =</span> <span class="st">'pairwise'</span>, </span>
<span id="cb60-367"><a href="#cb60-367" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># use inherit from cor() function </span></span>
<span id="cb60-368"><a href="#cb60-368" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">'pearson'</span>,</span>
<span id="cb60-369"><a href="#cb60-369" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># method inherit from cor() function </span></span>
<span id="cb60-370"><a href="#cb60-370" aria-hidden="true" tabindex="-1"></a>                                <span class="at">allowcategorical =</span> F,</span>
<span id="cb60-371"><a href="#cb60-371" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># one-hot-encoding on categorical exposures</span></span>
<span id="cb60-372"><a href="#cb60-372" aria-hidden="true" tabindex="-1"></a>                                <span class="at">partial =</span> T,</span>
<span id="cb60-373"><a href="#cb60-373" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># perform confonder adjustment</span></span>
<span id="cb60-374"><a href="#cb60-374" aria-hidden="true" tabindex="-1"></a>                                <span class="at">confounder =</span> covariates2)</span>
<span id="cb60-375"><a href="#cb60-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-376"><a href="#cb60-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-377"><a href="#cb60-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-378"><a href="#cb60-378" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-379"><a href="#cb60-379" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`allowcategorical=F`</span> performs one-hot-encoding to transform categorical exposures variables with n<span class="sc">\&gt;</span>2 classes to n binary variables. You can use <span class="in">`Correlations_object$cor_estimate`</span> to check that each HFI level is separated in to a binary variable and the correlation coefficients between modules and the binary variables were calculated. </span>
<span id="cb60-380"><a href="#cb60-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-381"><a href="#cb60-381" aria-hidden="true" tabindex="-1"></a>     If <span class="in">`allowcategorical=T`</span> is specified, then no transformation is made on the <span class="in">`"HFI"`</span> variable. Linear models regressing modules on the <span class="in">`"HFI"`</span> variable are used for correlation analysis. The correlation coefficients are calculated as the square root of the proportion of sum of squares for HFI in the total sum of squares.</span>
<span id="cb60-382"><a href="#cb60-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-383"><a href="#cb60-383" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`partial=T`</span> specifies that the confounders will be adjusted.</span>
<span id="cb60-384"><a href="#cb60-384" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-385"><a href="#cb60-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-386"><a href="#cb60-386" aria-hidden="true" tabindex="-1"></a>The result of correlations are then added into the TPObject.</span>
<span id="cb60-387"><a href="#cb60-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-388"><a href="#cb60-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_8}</span></span>
<span id="cb60-389"><a href="#cb60-389" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-390"><a href="#cb60-390" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-391"><a href="#cb60-391" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-392"><a href="#cb60-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-393"><a href="#cb60-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb60-394"><a href="#cb60-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-395"><a href="#cb60-395" aria-hidden="true" tabindex="-1"></a>TPObject2 <span class="ot">&lt;-</span> <span class="fu">addCorr</span>(<span class="at">TPObject =</span> TPObject1,</span>
<span id="cb60-396"><a href="#cb60-396" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Corr =</span> Correlations_object<span class="sc">$</span>cor_estimate,</span>
<span id="cb60-397"><a href="#cb60-397" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Corr_p =</span> Correlations_object<span class="sc">$</span>cor_pvalue)</span>
<span id="cb60-398"><a href="#cb60-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-399"><a href="#cb60-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-400"><a href="#cb60-400" aria-hidden="true" tabindex="-1"></a>Matrices of risk estimates and p values between the modules saved in the TPObject and the outcome variables are generated, adjusting for confounders.</span>
<span id="cb60-401"><a href="#cb60-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-402"><a href="#cb60-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_4}</span></span>
<span id="cb60-403"><a href="#cb60-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-404"><a href="#cb60-404" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-405"><a href="#cb60-405" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-406"><a href="#cb60-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-407"><a href="#cb60-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb60-408"><a href="#cb60-408" aria-hidden="true" tabindex="-1"></a>Risks_object <span class="ot">&lt;-</span> <span class="fu">coefficient_get</span>(<span class="at">TPObject =</span> TPObject2,</span>
<span id="cb60-409"><a href="#cb60-409" aria-hidden="true" tabindex="-1"></a>                                <span class="at">outcome =</span> outcome2,</span>
<span id="cb60-410"><a href="#cb60-410" aria-hidden="true" tabindex="-1"></a>                                <span class="at">confounder =</span> covariates2,</span>
<span id="cb60-411"><a href="#cb60-411" aria-hidden="true" tabindex="-1"></a>                                <span class="at">partial =</span> T,</span>
<span id="cb60-412"><a href="#cb60-412" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># performs confounder adjustment</span></span>
<span id="cb60-413"><a href="#cb60-413" aria-hidden="true" tabindex="-1"></a>                                <span class="at">multinomial =</span> T,</span>
<span id="cb60-414"><a href="#cb60-414" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># multinomial regression is used</span></span>
<span id="cb60-415"><a href="#cb60-415" aria-hidden="true" tabindex="-1"></a>                                <span class="at">pair =</span> auxilary2<span class="sc">$</span>PairedInfo,</span>
<span id="cb60-416"><a href="#cb60-416" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># use the pairing information of case and control</span></span>
<span id="cb60-417"><a href="#cb60-417" aria-hidden="true" tabindex="-1"></a>                                <span class="at">CI =</span> <span class="fl">0.95</span></span>
<span id="cb60-418"><a href="#cb60-418" aria-hidden="true" tabindex="-1"></a>                                <span class="co"># confidence interval</span></span>
<span id="cb60-419"><a href="#cb60-419" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb60-420"><a href="#cb60-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-421"><a href="#cb60-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-422"><a href="#cb60-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-423"><a href="#cb60-423" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-424"><a href="#cb60-424" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When <span class="in">`pair`</span> information is not provided:</span>
<span id="cb60-425"><a href="#cb60-425" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`multinomial=F`</span> means that one-hot-encoding will be first performed to transform outcome's categorical variables with n <span class="sc">\&gt;</span> 2 classes to n binary variables. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</span>
<span id="cb60-426"><a href="#cb60-426" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If specifying <span class="in">`multinomial=T`</span>, multinomial regression will be performed on outcome's categorical outcome variable with n <span class="sc">\&gt;</span> 2 classes, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</span>
<span id="cb60-427"><a href="#cb60-427" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When <span class="in">`pair`</span> information for case - control matches is provided:</span>
<span id="cb60-428"><a href="#cb60-428" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`multinomial=F`</span> means that one-hot-encoding will be first performed on outcome's categorical variables with n <span class="sc">\&gt;</span> 2 classes. And then conditional logistic regression will be performed on the binary variables and linear mixed model will be performed on continuous variables, using the pairing information.</span>
<span id="cb60-429"><a href="#cb60-429" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If specifying <span class="in">`multinomial=T`</span>, the pairing information will be ignored and not used (since the outcomes can have more than 2 classes), multinomial regression will be performed on outcome's categorical variable, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</span>
<span id="cb60-430"><a href="#cb60-430" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`partial=T`</span> specifies that the confounders will be adjusted.</span>
<span id="cb60-431"><a href="#cb60-431" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-432"><a href="#cb60-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-433"><a href="#cb60-433" aria-hidden="true" tabindex="-1"></a>The result of risk estimates are then added into the TPObject.</span>
<span id="cb60-434"><a href="#cb60-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-435"><a href="#cb60-435" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_9}</span></span>
<span id="cb60-436"><a href="#cb60-436" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-437"><a href="#cb60-437" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-438"><a href="#cb60-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-439"><a href="#cb60-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-440"><a href="#cb60-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb60-441"><a href="#cb60-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-442"><a href="#cb60-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-443"><a href="#cb60-443" aria-hidden="true" tabindex="-1"></a>TPObject3 <span class="ot">&lt;-</span> <span class="fu">addRisk</span>(<span class="at">TPObject =</span> TPObject2, </span>
<span id="cb60-444"><a href="#cb60-444" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Risk =</span> Risks_object)</span>
<span id="cb60-445"><a href="#cb60-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-446"><a href="#cb60-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-447"><a href="#cb60-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-448"><a href="#cb60-448" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 3: Visualization of Triplot</span></span>
<span id="cb60-449"><a href="#cb60-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-450"><a href="#cb60-450" aria-hidden="true" tabindex="-1"></a>Then we can generate Triplot using the TPObject: Note that Triplot can be generated from any TPObject. You can try out different argument in the <span class="in">`TriplotGUI()`</span> function. The function is a wrapper of <span class="in">`PCA_TriplotGUI()`</span> and <span class="in">`WGCNA_TriplotGUI()`</span>. You can view the functions respectively here: <span class="co">[</span><span class="ot">`TriplotGUI()`</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/TriplotGUI.R?ref_type=heads)</span>{target="_blank"}, [`PCA_TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCA_TriplotGUI.R?ref_type=heads){target="_blank"}, [`WGCNA_TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/WGCNA_TriplotGUI.R?ref_type=heads){target="_blank"}.</span>
<span id="cb60-451"><a href="#cb60-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-452"><a href="#cb60-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_5}</span></span>
<span id="cb60-453"><a href="#cb60-453" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-454"><a href="#cb60-454" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-455"><a href="#cb60-455" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-456"><a href="#cb60-456" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-457"><a href="#cb60-457" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb60-458"><a href="#cb60-458" aria-hidden="true" tabindex="-1"></a>Triplot_object3 <span class="ot">&lt;-</span> <span class="fu">TriplotGUI</span>(TPObject3,</span>
<span id="cb60-459"><a href="#cb60-459" aria-hidden="true" tabindex="-1"></a>                              <span class="at">first_PC =</span> <span class="dv">1</span>, <span class="do">## The first PC to map</span></span>
<span id="cb60-460"><a href="#cb60-460" aria-hidden="true" tabindex="-1"></a>                              <span class="at">second_PC =</span> <span class="dv">2</span>, <span class="do">## The first PC to map</span></span>
<span id="cb60-461"><a href="#cb60-461" aria-hidden="true" tabindex="-1"></a>                              <span class="at">plotLoads =</span> <span class="cn">TRUE</span>, <span class="do">##Whether to plot loadings (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb60-462"><a href="#cb60-462" aria-hidden="true" tabindex="-1"></a>                              <span class="at">plotScores =</span> <span class="cn">FALSE</span>, <span class="do">##Whether to plot scores (TRUE) or suppress them (FALSE; default)</span></span>
<span id="cb60-463"><a href="#cb60-463" aria-hidden="true" tabindex="-1"></a>                              <span class="at">plotCorr =</span> <span class="cn">TRUE</span>, <span class="do">##Whether to plot correlations (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb60-464"><a href="#cb60-464" aria-hidden="true" tabindex="-1"></a>                              <span class="at">plotRisk =</span> <span class="cn">TRUE</span>, <span class="do">##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb60-465"><a href="#cb60-465" aria-hidden="true" tabindex="-1"></a>                              <span class="do">###############################################</span></span>
<span id="cb60-466"><a href="#cb60-466" aria-hidden="true" tabindex="-1"></a>                              <span class="do">##For loadings</span></span>
<span id="cb60-467"><a href="#cb60-467" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadLabels =</span> <span class="cn">TRUE</span>, <span class="do">###Whether to plot variable loading labels (TRUE; default) or not (FALSE)</span></span>
<span id="cb60-468"><a href="#cb60-468" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadArrowLength =</span> <span class="fl">0.02</span>, <span class="do">###Length of arrow tip , set it as 0 if you want to remove it</span></span>
<span id="cb60-469"><a href="#cb60-469" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadCut =</span> <span class="dv">0</span>, <span class="do">###lower limit Loadings below the cut are plotted in light grey and without label</span></span>
<span id="cb60-470"><a href="#cb60-470" aria-hidden="true" tabindex="-1"></a>                              <span class="at">loadLim =</span> <span class="cn">NULL</span>, <span class="do">##higher limit,Plot range for loadings</span></span>
<span id="cb60-471"><a href="#cb60-471" aria-hidden="true" tabindex="-1"></a>                              <span class="do">###############################################</span></span>
<span id="cb60-472"><a href="#cb60-472" aria-hidden="true" tabindex="-1"></a>                              <span class="do">##For correlations</span></span>
<span id="cb60-473"><a href="#cb60-473" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colCorr =</span> <span class="st">"blue"</span>, <span class="do">##Color vector for correlations</span></span>
<span id="cb60-474"><a href="#cb60-474" aria-hidden="true" tabindex="-1"></a>                              <span class="at">pchCorr =</span> <span class="dv">16</span>, <span class="do">##Plotting character for correlations</span></span>
<span id="cb60-475"><a href="#cb60-475" aria-hidden="true" tabindex="-1"></a>                              <span class="at">whichCorr =</span> <span class="cn">NULL</span>, <span class="do">##Which correlations to plot (vector of numbers)</span></span>
<span id="cb60-476"><a href="#cb60-476" aria-hidden="true" tabindex="-1"></a>                              <span class="at">corLim =</span> <span class="cn">NULL</span>, <span class="do">##Plot range for correlations</span></span>
<span id="cb60-477"><a href="#cb60-477" aria-hidden="true" tabindex="-1"></a>                              <span class="at">corrLabels =</span> T, </span>
<span id="cb60-478"><a href="#cb60-478" aria-hidden="true" tabindex="-1"></a>                              <span class="do">###############################################</span></span>
<span id="cb60-479"><a href="#cb60-479" aria-hidden="true" tabindex="-1"></a>                              <span class="do">##For risks</span></span>
<span id="cb60-480"><a href="#cb60-480" aria-hidden="true" tabindex="-1"></a>                              <span class="at">colRisk =</span> <span class="st">"red"</span>, <span class="do">##Color vector for risk estimates</span></span>
<span id="cb60-481"><a href="#cb60-481" aria-hidden="true" tabindex="-1"></a>                              <span class="at">pchRisk =</span> <span class="dv">15</span>, <span class="do">##Plotting character for risk estimates</span></span>
<span id="cb60-482"><a href="#cb60-482" aria-hidden="true" tabindex="-1"></a>                              <span class="at">whichRisk =</span> <span class="cn">NULL</span>, <span class="do">##Which risk estimates to plot (vector of numbers)</span></span>
<span id="cb60-483"><a href="#cb60-483" aria-hidden="true" tabindex="-1"></a>                              <span class="at">riskLim =</span> <span class="cn">NULL</span>, <span class="do">##Plot range for risks</span></span>
<span id="cb60-484"><a href="#cb60-484" aria-hidden="true" tabindex="-1"></a>                              <span class="at">riskWhisker_percentage =</span> <span class="fl">0.1</span>, <span class="do">## whisker length is how many percentage of confidence interval</span></span>
<span id="cb60-485"><a href="#cb60-485" aria-hidden="true" tabindex="-1"></a>                              <span class="at">riskLabels =</span> T, <span class="at">size =</span> <span class="dv">3</span>, <span class="co"># the size of points ont he plot</span></span>
<span id="cb60-486"><a href="#cb60-486" aria-hidden="true" tabindex="-1"></a>                              <span class="at">riskOR =</span> T</span>
<span id="cb60-487"><a href="#cb60-487" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># plot the risk estimates as odds ratio</span></span>
<span id="cb60-488"><a href="#cb60-488" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb60-489"><a href="#cb60-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-490"><a href="#cb60-490" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-491"><a href="#cb60-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-492"><a href="#cb60-492" aria-hidden="true" tabindex="-1"></a>We then plot the triplot.</span>
<span id="cb60-493"><a href="#cb60-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-494"><a href="#cb60-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_10}</span></span>
<span id="cb60-495"><a href="#cb60-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-496"><a href="#cb60-496" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-497"><a href="#cb60-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-498"><a href="#cb60-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-499"><a href="#cb60-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-500"><a href="#cb60-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-501"><a href="#cb60-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-502"><a href="#cb60-502" aria-hidden="true" tabindex="-1"></a>Triplot_object3<span class="sc">$</span>triplot</span>
<span id="cb60-503"><a href="#cb60-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-504"><a href="#cb60-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-505"><a href="#cb60-505" aria-hidden="true" tabindex="-1"></a>In the triplot, the black arrows are loadings representing Omics variables. Blue circle points represents exposure correlations with the modules and the red square points represents outcome associations with the modules. So what information can we get from this figure? Lets us list a few points:</span>
<span id="cb60-506"><a href="#cb60-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-507"><a href="#cb60-507" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Having a brief look, the generally healthy food (e.g. <span class="in">`"Fruits"`</span>, <span class="in">`"Vegetables"`</span>) is on the first dimension of the figure and the generally unhealthy food (e.g. <span class="in">`"Hamburger"`</span>, <span class="in">`"Sausage"`</span>, <span class="in">`"Margarine"`</span>) is on the third dimension of the figure. The numeric outcome <span class="in">`"BMI"`</span>, binary outcome <span class="in">`"T2D"`</span>, and one-hot-encoded categorical <span class="in">`"BMI_cat"`</span> outcome is on the second and fourth dimension of the figure.</span>
<span id="cb60-508"><a href="#cb60-508" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Explanation on some variables in the plot:</span>
<span id="cb60-509"><a href="#cb60-509" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`"HFI"`</span> stands for healthy food index. A higher <span class="in">`"HFI"`</span> suggests healthier diet. <span class="in">`"HFI"`</span> ranges from 0 to 6. You can see that there are *HFI_0*, *HFI_1*...*HFI_6* in the figure and that is because `"HFI"` is used as a factor exposure variable in step 2 and is one-hot-encoded (`allowcategorical=F`) to the same number of binary variables as its number of levels. For example, *HFI_6* is a binary variable where individuals with `"HFI"` as 6 (most healthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. *HFI_0* is a binary variable where individuals with `"HFI"` as 0 (most unhealthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. *HFI_1*...*HFI_5* has limited use since it only separates the group of people with certain <span class="in">`"HFI"`</span> value from to the rest, which is a mixture of people with healthier and less healthier diet.</span>
<span id="cb60-510"><a href="#cb60-510" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`"BSDS"`</span> stands for Baltic Sea Diet Score ranging. A higher <span class="in">`"BSDS"`</span> suggests healthier diet. <span class="in">`"BSDS"`</span> is used as a numeric variable ranging from 2 to 25 in the correlation.</span>
<span id="cb60-511"><a href="#cb60-511" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*BMI_cat_obese*, *BMI_cat_overweight*, *BMI_cat_underweight* are the odds ratio generated from the multinomial regression. Since `"BMI_cat"` is a categorical outcome and multinomial regression is performed in step 2 (`multinomial=T`), normal weight is uses as a reference and odds ratio of obese, overweight and underweight is produced. (Note that the first level of the factor variable is set as the default reference, in this case it is *normal*).</span>
<span id="cb60-512"><a href="#cb60-512" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjusting for <span class="in">`"Age"`</span>, <span class="in">`"Gender"`</span>, <span class="in">`"Smoking"`</span>, <span class="in">`"Education"`</span> and <span class="in">`"FastingGlucose"`</span>, the first module (on x-axis) correlates positively with generally healthy food (e.g. <span class="in">`"fruits"`</span>, <span class="in">`"vegatables"`</span>) and food index (e.g. <span class="in">`"BSDS"`</span>) and negatively with unhealthy food (e.g. <span class="in">`"Hamburger"`</span>, <span class="in">`"pizza"`</span>). It also reversely associated with <span class="in">`"T2D"`</span> and <span class="in">`"BMI"`</span>. From the result from <span class="in">`"BMI_cat"`</span>, this components also reversely associated with being obese.</span>
<span id="cb60-513"><a href="#cb60-513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjusting for <span class="in">`"Age"`</span>, <span class="in">`"Gender"`</span>, <span class="in">`"Smoking"`</span>, <span class="in">`"Education"`</span> and <span class="in">`"FastingGlucose"`</span>, the second module (on y-axis) associated positively with generally healthy food (e.g. <span class="in">`"fruits"`</span>, <span class="in">`"vegatables"`</span>) and food index (e.g. <span class="in">`"BSDS"`</span>) and negatively with unhealthy food (e.g. <span class="in">`"Hamburger"`</span>, <span class="in">`"pizza"`</span>). However, the module correlates also positively with <span class="in">`"T2D"`</span>,<span class="in">`"BMI"`</span>, *obese*, *overweight* and negatively associated with *underweight*.</span>
<span id="cb60-514"><a href="#cb60-514" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Based on what we summarized above, the two modules may be associated with a overall healthy eating pattern. And in such pattern, the first module is associated more with the beneficial effect on health and the second module represents the adverse health effect that may be caused by this pattern.</span>
<span id="cb60-515"><a href="#cb60-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-516"><a href="#cb60-516" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 4: Mediation analysis and visualization</span></span>
<span id="cb60-517"><a href="#cb60-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-518"><a href="#cb60-518" aria-hidden="true" tabindex="-1"></a>There are many things that you could explore further in the following mediation analysis. To narrow down our focus and clearly show our examples, we select <span class="in">`"BSDS"`</span> (Baltic Sea Diet Score) and <span class="in">`"Hamburger"`</span> as our exposures, <span class="in">`"BMI"`</span> and <span class="in">`"T2D"`</span> as outcome to enter our next step.</span>
<span id="cb60-519"><a href="#cb60-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-520"><a href="#cb60-520" aria-hidden="true" tabindex="-1"></a>This time, we perform the mediation analysis using the conterfactual/potential outcome method (the ´mediation´ package) on our exposures (i.e. <span class="in">`"BSDS"`</span>, <span class="in">`"Hamburger"`</span>), mediators (i.e. the first and second modules) and outcome (i.e. <span class="in">`"T2D"`</span>, <span class="in">`"BMI"`</span>) of interest, adjusting for <span class="in">`"Age"`</span>, <span class="in">`"Gender"`</span>, <span class="in">`"Smoking"`</span>, <span class="in">`"Education"`</span> and <span class="in">`"FastingGlucose"`</span> for both exposure-mediator and mediator-outcome relationship.</span>
<span id="cb60-521"><a href="#cb60-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-522"><a href="#cb60-522" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-523"><a href="#cb60-523" aria-hidden="true" tabindex="-1"></a>In the counterfactual mediation analysis, you need to specify contrast values of treatment and controls for each exposure. In brief, the algorithm will compare the scenarios with these 2 exposure values/levels. For my detailed explanation please refer to <span class="co">[</span><span class="ot">this paper</span><span class="co">](https://www.jstatsoft.org/article/view/v059i05)</span>{target="_blank"} of the <span class="in">`mediation`</span> R package.</span>
<span id="cb60-524"><a href="#cb60-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-525"><a href="#cb60-525" aria-hidden="true" tabindex="-1"></a>If an exposure variable is continuous (numeric variable), it is recommended that the 2 exposure values is chosen between the range of the exposure variable. If an exposure variable is categorical (factor variable), the 2 exposure levels should be chosen from the levels of the exposure variable.</span>
<span id="cb60-526"><a href="#cb60-526" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-527"><a href="#cb60-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-528"><a href="#cb60-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_6}</span></span>
<span id="cb60-529"><a href="#cb60-529" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-530"><a href="#cb60-530" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-531"><a href="#cb60-531" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-532"><a href="#cb60-532" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-533"><a href="#cb60-533" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb60-534"><a href="#cb60-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-535"><a href="#cb60-535" aria-hidden="true" tabindex="-1"></a>mediation_object3 <span class="ot">&lt;-</span> </span>
<span id="cb60-536"><a href="#cb60-536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_mediation_counterfactual</span> (<span class="at">mediator =</span> TPObject3<span class="sc">$</span>scores[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>),<span class="at">drop =</span> <span class="cn">FALSE</span>], </span>
<span id="cb60-537"><a href="#cb60-537" aria-hidden="true" tabindex="-1"></a>                             <span class="co"># Specfiying at least 2 components so that there can be a 2-dimensional plot</span></span>
<span id="cb60-538"><a href="#cb60-538" aria-hidden="true" tabindex="-1"></a>                               <span class="at">exposure=</span>exposure2[,<span class="fu">c</span>(<span class="st">"Hamburger"</span>,<span class="st">"BSDS"</span>),<span class="at">drop =</span> <span class="cn">FALSE</span>],</span>
<span id="cb60-539"><a href="#cb60-539" aria-hidden="true" tabindex="-1"></a>                             <span class="at">outcome =</span> outcome2[,<span class="fu">c</span>(<span class="st">"BMI"</span>,<span class="st">"T2D"</span>),<span class="at">drop =</span> <span class="cn">FALSE</span>],</span>
<span id="cb60-540"><a href="#cb60-540" aria-hidden="true" tabindex="-1"></a>                             <span class="at">exposure_treatment =</span> <span class="fu">c</span>(<span class="dv">25</span>,<span class="dv">19</span>),</span>
<span id="cb60-541"><a href="#cb60-541" aria-hidden="true" tabindex="-1"></a>                             <span class="at">exposure_control =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>),</span>
<span id="cb60-542"><a href="#cb60-542" aria-hidden="true" tabindex="-1"></a>                             <span class="at">confounder_ME =</span> covariates2,</span>
<span id="cb60-543"><a href="#cb60-543" aria-hidden="true" tabindex="-1"></a>                             <span class="at">confounder_OE =</span> covariates2)</span>
<span id="cb60-544"><a href="#cb60-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-545"><a href="#cb60-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-546"><a href="#cb60-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-547"><a href="#cb60-547" aria-hidden="true" tabindex="-1"></a>Look at the barplot to have a more direct view on direct, indirect and total effects for each combination of exposure, mediator(princial component) and outcome.</span>
<span id="cb60-548"><a href="#cb60-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-549"><a href="#cb60-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_7}</span></span>
<span id="cb60-550"><a href="#cb60-550" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-551"><a href="#cb60-551" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-552"><a href="#cb60-552" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-553"><a href="#cb60-553" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-554"><a href="#cb60-554" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-555"><a href="#cb60-555" aria-hidden="true" tabindex="-1"></a>mediation_plot_object3 <span class="ot">&lt;-</span> <span class="fu">plot_mediation</span>(mediation_object3,</span>
<span id="cb60-556"><a href="#cb60-556" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">cex =</span> <span class="dv">2</span><span class="co">#,</span></span>
<span id="cb60-557"><a href="#cb60-557" aria-hidden="true" tabindex="-1"></a>                                         <span class="co"># size of the text</span></span>
<span id="cb60-558"><a href="#cb60-558" aria-hidden="true" tabindex="-1"></a>                                         <span class="co">#by_row = "one_column"</span></span>
<span id="cb60-559"><a href="#cb60-559" aria-hidden="true" tabindex="-1"></a>                                         )</span>
<span id="cb60-560"><a href="#cb60-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-561"><a href="#cb60-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-562"><a href="#cb60-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-563"><a href="#cb60-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_11}</span></span>
<span id="cb60-564"><a href="#cb60-564" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-565"><a href="#cb60-565" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-566"><a href="#cb60-566" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-567"><a href="#cb60-567" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-568"><a href="#cb60-568" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-569"><a href="#cb60-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-570"><a href="#cb60-570" aria-hidden="true" tabindex="-1"></a>mediation_plot_object3</span>
<span id="cb60-571"><a href="#cb60-571" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-572"><a href="#cb60-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-573"><a href="#cb60-573" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-574"><a href="#cb60-574" aria-hidden="true" tabindex="-1"></a>The barplot showed direct, indirect and total effect for each exposure-mediator-outcome combination. It is a convenient tool to check the direction and magnitude of mediation estimates.</span>
<span id="cb60-575"><a href="#cb60-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-576"><a href="#cb60-576" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Red color represents significant positive effect (p<span class="sc">\&lt;</span>0.05); Blue color represents significant negative effect (p<span class="sc">\&lt;</span>0.05). Grey represents insignificant effect.</span>
<span id="cb60-577"><a href="#cb60-577" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>One star for p<span class="sc">\&lt;</span>0.05; Two stars for p<span class="sc">\&lt;</span>0.01; Three stars for p<span class="sc">\&lt;</span>0.001.</span>
<span id="cb60-578"><a href="#cb60-578" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-579"><a href="#cb60-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-580"><a href="#cb60-580" aria-hidden="true" tabindex="-1"></a>Add the mediation result into the TPObject.</span>
<span id="cb60-581"><a href="#cb60-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-582"><a href="#cb60-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_12}</span></span>
<span id="cb60-583"><a href="#cb60-583" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-584"><a href="#cb60-584" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-585"><a href="#cb60-585" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-586"><a href="#cb60-586" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-587"><a href="#cb60-587" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-588"><a href="#cb60-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-589"><a href="#cb60-589" aria-hidden="true" tabindex="-1"></a>TPObject4 <span class="ot">&lt;-</span> <span class="fu">add_mediation</span>(TPObject3, </span>
<span id="cb60-590"><a href="#cb60-590" aria-hidden="true" tabindex="-1"></a>mediation_object3)</span>
<span id="cb60-591"><a href="#cb60-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-592"><a href="#cb60-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-593"><a href="#cb60-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-594"><a href="#cb60-594" aria-hidden="true" tabindex="-1"></a>Make the triplot with mediation. We showed the aruguments you could use in the function here with default values.</span>
<span id="cb60-595"><a href="#cb60-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-596"><a href="#cb60-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_8}</span></span>
<span id="cb60-597"><a href="#cb60-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-598"><a href="#cb60-598" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-599"><a href="#cb60-599" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-600"><a href="#cb60-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-601"><a href="#cb60-601" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-602"><a href="#cb60-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-603"><a href="#cb60-603" aria-hidden="true" tabindex="-1"></a>Triplot_object4 <span class="ot">&lt;-</span></span>
<span id="cb60-604"><a href="#cb60-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mediation_triplot</span>(</span>
<span id="cb60-605"><a href="#cb60-605" aria-hidden="true" tabindex="-1"></a>    TPObject4,</span>
<span id="cb60-606"><a href="#cb60-606" aria-hidden="true" tabindex="-1"></a>    <span class="at">which_show =</span> <span class="fu">c</span>(<span class="st">"APM"</span>,<span class="st">"PM"</span>),</span>
<span id="cb60-607"><a href="#cb60-607" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Which mediation estimate to show</span></span>
<span id="cb60-608"><a href="#cb60-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_PC =</span> <span class="dv">1</span>,</span>
<span id="cb60-609"><a href="#cb60-609" aria-hidden="true" tabindex="-1"></a>    <span class="do">##The first PC to map</span></span>
<span id="cb60-610"><a href="#cb60-610" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_PC =</span> <span class="dv">2</span>,</span>
<span id="cb60-611"><a href="#cb60-611" aria-hidden="true" tabindex="-1"></a>    <span class="do">##The second PC to map</span></span>
<span id="cb60-612"><a href="#cb60-612" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotMed =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-613"><a href="#cb60-613" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Whether to plot mediation estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb60-614"><a href="#cb60-614" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotCorr =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-615"><a href="#cb60-615" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Whether to plot correlations (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb60-616"><a href="#cb60-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotRisk =</span> <span class="cn">TRUE</span>,</span>
<span id="cb60-617"><a href="#cb60-617" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb60-618"><a href="#cb60-618" aria-hidden="true" tabindex="-1"></a>    <span class="do">###############################################</span></span>
<span id="cb60-619"><a href="#cb60-619" aria-hidden="true" tabindex="-1"></a>    <span class="do">##For correlations</span></span>
<span id="cb60-620"><a href="#cb60-620" aria-hidden="true" tabindex="-1"></a>    <span class="at">colCorr =</span> <span class="st">"blue"</span>,</span>
<span id="cb60-621"><a href="#cb60-621" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Color vector for correlations</span></span>
<span id="cb60-622"><a href="#cb60-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">pchCorr =</span> <span class="dv">16</span>,</span>
<span id="cb60-623"><a href="#cb60-623" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Plotting character for correlations</span></span>
<span id="cb60-624"><a href="#cb60-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">corrLim =</span> <span class="cn">NULL</span>,</span>
<span id="cb60-625"><a href="#cb60-625" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Plot range for correlations</span></span>
<span id="cb60-626"><a href="#cb60-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">corrLabels =</span> T,</span>
<span id="cb60-627"><a href="#cb60-627" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Add labels on exposures</span></span>
<span id="cb60-628"><a href="#cb60-628" aria-hidden="true" tabindex="-1"></a>    <span class="do">###############################################</span></span>
<span id="cb60-629"><a href="#cb60-629" aria-hidden="true" tabindex="-1"></a>    <span class="do">##For risks</span></span>
<span id="cb60-630"><a href="#cb60-630" aria-hidden="true" tabindex="-1"></a>    <span class="at">colRisk =</span> <span class="st">"red"</span>,</span>
<span id="cb60-631"><a href="#cb60-631" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Color vector for risk estimates</span></span>
<span id="cb60-632"><a href="#cb60-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">pchRisk =</span> <span class="dv">15</span>,</span>
<span id="cb60-633"><a href="#cb60-633" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Plotting character for risk estimates</span></span>
<span id="cb60-634"><a href="#cb60-634" aria-hidden="true" tabindex="-1"></a>    <span class="at">riskLim =</span> <span class="cn">NULL</span>,</span>
<span id="cb60-635"><a href="#cb60-635" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Plot range for risks</span></span>
<span id="cb60-636"><a href="#cb60-636" aria-hidden="true" tabindex="-1"></a>    <span class="at">Whisker_percentage_risk =</span> <span class="fl">0.1</span>,</span>
<span id="cb60-637"><a href="#cb60-637" aria-hidden="true" tabindex="-1"></a>    <span class="do">##whisker length is how many percentage of confidence interval</span></span>
<span id="cb60-638"><a href="#cb60-638" aria-hidden="true" tabindex="-1"></a>    <span class="at">riskLabels =</span> T,</span>
<span id="cb60-639"><a href="#cb60-639" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Add labels on outcomes</span></span>
<span id="cb60-640"><a href="#cb60-640" aria-hidden="true" tabindex="-1"></a>    <span class="at">riskOR =</span> T,</span>
<span id="cb60-641"><a href="#cb60-641" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot the risk estimates as odds ratio</span></span>
<span id="cb60-642"><a href="#cb60-642" aria-hidden="true" tabindex="-1"></a>    <span class="do">###############################################</span></span>
<span id="cb60-643"><a href="#cb60-643" aria-hidden="true" tabindex="-1"></a>    <span class="do">##For mediations</span></span>
<span id="cb60-644"><a href="#cb60-644" aria-hidden="true" tabindex="-1"></a>    <span class="at">colmed =</span> <span class="st">"darkgreen"</span>,</span>
<span id="cb60-645"><a href="#cb60-645" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Color vector for mediation estimates</span></span>
<span id="cb60-646"><a href="#cb60-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">pchmed =</span> <span class="dv">17</span>,</span>
<span id="cb60-647"><a href="#cb60-647" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Plotting character for mediation estimates</span></span>
<span id="cb60-648"><a href="#cb60-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">medLim =</span> <span class="cn">NULL</span>,</span>
<span id="cb60-649"><a href="#cb60-649" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Plot range for mediations</span></span>
<span id="cb60-650"><a href="#cb60-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">Whisker_percentage_med=</span> <span class="fl">0.1</span>,</span>
<span id="cb60-651"><a href="#cb60-651" aria-hidden="true" tabindex="-1"></a>    <span class="do">##whisker length is how many percentage of confidence interval</span></span>
<span id="cb60-652"><a href="#cb60-652" aria-hidden="true" tabindex="-1"></a>    <span class="at">medLabels =</span> T,</span>
<span id="cb60-653"><a href="#cb60-653" aria-hidden="true" tabindex="-1"></a>    <span class="do">##Add labels on mediation estimates</span></span>
<span id="cb60-654"><a href="#cb60-654" aria-hidden="true" tabindex="-1"></a>    <span class="do">#########################################</span></span>
<span id="cb60-655"><a href="#cb60-655" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-656"><a href="#cb60-656" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb60-657"><a href="#cb60-657" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the size of points ont he plot</span></span>
<span id="cb60-658"><a href="#cb60-658" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-659"><a href="#cb60-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-660"><a href="#cb60-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-661"><a href="#cb60-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-662"><a href="#cb60-662" aria-hidden="true" tabindex="-1"></a>Only showing the mediation results.</span>
<span id="cb60-663"><a href="#cb60-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-664"><a href="#cb60-664" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_13}</span></span>
<span id="cb60-665"><a href="#cb60-665" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-666"><a href="#cb60-666" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-667"><a href="#cb60-667" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-668"><a href="#cb60-668" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-669"><a href="#cb60-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-670"><a href="#cb60-670" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-671"><a href="#cb60-671" aria-hidden="true" tabindex="-1"></a>Triplot_object4<span class="sc">$</span>mediation_plot</span>
<span id="cb60-672"><a href="#cb60-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-673"><a href="#cb60-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-674"><a href="#cb60-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-675"><a href="#cb60-675" aria-hidden="true" tabindex="-1"></a>Note that only the proportion mediated (PM) and adjusted proportion mediated(APM) is presented as darkgreen triangle points on the mediation plot. This is because we specified that we only want to show them using <span class="in">`which_show = c("PM", "APM")`</span> in the <span class="in">`mediation_triplot()`</span> function.</span>
<span id="cb60-676"><a href="#cb60-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-677"><a href="#cb60-677" aria-hidden="true" tabindex="-1"></a>The plot is a bit messy, all the points are crowded together. You could specify <span class="in">`which_show = c("PM")`</span> and <span class="in">`which_show = c(APM")`</span> respectively and re-run the <span class="in">`mediation_triplot()`</span> function to see proportion mediated and adjusted proportion mediated separately. We first show the result of specifying <span class="in">`which_show = c("PM")`</span> here.</span>
<span id="cb60-678"><a href="#cb60-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-679"><a href="#cb60-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_8A}</span></span>
<span id="cb60-680"><a href="#cb60-680" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-681"><a href="#cb60-681" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-682"><a href="#cb60-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-683"><a href="#cb60-683" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-684"><a href="#cb60-684" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-685"><a href="#cb60-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-686"><a href="#cb60-686" aria-hidden="true" tabindex="-1"></a>Triplot_object4 <span class="ot">&lt;-</span></span>
<span id="cb60-687"><a href="#cb60-687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mediation_triplot</span>(</span>
<span id="cb60-688"><a href="#cb60-688" aria-hidden="true" tabindex="-1"></a>    TPObject4,</span>
<span id="cb60-689"><a href="#cb60-689" aria-hidden="true" tabindex="-1"></a>    <span class="at">which_show =</span> <span class="fu">c</span>(<span class="st">"PM"</span>)</span>
<span id="cb60-690"><a href="#cb60-690" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-691"><a href="#cb60-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-692"><a href="#cb60-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-693"><a href="#cb60-693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_13B}</span></span>
<span id="cb60-694"><a href="#cb60-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-695"><a href="#cb60-695" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-696"><a href="#cb60-696" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-697"><a href="#cb60-697" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-698"><a href="#cb60-698" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-699"><a href="#cb60-699" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-700"><a href="#cb60-700" aria-hidden="true" tabindex="-1"></a>Triplot_object4<span class="sc">$</span>mediation_plot</span>
<span id="cb60-701"><a href="#cb60-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-702"><a href="#cb60-702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-703"><a href="#cb60-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-704"><a href="#cb60-704" aria-hidden="true" tabindex="-1"></a>We could see four data points on the figure, which represents the eight combinations of exposures, mediators and outcomes.</span>
<span id="cb60-705"><a href="#cb60-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-706"><a href="#cb60-706" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exposure=BSDS, mediator= module 1, outcome=BMI</span>
<span id="cb60-707"><a href="#cb60-707" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exposure=BSDS, mediator= module 2, outcome=BMI</span>
<span id="cb60-708"><a href="#cb60-708" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exposure=Hamburger, mediator= module 1, outcome=BMI</span>
<span id="cb60-709"><a href="#cb60-709" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exposure=Hamburger, mediator= module 2, outcome=BMI</span>
<span id="cb60-710"><a href="#cb60-710" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exposure=BSDS, mediator= module 1, outcome=T2D</span>
<span id="cb60-711"><a href="#cb60-711" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exposure=BSDS, mediator= module 2, outcome=T2D</span>
<span id="cb60-712"><a href="#cb60-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exposure=Hamburger, mediator= module 1, outcome=T2D</span>
<span id="cb60-713"><a href="#cb60-713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>exposure=Hamburger, mediator= module 2, outcome=T2D</span>
<span id="cb60-714"><a href="#cb60-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-715"><a href="#cb60-715" aria-hidden="true" tabindex="-1"></a>We could view from the confidence intervals on the figure already that some PM is not significant. A huge confidence interval presented on the plot has pushed the triangle points to the origin. We want to zoom in and see which dimensions the points are in.</span>
<span id="cb60-716"><a href="#cb60-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-717"><a href="#cb60-717" aria-hidden="true" tabindex="-1"></a>We therefore adjust the limit of the proportion mediated to zoom in on the points. <span class="in">`"medLim = 2.5"`</span> means that the limit showing on the plot will be from -2.5 to 2.5.</span>
<span id="cb60-718"><a href="#cb60-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-719"><a href="#cb60-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_8B}</span></span>
<span id="cb60-720"><a href="#cb60-720" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-721"><a href="#cb60-721" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-722"><a href="#cb60-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-723"><a href="#cb60-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-724"><a href="#cb60-724" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-725"><a href="#cb60-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-726"><a href="#cb60-726" aria-hidden="true" tabindex="-1"></a>Triplot_object4 <span class="ot">&lt;-</span></span>
<span id="cb60-727"><a href="#cb60-727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mediation_triplot</span>(</span>
<span id="cb60-728"><a href="#cb60-728" aria-hidden="true" tabindex="-1"></a>    TPObject4,</span>
<span id="cb60-729"><a href="#cb60-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">which_show =</span> <span class="fu">c</span>(<span class="st">"PM"</span>),</span>
<span id="cb60-730"><a href="#cb60-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">medLim =</span> <span class="fl">2.5</span></span>
<span id="cb60-731"><a href="#cb60-731" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-732"><a href="#cb60-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-733"><a href="#cb60-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-734"><a href="#cb60-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-735"><a href="#cb60-735" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_13D}</span></span>
<span id="cb60-736"><a href="#cb60-736" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-737"><a href="#cb60-737" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-738"><a href="#cb60-738" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-739"><a href="#cb60-739" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-740"><a href="#cb60-740" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-741"><a href="#cb60-741" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-742"><a href="#cb60-742" aria-hidden="true" tabindex="-1"></a>Triplot_object4<span class="sc">$</span>mediation_plot</span>
<span id="cb60-743"><a href="#cb60-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-744"><a href="#cb60-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-745"><a href="#cb60-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-746"><a href="#cb60-746" aria-hidden="true" tabindex="-1"></a>In the figure, we could see the direction and magnitude of proportion mediated for the 2 mediators, all the exposures and outcomes. We also notice that the PM for BSDS-module 1-BMI and BSDS-module 2-BMI mediation is significant.</span>
<span id="cb60-747"><a href="#cb60-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-748"><a href="#cb60-748" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-749"><a href="#cb60-749" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that some confidence intervals are automatically removed from the figure if they are not within the limit.</span>
<span id="cb60-750"><a href="#cb60-750" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that for some mediations, direct effect and indirect effects are in the opposite direction, implying possibly proportion mediated(PM)<span class="sc">\&gt;</span>1, since total effect could be smaller than indirect effect.</span>
<span id="cb60-751"><a href="#cb60-751" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-752"><a href="#cb60-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-753"><a href="#cb60-753" aria-hidden="true" tabindex="-1"></a>we then further look at the adjusted proportion mediated (APM):</span>
<span id="cb60-754"><a href="#cb60-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-755"><a href="#cb60-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_8C}</span></span>
<span id="cb60-756"><a href="#cb60-756" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-757"><a href="#cb60-757" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-758"><a href="#cb60-758" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-759"><a href="#cb60-759" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-760"><a href="#cb60-760" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-761"><a href="#cb60-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-762"><a href="#cb60-762" aria-hidden="true" tabindex="-1"></a>Triplot_object4 <span class="ot">&lt;-</span></span>
<span id="cb60-763"><a href="#cb60-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mediation_triplot</span>(</span>
<span id="cb60-764"><a href="#cb60-764" aria-hidden="true" tabindex="-1"></a>    TPObject4,</span>
<span id="cb60-765"><a href="#cb60-765" aria-hidden="true" tabindex="-1"></a>    <span class="at">which_show =</span> <span class="fu">c</span>(<span class="st">"APM"</span>)</span>
<span id="cb60-766"><a href="#cb60-766" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-767"><a href="#cb60-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-768"><a href="#cb60-768" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-769"><a href="#cb60-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-770"><a href="#cb60-770" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_13F}</span></span>
<span id="cb60-771"><a href="#cb60-771" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-772"><a href="#cb60-772" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-773"><a href="#cb60-773" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-774"><a href="#cb60-774" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-775"><a href="#cb60-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-776"><a href="#cb60-776" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-777"><a href="#cb60-777" aria-hidden="true" tabindex="-1"></a>Triplot_object4<span class="sc">$</span>mediation_plot</span>
<span id="cb60-778"><a href="#cb60-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-779"><a href="#cb60-779" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-780"><a href="#cb60-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-781"><a href="#cb60-781" aria-hidden="true" tabindex="-1"></a>By observing this figure, we could see the direction and magnitude of adjusted proportion mediated for the 2 mediators, all the exposures and outcomes. The position of the points is similar what we have seen for proportion mediated. Note that APM for BSDS as exposure and T2D as outcome is smaller than their PM. This is because the indirect and direct effect for this mediation is of similar size but in opposite direction. This leads to a smaller total effect and in turn larger PM, but APM will not be affected by the directionality of the direct and indirect effect.</span>
<span id="cb60-782"><a href="#cb60-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-783"><a href="#cb60-783" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-784"><a href="#cb60-784" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>No confidence interval is shown for adjusted proportion mediated, as such value can not be directly calculated from the mediation analysis.</span>
<span id="cb60-785"><a href="#cb60-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-786"><a href="#cb60-786" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that even direct effect and indirect effects are in the opposite direction, adjusted proportion mediated is always smaller than 1, since it uses the sum of the absolute value of indirect and direct effect as denominator. $$APM=\frac{IE}{|IE|+|DE|}\cdot\frac{|IE+DE|}{IE+DE}=\frac{IE}{IE+DE}\cdot\frac{|IE+DE|}{|IE|+|DE|}=\frac{IE}{|IE|+|DE|}\cdot\frac{IE+DE}{|IE+DE|}$$</span>
<span id="cb60-787"><a href="#cb60-787" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-788"><a href="#cb60-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-789"><a href="#cb60-789" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-790"><a href="#cb60-790" aria-hidden="true" tabindex="-1"></a>If you want, you could specify <span class="in">`which_show = c("PM", "APM", "IE","TE")`</span> in the <span class="in">`mediation_troplot()`</span> to show all the estimates (IE for indirect effect and TE for total effect). However, it is not recommended, since the plot will get even messier if you put estimates and proportion mediated on the same plot.</span>
<span id="cb60-791"><a href="#cb60-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-792"><a href="#cb60-792" aria-hidden="true" tabindex="-1"></a>If you go to <span class="co">[</span><span class="ot">Tutorial(simple)</span><span class="co">](simple_code.qmd)</span>{target="_blank"}, you can view the plot when showing <span class="in">`"IE"`</span> and <span class="in">`"TE"`</span>.</span>
<span id="cb60-793"><a href="#cb60-793" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-794"><a href="#cb60-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-795"><a href="#cb60-795" aria-hidden="true" tabindex="-1"></a>Plotting the triplot with mediation,</span>
<span id="cb60-796"><a href="#cb60-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-797"><a href="#cb60-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_14}</span></span>
<span id="cb60-798"><a href="#cb60-798" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-799"><a href="#cb60-799" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-800"><a href="#cb60-800" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-801"><a href="#cb60-801" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-802"><a href="#cb60-802" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-803"><a href="#cb60-803" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-804"><a href="#cb60-804" aria-hidden="true" tabindex="-1"></a>Triplot_object4<span class="sc">$</span>final_plot</span>
<span id="cb60-805"><a href="#cb60-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-806"><a href="#cb60-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-807"><a href="#cb60-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-808"><a href="#cb60-808" aria-hidden="true" tabindex="-1"></a>Base on the barplot and the triplot with mediation, we have observed significant proportion mediated for BSDS-module 1/2-BMI mediations. Further exploration on indirect, direct and total effect of the mediation analysis could be explored by playing around the <span class="in">`which_show`</span> argument in the <span class="in">`mediation_troplot()`</span> function. We will not go into details here.</span>
<span id="cb60-809"><a href="#cb60-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-810"><a href="#cb60-810" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 5: Compare correlations, associations and mediations</span></span>
<span id="cb60-811"><a href="#cb60-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-812"><a href="#cb60-812" aria-hidden="true" tabindex="-1"></a>Users can check the heatmaps of correlations, risk estimations and mediation results from the TPObject through the <span class="in">`checkTPO_ggplot()`</span> function in TriplotGUI.</span>
<span id="cb60-813"><a href="#cb60-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-814"><a href="#cb60-814" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_9}</span></span>
<span id="cb60-815"><a href="#cb60-815" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-816"><a href="#cb60-816" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-817"><a href="#cb60-817" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb60-818"><a href="#cb60-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-819"><a href="#cb60-819" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-820"><a href="#cb60-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-821"><a href="#cb60-821" aria-hidden="true" tabindex="-1"></a>checkTPObject4 <span class="ot">&lt;-</span> <span class="fu">checkTPO_ggplot</span>(TPObject4,</span>
<span id="cb60-822"><a href="#cb60-822" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">which_med =</span> <span class="fu">c</span>(<span class="st">"IE"</span>,<span class="st">"TE"</span>,<span class="st">"PM"</span>,<span class="st">"APM"</span>),</span>
<span id="cb60-823"><a href="#cb60-823" aria-hidden="true" tabindex="-1"></a>                                  <span class="do">## What type of mediation estimate or proportion mediated to show on the heatmap</span></span>
<span id="cb60-824"><a href="#cb60-824" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">which_PC =</span> <span class="fu">c</span>(<span class="st">"turquoise"</span>, <span class="st">"blue"</span>),</span>
<span id="cb60-825"><a href="#cb60-825" aria-hidden="true" tabindex="-1"></a>                                  <span class="do">## What mediators (principal component) you want to show</span></span>
<span id="cb60-826"><a href="#cb60-826" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">which_corr =</span> <span class="fu">c</span>(<span class="st">"Hamburger"</span>,<span class="st">"BSDS"</span>),</span>
<span id="cb60-827"><a href="#cb60-827" aria-hidden="true" tabindex="-1"></a>                                  <span class="do">## What exposure variables you want to show</span></span>
<span id="cb60-828"><a href="#cb60-828" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">which_risk =</span> <span class="fu">c</span>(<span class="st">"T2D"</span>,<span class="st">"BMI"</span>)</span>
<span id="cb60-829"><a href="#cb60-829" aria-hidden="true" tabindex="-1"></a>                                  <span class="do">## What outcome variables you want to show</span></span>
<span id="cb60-830"><a href="#cb60-830" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb60-831"><a href="#cb60-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-832"><a href="#cb60-832" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-833"><a href="#cb60-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-834"><a href="#cb60-834" aria-hidden="true" tabindex="-1"></a>Correlation coefficients and p values between modules and exposures:</span>
<span id="cb60-835"><a href="#cb60-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-836"><a href="#cb60-836" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_15A}</span></span>
<span id="cb60-837"><a href="#cb60-837" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-838"><a href="#cb60-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-839"><a href="#cb60-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-840"><a href="#cb60-840" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-841"><a href="#cb60-841" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-842"><a href="#cb60-842" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-843"><a href="#cb60-843" aria-hidden="true" tabindex="-1"></a>checkTPObject4<span class="sc">$</span>corr_coefficients</span>
<span id="cb60-844"><a href="#cb60-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-845"><a href="#cb60-845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-846"><a href="#cb60-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-847"><a href="#cb60-847" aria-hidden="true" tabindex="-1"></a>Risk estimates(beta coefficients) and p values between modules and outcomes:</span>
<span id="cb60-848"><a href="#cb60-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-849"><a href="#cb60-849" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_15B}</span></span>
<span id="cb60-850"><a href="#cb60-850" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-851"><a href="#cb60-851" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-852"><a href="#cb60-852" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-853"><a href="#cb60-853" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-854"><a href="#cb60-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-855"><a href="#cb60-855" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-856"><a href="#cb60-856" aria-hidden="true" tabindex="-1"></a>checkTPObject4<span class="sc">$</span>risk_coefficients</span>
<span id="cb60-857"><a href="#cb60-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-858"><a href="#cb60-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-859"><a href="#cb60-859" aria-hidden="true" tabindex="-1"></a>Mediation estimates and p values for indirect effect(IE) and total effect(TE), proportion mediated(PM) and adjusted proportion mediated(APM): See <span class="co">[</span><span class="ot">Manual</span><span class="co">](workflow.qmd)</span>{target="_blank"} for more details:</span>
<span id="cb60-860"><a href="#cb60-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-861"><a href="#cb60-861" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_15C}</span></span>
<span id="cb60-862"><a href="#cb60-862" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-863"><a href="#cb60-863" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-864"><a href="#cb60-864" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-865"><a href="#cb60-865" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-866"><a href="#cb60-866" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-867"><a href="#cb60-867" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-868"><a href="#cb60-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-869"><a href="#cb60-869" aria-hidden="true" tabindex="-1"></a>checkTPObject4<span class="sc">$</span>med_coefficients</span>
<span id="cb60-870"><a href="#cb60-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-871"><a href="#cb60-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-872"><a href="#cb60-872" aria-hidden="true" tabindex="-1"></a>You could also View the three plots aboved combinedly.</span>
<span id="cb60-873"><a href="#cb60-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-874"><a href="#cb60-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_15D}</span></span>
<span id="cb60-875"><a href="#cb60-875" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb60-876"><a href="#cb60-876" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-877"><a href="#cb60-877" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb60-878"><a href="#cb60-878" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-879"><a href="#cb60-879" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb60-880"><a href="#cb60-880" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb60-881"><a href="#cb60-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-882"><a href="#cb60-882" aria-hidden="true" tabindex="-1"></a>checkTPObject4<span class="sc">$</span>corr_risk_med_coefficients</span>
<span id="cb60-883"><a href="#cb60-883" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb60-884"><a href="#cb60-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-885"><a href="#cb60-885" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb60-886"><a href="#cb60-886" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>One star for p<span class="sc">\&lt;</span>0.05; Two stars for p<span class="sc">\&lt;</span>0.01; Three stars for p<span class="sc">\&lt;</span>0.001.</span>
<span id="cb60-887"><a href="#cb60-887" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that in the plot of <span class="in">`checkTPbject4$med_coefficients`</span>, only the selected exposures, mediators and outcomes that we use to do mediation on will show up. The rows in the heatmaps are mediators and the column represents exposure-outcome pairs. For each exposure_outcome pair, 4 result are shown: *IE* (indirect effect), *TE* (total effect), *PM*(Proportion Mediated) and *APM*(Adjusted Proportion Mediated). Please see [manual](https://yingxiaoyan.gitlab.io/triplotgui_tutorial/workflow.html#5.2){target="_blank"} section for more information. The "CF" before the names of exposures-outcome pairs means that this mediation is using the Counterfactual method.</span>
<span id="cb60-888"><a href="#cb60-888" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb60-889"><a href="#cb60-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-890"><a href="#cb60-890" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 6: Download data</span></span>
<span id="cb60-891"><a href="#cb60-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-892"><a href="#cb60-892" aria-hidden="true" tabindex="-1"></a>We can save all your output, including data, results and visualization output through the <span class="in">`save()`</span> function as an rda file.</span>
<span id="cb60-893"><a href="#cb60-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-894"><a href="#cb60-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_noruncode_noshowoutput_1}</span></span>
<span id="cb60-895"><a href="#cb60-895" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb60-896"><a href="#cb60-896" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb60-897"><a href="#cb60-897" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb60-898"><a href="#cb60-898" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb60-899"><a href="#cb60-899" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb60-900"><a href="#cb60-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-901"><a href="#cb60-901" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(exposure2,Omics2,outcome2,covariates2,auxilariy2,</span>
<span id="cb60-902"><a href="#cb60-902" aria-hidden="true" tabindex="-1"></a>     reduced_Omics2,Correlations_object,Risks_objects,</span>
<span id="cb60-903"><a href="#cb60-903" aria-hidden="true" tabindex="-1"></a>     mediation_object3,mediation_plot_object3,</span>
<span id="cb60-904"><a href="#cb60-904" aria-hidden="true" tabindex="-1"></a>     TPObject1,TPObject2,TPObject3,TPObject4,</span>
<span id="cb60-905"><a href="#cb60-905" aria-hidden="true" tabindex="-1"></a>     checkTPObject4,</span>
<span id="cb60-906"><a href="#cb60-906" aria-hidden="true" tabindex="-1"></a>     <span class="st">"Tutorial_complex_output.rda"</span>)</span>
<span id="cb60-907"><a href="#cb60-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left"><span class="faux-block">© 2024 Yingxiao Yan <br> CC BY-SA 4.0</span></div>   
    <div class="nav-footer-center"><span class="faux-block"> <a href="https://yingxiao.shinyapps.io/triplotgui/" target="_blank">TriplotGUI</a> <br><a href="https://gitlab.com/YingxiaoYan/TriplotGUI" target="_blank">TriplotGUI Gitlab</a> </span></div>
    <div class="nav-footer-right"><span class="faux-block cyan"> <a href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/" target="_blank">Main page of this tutorial</a> <br><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial" target="_blank">View source of this site on GitLab</a> </span></div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","loop":true,"descPosition":"bottom","closeEffect":"zoom"});</script>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>