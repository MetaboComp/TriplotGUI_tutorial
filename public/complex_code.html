<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Epidemiologist | PhD researcher | Machine learning, computational metabolomics">
<title>TriplotGUI  - Tutorial(complex) - Code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/TriplotGUI_logo_white.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
      }
</style>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><link rel="stylesheet" href="styles.scss">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/TriplotGUI_logo_black.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">TriplotGUI <i class="fa-brands fa-gitlab" aria-label="gitlab"></i></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./introduction.html" rel="" target="">
 <span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./installation.html" rel="" target="">
 <span class="menu-text">Setup</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workflow.html" rel="" target="">
 <span class="menu-text">Details</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorial(simple" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tutorial(simple)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorial(simple">
<li>
    <a class="dropdown-item" href="./simple.html" rel="" target="">
 <span class="dropdown-text">User Interface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simple_code.html" rel="" target="">
 <span class="dropdown-text">Code</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorial(complex" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Tutorial(complex)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorial(complex">
<li>
    <a class="dropdown-item" href="./complex.html" rel="" target="">
 <span class="dropdown-text">User Interface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./complex_code.html" rel="" target="">
 <span class="dropdown-text">Code</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./use_case.html" rel="" target="">
 <span class="menu-text">Use Case</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./papers.html" rel="" target="">
 <span class="menu-text">Papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About us</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/" rel="" target=""><i class="bi bi-folder-symlink" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://gitlab.com/YingxiaoYan/TriplotGUI" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/yingxiao-yan" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:yingxiao.yan.007@gmail.com" rel="" target=""><i class="bi bi-envelope" role="img" aria-label="email">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <div class="quarto-title-block"><div><h1 class="title">Tutorial(complex) - Code</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Complex demo of using code in TriplotGUI</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Tutorial</h2>
   
  <ul>
<li><a href="#data-description" id="toc-data-description" class="nav-link active" data-scroll-target="#data-description"><span class="header-section-number">1</span> Data description</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question"><span class="header-section-number">2</span> Research question</a></li>
  <li>
<a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration"><span class="header-section-number">3</span> Data exploration</a>
  <ul>
<li><a href="#check-healthynordicdiet_2" id="toc-check-healthynordicdiet_2" class="nav-link" data-scroll-target="#check-healthynordicdiet_2"><span class="header-section-number">3.1</span> Check HealthyNordicDiet_2</a></li>
  <li><a href="#check-datasets" id="toc-check-datasets" class="nav-link" data-scroll-target="#check-datasets"><span class="header-section-number">3.2</span> Check datasets</a></li>
  <li><a href="#check-variables-class" id="toc-check-variables-class" class="nav-link" data-scroll-target="#check-variables-class"><span class="header-section-number">3.3</span> Check variables’ class</a></li>
  <li><a href="#check-sanities-for-variables" id="toc-check-sanities-for-variables" class="nav-link" data-scroll-target="#check-sanities-for-variables"><span class="header-section-number">3.4</span> Check sanities for variables</a></li>
  <li><a href="#build-data-for-analysis" id="toc-build-data-for-analysis" class="nav-link" data-scroll-target="#build-data-for-analysis"><span class="header-section-number">3.5</span> Build data for analysis</a></li>
  </ul>
</li>
  <li>
<a href="#code-example-of-using-triplotgui" id="toc-code-example-of-using-triplotgui" class="nav-link" data-scroll-target="#code-example-of-using-triplotgui"><span class="header-section-number">4</span> Code example of using TriplotGUI</a>
  <ul>
<li><a href="#simple_link" id="toc-simple_link" class="nav-link" data-scroll-target="#simple_link"><span class="header-section-number">4.1</span> Step 1: Data reduction of omics data</a></li>
  <li><a href="#step-2-exposures-correlations-outcomes-associations" id="toc-step-2-exposures-correlations-outcomes-associations" class="nav-link" data-scroll-target="#step-2-exposures-correlations-outcomes-associations"><span class="header-section-number">4.2</span> Step 2: Exposures’ correlations &amp; Outcomes’ associations</a></li>
  <li><a href="#step-3-visualization-of-triplot" id="toc-step-3-visualization-of-triplot" class="nav-link" data-scroll-target="#step-3-visualization-of-triplot"><span class="header-section-number">4.3</span> Step 3: Visualization of Triplot</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content"><p>Before starting,please make sure you have installed the TriplotGUI package following <a href="./installation.html" target="_blank">Setup</a>.</p>
<p>The code of at this page can be downloaded <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/HealthyNordicDiet_2_applying_TriplotGUI_code.R" target="_blank">here</a></p>
<section id="data-description" class="level1" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> Data description</h1>
<p>The data used in this page of tutorial can be downloaded <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda" target="_blank">here</a> in rda format.</p>
<p>The Data used for this example of code is <strong><em>HealthyNordicDiet_2</em></strong>. This is a synthetic dataset that was simulated from the authentic data used in a case/control study nested within the Swedish prospective Västerbotten Intervention Programme cohort. The original study was set up to explore plasma metabolites that could objectively reflect healthy Nordic dietary patterns in a matched case-control study and to assess associations between such patterns and later development of type 2 diabetes. (Shi et al.&nbsp;2018). The simulated data <strong><em>HealthyNordicDiet_2</em></strong> is a list that contains three data frames:</p>
<ul>
<li>Clinical measurements (ClinData, 11 variables): <code>"ID"</code>,<code>"T2D"</code>(Cases and controls for type 2 diabetes), <code>"PairedInfo"</code>(Pairing information for case and controls),<code>"Energy"</code>,<code>"Gender"</code>,<code>"Age"</code>,<code>"BMI"</code>,<code>"Smoking"</code>,<code>"PhysicalActivityIndex"</code>,<code>"Education"</code>,<code>"FastingGlucose"</code>.<br>
</li>
<li>Plasma metabolites predictive of BMI (MetaboliteData, 20 variables)</li>
<li>Dietary intake as measured by food frequency questionnaires (FoodData, 11 variables): <code>"HFI"</code>( Healthy Food Index),<code>"BSDS"</code>(the Baltic Sea Diet Score),<code>"Wholegrains"</code>,<code>"Sausage"</code>,<code>"Pizza"</code>,<code>"Refined.bread"</code>, <code>"Fruits"</code>,<code>"Liquor"</code>,<code>"Wine"</code>,<code>"Hamburger"</code>,<code>"Poultry"</code>,<code>"Fish"</code>,<code>"Margarine"</code>,<code>"Cabbage"</code>,<code>"Carrot"</code>,<code>"low_fat_Dairy"</code>,<code>"Vegetables"</code>
</li>
</ul>
<p>The data frames are row-wise matched by observation and consist of 1000 synthetic observations.</p>
<p><strong>Reference</strong></p>
<p>Shi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., &amp; Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. The American Journal of Clinical Nutrition, 108(3), 564-575. <a href="https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub" target="_blank">10.1093/ajcn/nqy145</a></p>
<p>Schillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. Metabolites. 2019 Jul 6;9(7):133. <a href="https://www.mdpi.com/2218-1989/9/7/133" target="_blank">doi: 10.3390/metabo9070133</a></p>
</section><section id="research-question" class="level1" data-number="2"><h1 data-number="2">
<span class="header-section-number">2</span> Research question</h1>
<p>We want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI.</p>
</section><section id="data-exploration" class="level1" data-number="3"><h1 data-number="3">
<span class="header-section-number">3</span> Data exploration</h1>
<p><strong><em>HealthyNordicDiet_2</em></strong> is loaded in the R environment up on running <code><a href="https://rdrr.io/r/base/library.html">library(TriplotGUI)</a></code>. We will do some data exploration first to see how the data looks like.</p>
<div class="cell styled-output">

</div>
<section id="check-healthynordicdiet_2" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="check-healthynordicdiet_2">
<span class="header-section-number">3.1</span> Check HealthyNordicDiet_2</h2>
<p>Check <strong><em>HealthyNordicDiet_2</em></strong> as a list:</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "ClinData"       "MetaboliteData" "FoodData"      </code></pre>
</div>
</div>
</section><section id="check-datasets" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="check-datasets">
<span class="header-section-number">3.2</span> Check datasets</h2>
<p>Check the names of variables in each data:</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">ClinData</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "ID"                    "T2D"                   "PairedInfo"           
 [4] "Energy"                "Gender"                "Age"                  
 [7] "BMI"                   "Smoking"               "PhysicalActivityIndex"
[10] "Education"             "FastingGlucose"       </code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">MetaboliteData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "Pipecolic.acid.betaine"         "lysoPC.18.0."                  
 [3] "HP143.1179.1.55"                "lysoPE.22.6."                  
 [5] "HN151.0065.4.97"                "RP225.1482.9.15"               
 [7] "X3.4.5.Trimethoxycinnamic.acid" "DHA"                           
 [9] "RP383.1671.10.53"               "gama.tocopherol"               
[11] "RP431.3516.11.96"               "RP490.3516.8.99"               
[13] "lysoPC.22.6."                   "Steroid.glucuronide"           
[15] "RP684.5545.13.41"               "RP197.0926.3.17"               
[17] "RP303.6468.9.98"                "RP816.5684.12.52"              
[19] "RP827.5356.11.88"               "RP826.5442.12.17"              
[21] "RN201.1498.8.23"                "RN203.0022.3.00"               
[23] "EPA"                            "PC.18.2.15.0."                 
[25] "RN814.5610.12.14"               "RN153.0190.3.5"                
[27] "RN427.1641.10.59"               "RN457.1742.10.50"              
[29] "RN830.5845.12.46"               "RN446.1541.10.59"              
[31] "RN472.1596.10.53"              </code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">FoodData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "HFI"           "BSDS"          "Wholegrains"   "Sausage"      
 [5] "Pizza"         "Refined.bread" "Fruits"        "Liquor"       
 [9] "Wine"          "Hamburger"     "Poultry"       "Fish"         
[13] "Margarine"     "Cabbage"       "Carrot"        "low_fat_Dairy"
[17] "Vegetables"   </code></pre>
</div>
</div>
</section><section id="check-variables-class" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="check-variables-class">
<span class="header-section-number">3.3</span> Check variables’ class</h2>
<p>We Transform the data to dataframe format and then use TriplotGUI’s <code>checkdata()</code> function in to examine the class of variables.</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ClinData</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">ClinData</span><span class="op">)</span></span>
<span><span class="va">MetaboliteData</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">MetaboliteData</span><span class="op">)</span></span>
<span><span class="va">FoodData</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">FoodData</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ClinData_check</span><span class="op">&lt;-</span><span class="fu">checkdata</span><span class="op">(</span><span class="va">ClinData</span><span class="op">)</span></span>
<span><span class="va">MetaboliteData_check</span><span class="op">&lt;-</span><span class="fu">checkdata</span><span class="op">(</span><span class="va">MetaboliteData</span><span class="op">)</span></span>
<span><span class="va">FoodData_check</span><span class="op">&lt;-</span><span class="fu">checkdata</span><span class="op">(</span><span class="va">FoodData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ClinData_check</span><span class="op">$</span><span class="va">class_sumamry_statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$check_class_vector
                   ID                   T2D            PairedInfo 
            "numeric"              "factor"              "factor" 
               Energy                Gender                   Age 
            "numeric"              "factor"             "numeric" 
                  BMI               Smoking PhysicalActivityIndex 
            "numeric"              "factor"              "factor" 
            Education        FastingGlucose 
             "factor"             "numeric" 

$check_class_table
check_class_vector
 factor numeric 
      6       5 </code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MetaboliteData_check</span><span class="op">$</span><span class="va">class_sumamry_statistics</span><span class="op">$</span><span class="va">check_class_table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>check_class_vector
numeric 
     31 </code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FoodData_check</span><span class="op">$</span><span class="va">class_sumamry_statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$check_class_vector
          HFI          BSDS   Wholegrains       Sausage         Pizza 
     "factor"     "numeric"     "numeric"     "numeric"     "numeric" 
Refined.bread        Fruits        Liquor          Wine     Hamburger 
    "numeric"     "numeric"     "numeric"     "numeric"     "numeric" 
      Poultry          Fish     Margarine       Cabbage        Carrot 
    "numeric"     "numeric"     "numeric"     "numeric"     "numeric" 
low_fat_Dairy    Vegetables 
    "numeric"     "numeric" 

$check_class_table
check_class_vector
 factor numeric 
      1      16 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that <code>"HFI"</code>(Healthy Food Index) is used as a factor variable and <code>"BSDS"</code>(the Baltic Sea Diet Score) is used as a numeric variable. You could use <code>table(FoodData$HFI)</code> and <code>table(FoodData$BSDS)</code> to check the difference.</p>
</div>
</div>
</section><section id="check-sanities-for-variables" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="check-sanities-for-variables">
<span class="header-section-number">3.4</span> Check sanities for variables</h2>
<p>Whether each variable contains missing (NA) or abnormal values (e.g.&nbsp;NAN, Inf, blank value) can also be checked</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ClinData_check</span><span class="op">$</span><span class="va">everycolumn</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["ID"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["T2D"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["PairedInfo"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Energy"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Gender"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Age"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["BMI"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Smoking"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["PhysicalActivityIndex"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Education"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["FastingGlucose"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"NA_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"NA_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"NaN_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"NaN_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"negative_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"negative_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"zero_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"zero_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"inf_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"inf_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"blank_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","_rn_":"blank_percentage"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MetaboliteData_check</span><span class="op">$</span><span class="va">everycolumn</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Pipecolic.acid.betaine"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["lysoPC.18.0."],"name":[2],"type":["dbl"],"align":["right"]},{"label":["HP143.1179.1.55"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["lysoPE.22.6."],"name":[4],"type":["dbl"],"align":["right"]},{"label":["HN151.0065.4.97"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["RP225.1482.9.15"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["X3.4.5.Trimethoxycinnamic.acid"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["DHA"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["RP383.1671.10.53"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["gama.tocopherol"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["RP431.3516.11.96"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["RP490.3516.8.99"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["lysoPC.22.6."],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Steroid.glucuronide"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["RP684.5545.13.41"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["RP197.0926.3.17"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["RP303.6468.9.98"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["RP816.5684.12.52"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["RP827.5356.11.88"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["RP826.5442.12.17"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["RN201.1498.8.23"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["RN203.0022.3.00"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["EPA"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["PC.18.2.15.0."],"name":[24],"type":["dbl"],"align":["right"]},{"label":["RN814.5610.12.14"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["RN153.0190.3.5"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["RN427.1641.10.59"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["RN457.1742.10.50"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["RN830.5845.12.46"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["RN446.1541.10.59"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["RN472.1596.10.53"],"name":[31],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"NA_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"NA_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"NaN_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"NaN_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"negative_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"negative_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"zero_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"zero_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"inf_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"inf_percentage"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"blank_number"},{"1":"0","2":"0","3":"0","4":"0","5":"0","6":"0","7":"0","8":"0","9":"0","10":"0","11":"0","12":"0","13":"0","14":"0","15":"0","16":"0","17":"0","18":"0","19":"0","20":"0","21":"0","22":"0","23":"0","24":"0","25":"0","26":"0","27":"0","28":"0","29":"0","30":"0","31":"0","_rn_":"blank_percentage"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FoodData_check</span><span class="op">$</span><span class="va">everycolumn</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["HFI"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["BSDS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Wholegrains"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sausage"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pizza"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Refined.bread"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Fruits"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Liquor"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Wine"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Hamburger"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Poultry"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Fish"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Margarine"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Cabbage"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["Carrot"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["low_fat_Dairy"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["Vegetables"],"name":[17],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"NA_number"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"NA_percentage"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"NaN_number"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"NaN_percentage"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"negative_number"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"negative_percentage"},{"1":"0","2":"0","3":"63.000","4":"139.000","5":"195.000","6":"155.000","7":"180.00","8":"367.000","9":"288.000","10":"231.000","11":"117.000","12":"79.000","13":"41.000","14":"253.000","15":"225.000","16":"237.000","17":"192.000","_rn_":"zero_number"},{"1":"0","2":"0","3":"0.063","4":"0.139","5":"0.195","6":"0.155","7":"0.18","8":"0.367","9":"0.288","10":"0.231","11":"0.117","12":"0.079","13":"0.041","14":"0.253","15":"0.225","16":"0.237","17":"0.192","_rn_":"zero_percentage"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"inf_number"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"inf_percentage"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"blank_number"},{"1":"0","2":"0","3":"0.000","4":"0.000","5":"0.000","6":"0.000","7":"0.00","8":"0.000","9":"0.000","10":"0.000","11":"0.000","12":"0.000","13":"0.000","14":"0.000","15":"0.000","16":"0.000","17":"0.000","_rn_":"blank_percentage"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You shall only continue when the class of variables are correct and the missing or abnormal values in the variable are properly handled.</p>
</div>
</div>
</section><section id="build-data-for-analysis" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="build-data-for-analysis">
<span class="header-section-number">3.5</span> Build data for analysis</h2>
<p>We see food data as our exposures and BMI and type 2 diabetes as outcomes. Note that BMI is a continuous variable. We can additionally construct BMI as a categorical outcome using the criteria below and see how this may differ the result. - BMI&lt;= 18.5: Underweight - 18.5&lt;BMI&lt;= 25: Normal - 25&lt; BMI&lt;= 30: Overweight - 30&lt; BMI: Obese</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BMI</span><span class="op">&lt;-</span><span class="va">ClinData</span><span class="op">[</span>,<span class="st">"BMI"</span><span class="op">]</span></span>
<span><span class="va">BMI_cat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span>length<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BMI</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">BMI</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">18.5</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">BMI_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"underweight"</span></span>
<span>  <span class="op">}</span><span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">18.5</span><span class="op">&amp;</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">25</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">BMI_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"normal"</span></span>
<span>  <span class="op">}</span><span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">25</span><span class="op">&amp;</span><span class="va">BMI</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">30</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">BMI_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"overweight"</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">BMI_cat</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="st">"obese"</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">BMI_cat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">BMI_cat</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We want to explore the exposure-outcome relationships through the metabolomics data, using metabolites as assumed mediators. Gender, age, education, physical activity and smoking are used as potential confounders for exposure-mediator and mediator-outcome association. Auxiliary information regarding case-control pairs, fasting glucose level, education and physical activity are also provided.</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exposure2</span><span class="op">&lt;-</span><span class="va">FoodData</span></span>
<span><span class="va">Omics2</span><span class="op">&lt;-</span><span class="va">MetaboliteData</span></span>
<span><span class="va">outcome2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span><span class="va">ClinData</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T2D"</span>,<span class="st">"BMI"</span><span class="op">)</span><span class="op">]</span>,<span class="va">BMI_cat</span><span class="op">)</span></span>
<span><span class="va">covariates2</span><span class="op">&lt;-</span><span class="va">ClinData</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span> ,<span class="st">"Age"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>,<span class="st">"Smoking"</span> <span class="op">)</span><span class="op">]</span></span>
<span><span class="va">auxilary2</span><span class="op">&lt;-</span><span class="va">ClinData</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PairedInfo"</span>,<span class="st">"FastingGlucose"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>, <span class="st">"Energy"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="code-example-of-using-triplotgui" class="level1" data-number="4"><h1 data-number="4">
<span class="header-section-number">4</span> Code example of using TriplotGUI</h1>
<p>We will use a complex settings in this example. Please go to <a href="./simple_code.html" target="_blank">Tutorial(simple)</a>.if you want to try simple settings.</p>
<section id="simple_link" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="simple_link">
<span class="header-section-number">4.1</span> Step 1: Data reduction of omics data</h2>
<p>Using <code>TriplotGUI</code> package, first we perform dimension reduction, using weighted correlation network analysis (WGCNA) on metabolomics data.</p>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#* USing the most simple settings</span></span>
<span><span class="va">reduced_Omics2</span><span class="op">&lt;-</span><span class="fu">PCAorWGCNA_plots</span><span class="op">(</span>dataframe<span class="op">=</span><span class="va">Omics2</span>,</span>
<span></span>
<span>                                 plottype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scree"</span>,<span class="st">"score"</span>,<span class="st">"loading"</span>,<span class="st">"scoreloading"</span><span class="op">)</span>,</span>
<span>                                 pc_type<span class="op">=</span><span class="st">"principal"</span>, </span>
<span>                                 <span class="co"># Use principal() instead of prcomp() to perform PCA</span></span>
<span>                                 first_PC<span class="op">=</span><span class="fl">1</span>,</span>
<span>                                 second_PC<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                 option<span class="op">=</span><span class="st">"WGCNA"</span>,</span>
<span>                                 scale<span class="op">=</span><span class="cn">T</span>,</span>
<span>                                 center<span class="op">=</span><span class="cn">T</span>,</span>
<span>                                 eigen_loading<span class="op">=</span><span class="st">"loading"</span>,</span>
<span>                                 rotate<span class="op">=</span><span class="st">"none"</span>,</span>
<span>                                 size_variable<span class="op">=</span><span class="va">auxilary2</span><span class="op">$</span><span class="va">FastingGlucose</span>,</span>
<span>                                 size_variable_name<span class="op">=</span><span class="st">"FastigGlucose"</span>,</span>
<span>                                 color_variable<span class="op">=</span><span class="va">auxilary2</span><span class="op">$</span><span class="va">Education</span>,</span>
<span>                                 color_variable_name<span class="op">=</span><span class="st">"Education"</span>,</span>
<span>                                 shape_variable<span class="op">=</span><span class="va">auxilary2</span><span class="op">$</span><span class="va">PhysicalActivityIndex</span>,</span>
<span>                                 shape_variable_name<span class="op">=</span><span class="st">"PhysicalActivityIndex"</span>,</span>
<span>                                 scale_scoreloading<span class="op">=</span><span class="cn">T</span>,</span>
<span>                                 loadings_name<span class="op">=</span><span class="cn">T</span>,</span>
<span>                                 loadings_cutvalue<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>                                 loadings_cutpercent<span class="op">=</span><span class="fl">0.2</span>,</span>
<span>                                 minModuleSize<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You could try out the arguments of the <code>PCAorWGCNA_plots()</code> function and view the whole function <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCAorWGCNA_plots.R?ref_type=heads" target="_blank">here</a></p>
</div>
</div>
<p>You can see scree plot, score plot, loadings plot and biplot at this stage.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">scree_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<p><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6-1.png" class="img-fluid" width="672"></p>
</div>
</details><details open=""><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">score_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<p><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6-2.png" class="img-fluid" width="672"></p>
</div>
</details><details open=""><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">loading_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<p><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6-3.png" class="img-fluid" width="672"></p>
</div>
</details><details open=""><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">scoreloading_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<p><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6-4.png" class="img-fluid" width="672"></p>
</div>
</details>
</div>
<p>We then build a TPObject, which is used for saving information and pass them through steps in TriplotGUI.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scores</span><span class="op">=</span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">scores</span></span>
<span><span class="va">loadings</span><span class="op">&lt;-</span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">loadings</span></span>
<span><span class="va">variance</span><span class="op">&lt;-</span> <span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">variance</span></span>
<span><span class="va">TPObject1</span><span class="op">&lt;-</span><span class="fu">makeTPO</span><span class="op">(</span>scores<span class="op">=</span><span class="va">scores</span>,</span>
<span>                   loadings<span class="op">=</span><span class="va">loadings</span>,</span>
<span>                   variance<span class="op">=</span><span class="va">variance</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Making TriPlotObject (TPO)
--------------------------

Score matrix has 1000 observations and 6 components.

TPO has 0 attached correlations.
TPO has 0 attached risks.</code></pre>
</div>
</div>
</section><section id="step-2-exposures-correlations-outcomes-associations" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="step-2-exposures-correlations-outcomes-associations">
<span class="header-section-number">4.2</span> Step 2: Exposures’ correlations &amp; Outcomes’ associations</h2>
<p>The correlations between principal component (PC) scores and food items were calculated using Pearson correlations, adjusting for confounders. The associations between PC scores and risk markers were investigated using linear regression.</p>
<p>Correlation matrix of correlation coefficients and p values between the TPO scores saved in the TPObject and the dietary variables in the data is generated, using a pair-wise Pearson correlations, adjusting for confounders.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Correlations_object</span><span class="op">&lt;-</span><span class="fu">makeCorr</span><span class="op">(</span>TPObject<span class="op">=</span><span class="va">TPObject1</span>,</span>
<span>                              corrData<span class="op">=</span><span class="va">exposure2</span>,</span>
<span>                              use<span class="op">=</span><span class="st">'pairwise'</span>,</span>
<span>                              method<span class="op">=</span><span class="st">'pearson'</span>,</span>
<span>                              allowcategorical<span class="op">=</span><span class="cn">F</span>,</span>
<span>                              partial<span class="op">=</span><span class="cn">T</span>,</span>
<span>                              confounder<span class="op">=</span><span class="va">covariates2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><code>allowcategorical=F</code> performs one-hot-encoding to transform categorical exposures variables with n&gt;2 classes to n binary variables. You can use <code>Correlations_object$cor_estimate</code> to check that each HFI level is separated in to a binary variable and the correlation coefficients between PCs and the binary variables were calculated. If <code>allowcategorical=T</code> is specified, then the <code>HFI</code> variable is forced as numeric variables. This is not recommended unless you are sure that the level itself reflect the numeric value.</p></li>
<li><p><code>partial=T</code> specifies that the confounders will be adjusted.</p></li>
</ul>
</div>
</div>
<p>The result of correlations are then added into the TPObject.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPObject2</span><span class="op">&lt;-</span><span class="fu">addCorr</span><span class="op">(</span>TPObject<span class="op">=</span><span class="va">TPObject1</span>,</span>
<span>                   Corr<span class="op">=</span><span class="va">Correlations_object</span><span class="op">$</span><span class="va">cor_estimate</span>,</span>
<span>                   Corr_p<span class="op">=</span><span class="va">Correlations_object</span><span class="op">$</span><span class="va">cor_pvalue</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Adding correlation to TPO
-------------------------
Please ensure same number of components in TPO and correlation matrix

TPO has 23 attached correlations.
TPO has 0 attached risks.</code></pre>
</div>
</div>
<p>Matrices of risk estimates and p values between the TPO scores saved in the TPObject and the outcome variables are generated, adjusting for confounders.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Risks_object</span><span class="op">&lt;-</span><span class="fu">coefficient_get</span><span class="op">(</span>TPObject<span class="op">=</span><span class="va">TPObject2</span>,</span>
<span>                              outcome<span class="op">=</span><span class="va">outcome2</span>,</span>
<span>                              confounder<span class="op">=</span><span class="va">covariates2</span>,</span>
<span>                              partial<span class="op">=</span><span class="cn">T</span>,</span>
<span>                              multinomial<span class="op">=</span><span class="cn">T</span>,</span>
<span>                              pair<span class="op">=</span><span class="va">auxilary2</span><span class="op">$</span><span class="va">PairedInfo</span>,</span>
<span>                              CI<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<code>partial=T</code> specifies that the confounders will be adjusted.</li>
<li>When <code>pair</code> information is not provided:
<ul>
<li>
<code>multinomial=F</code> means that one-hot-encoding will be performed to transform categorical variables with n &gt; 2 classes to n binary variables. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</li>
<li>If specifying <code>multinomial=T</code>, multinomial regression will be performed on the categorical outcome variable with n &gt; 2 classes, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</li>
</ul>
</li>
<li>When <code>pair</code> information for case - control pair is provided:
<ul>
<li>
<code>multinomial=F</code> means that one-hot-encoding will be performed on categorical variables with n &gt; 2 classes. And then conditional logistic regression will be performed on the binary variables and linear mixed model will be performed on continuous variables, using the pairing information.</li>
<li>If specifying <code>multinomial=T</code>, the pairing information will not be ignored and used (since the outcomes can have more than 2 classes), multinomial regression will be performed on the categorical outcome variable, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</li>
</ul>
</li>
</ul>
</div>
</div>
<p>The result of risk estimates are then added into the TPObject.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPObject3</span><span class="op">&lt;-</span><span class="fu">addRisk</span><span class="op">(</span>TPObject<span class="op">=</span><span class="va">TPObject2</span>,</span>
<span>                   Risk<span class="op">=</span><span class="va">Risks_object</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Adding risk to TPO
------------------
Please add risks one by one with component in rows and estimates, se:s and (optionally) p-values in columns
Please ensure same number of components in TPO and risk matrix

TPO has 23 attached correlations.
TPO has 5 attached risks.</code></pre>
</div>
</div>
</section><section id="step-3-visualization-of-triplot" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="step-3-visualization-of-triplot">
<span class="header-section-number">4.3</span> Step 3: Visualization of Triplot</h2>
<p>Generate Triplot: Note that Triplot can be generated from any TPObject. You can try out different argument in the <code>TriplotGUI()</code> function. The function is a wrapper of <code>PCA_TriplotGUI()</code> and <code>WGCNA_TriplotGUI()</code>. You can view the functions respectively here: <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/TriplotGUI.R?ref_type=heads" target="_blank"><code>TriplotGUI()</code></a> <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCA_TriplotGUI.R?ref_type=heads" target="_blank"><code>PCA_TriplotGUI()</code></a> <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/WGCNA_TriplotGUI.R?ref_type=heads" target="_blank"><code>WGCNA_TriplotGUI()</code></a></p>
<p>In this example we use WGCNA to perform data reduction, therefore specifying <code>option="WGCNA"</code>.</p>
<div class="cell styled-output" data-fold.output="false">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object3</span><span class="op">&lt;-</span><span class="fu">TriplotGUI</span><span class="op">(</span><span class="va">TPObject3</span>,</span>
<span>                            first_PC<span class="op">=</span><span class="fl">1</span>,   <span class="co">## The first PC to map</span></span>
<span>                            second_PC<span class="op">=</span><span class="fl">2</span>,   <span class="co">## The first PC to map</span></span>
<span>                            plotLoads<span class="op">=</span><span class="cn">TRUE</span>,   <span class="co">##Whether to plot loadings (TRUE; default) or suppress them (FALSE)</span></span>
<span>                            plotScores<span class="op">=</span><span class="cn">FALSE</span>,   <span class="co">##Whether to plot scores (TRUE) or suppress them (FALSE; default)</span></span>
<span>                            plotCorr<span class="op">=</span><span class="cn">TRUE</span>,   <span class="co">##Whether to plot correlations (TRUE; default) or suppress them (FALSE)</span></span>
<span>                            plotRisk<span class="op">=</span><span class="cn">TRUE</span>,      <span class="co">##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span>                            <span class="co">##For loadings</span></span>
<span>                            loadLabels<span class="op">=</span><span class="cn">TRUE</span>,   <span class="co">###Whether to plot variable loading labels (TRUE; default) or not (FALSE)</span></span>
<span>                            loadArrowLength<span class="op">=</span><span class="fl">0.02</span>,   <span class="co">###Length of arrow tip , set it as 0 if you want to remove it</span></span>
<span>                            loadCut<span class="op">=</span><span class="fl">0</span>,    <span class="co">###lower limit Loadings below the cut are plotted in light grey and without label</span></span>
<span>                            loadLim<span class="op">=</span><span class="cn">NULL</span>,   <span class="co">##higher limit,Plot range for loadings</span></span>
<span>                            <span class="co">##For correlations</span></span>
<span>                            colCorr<span class="op">=</span><span class="st">"blue"</span>,   <span class="co">##Color vector for correlations</span></span>
<span>                            pchCorr<span class="op">=</span><span class="fl">16</span>,   <span class="co">##Plotting character for correlations</span></span>
<span>                            whichCorr<span class="op">=</span><span class="cn">NULL</span>,   <span class="co">##Which correlations to plot (vector of numbers)</span></span>
<span>                            corLim<span class="op">=</span><span class="cn">NULL</span>,     <span class="co">##Plot range for correlations</span></span>
<span>                            corrLabels <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                            <span class="co">##For risks</span></span>
<span>                            colRisk<span class="op">=</span><span class="st">"red"</span>,    <span class="co">##Color vector for risk estimates</span></span>
<span>                            pchRisk<span class="op">=</span><span class="fl">15</span>,    <span class="co">##Plotting character for risk estimates</span></span>
<span>                            whichRisk<span class="op">=</span><span class="cn">NULL</span>,  <span class="co">##Which risk estimates to plot (vector of numbers)</span></span>
<span>                            riskLim<span class="op">=</span><span class="cn">NULL</span>,            <span class="co">##Plot range for risks</span></span>
<span>                            riskWhisker_percentage<span class="op">=</span><span class="fl">0.1</span>,  <span class="co">## whisker length is how many percentage of confidence interval (This is only for the visualization purpose)</span></span>
<span>                            riskLabels <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                            size<span class="op">=</span><span class="fl">3</span>,</span>
<span>                            riskOR<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Plotting the triplot</p>
<div class="cell styled-output" data-fold.plot="true">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Triplot_object3</span><span class="op">$</span><span class="va">triplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<p><img src="complex_code_files/figure-html/showcode_runcode_showoutput_10-1.png" class="img-fluid" width="672"></p>
</div>
</details>
</div>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#don't run code, but show code</span></span>
<span><span class="fl">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#run code, and show code, don't show output</span></span>
<span><span class="fl">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<div class="cell styled-output">

</div>
<div class="cell">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#run code, and show code, and show output</span></span>
<span><span class="fl">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">s</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">+</span><span class="fl">1</span><span class="op">}</span></span>
<span><span class="fu">s</span><span class="op">(</span><span class="fl">23</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
</div>
<p>FOR REFERENCE: <svg aria-label="Graduation Cap" role="img" viewbox="0 0 640 512" style="height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#98A08D;overflow:visible;position:relative;"><title>Graduation Cap</title>
<path d="M320 32c-8.1 0-16.1 1.4-23.7 4.1L15.8 137.4C6.3 140.9 0 149.9 0 160s6.3 19.1 15.8 22.6l57.9 20.9C57.3 229.3 48 259.8 48 291.9v28.1c0 28.4-10.8 57.7-22.3 80.8c-6.5 13-13.9 25.8-22.5 37.6C0 442.7-.9 448.3 .9 453.4s6 8.9 11.2 10.2l64 16c4.2 1.1 8.7 .3 12.4-2s6.3-6.1 7.1-10.4c8.6-42.8 4.3-81.2-2.1-108.7C90.3 344.3 86 329.8 80 316.5V291.9c0-30.2 10.2-58.7 27.9-81.5c12.9-15.5 29.6-28 49.2-35.7l157-61.7c8.2-3.2 17.5 .8 20.7 9s-.8 17.5-9 20.7l-157 61.7c-12.4 4.9-23.3 12.4-32.2 21.6l159.6 57.6c7.6 2.7 15.6 4.1 23.7 4.1s16.1-1.4 23.7-4.1L624.2 182.6c9.5-3.4 15.8-12.5 15.8-22.6s-6.3-19.1-15.8-22.6L343.7 36.1C336.1 33.4 328.1 32 320 32zM128 408c0 35.3 86 72 192 72s192-36.7 192-72L496.7 262.6 354.5 314c-11.1 4-22.8 6-34.5 6s-23.5-2-34.5-6L143.3 262.6 128 408z"></path></svg> # stopped working 5/1/2023?</p>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb46" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tutorial(complex) - Code"</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Complex demo of using code in TriplotGUI"</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner-color:</span><span class="co"> white</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-categories:</span><span class="co"> false</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="an">page-layout:</span><span class="co"> full</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">    margin-top: 0em</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">    margin-bottom: 0em</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">    padding-top: 0em</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">    padding-bottom: 0em</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co">    minimal: true</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-responsive: true</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: Tutorial</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true  ## add number in the session or not</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co">    number-depth: 4</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight: tango</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged  ## kable is another option How the dataframe looks like </span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="co">    standalone: false  ### specifies if all assets and libraries must be integrated into the output html file as a standalone document.</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-align: right</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:  solar</span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="an">geometry:</span><span class="co"> margin=lin  </span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="do">##This is a function that combines html and rmarkdown. It aims to generate a button that could hide output or plot (fold.output=T or fold.plot=T).</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>hooks <span class="ot">=</span> knitr<span class="sc">::</span>knit_hooks<span class="sc">$</span><span class="fu">get</span>()</span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>hook_foldable <span class="ot">=</span> <span class="cf">function</span>(type) {</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">force</span>(type)</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x, options) {</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">=</span> hooks[[type]](x, options)</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">isTRUE</span>(options[[<span class="fu">paste0</span>(<span class="st">"fold."</span>, type)]])) <span class="fu">return</span>(res)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&lt;details&gt;&lt;summary&gt;"</span>, type, <span class="st">"&lt;/summary&gt;</span><span class="sc">\n\n</span><span class="st">"</span>,</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>      res,</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>      <span class="st">"</span><span class="sc">\n\n</span><span class="st">&lt;/details&gt;"</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>knit_hooks<span class="sc">$</span><span class="fu">set</span>(</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="fu">hook_foldable</span>(<span class="st">"output"</span>),</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="fu">hook_foldable</span>(<span class="st">"plot"</span>)</span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>Before starting,please make sure you have installed the TriplotGUI package following <span class="co">[</span><span class="ot">Setup</span><span class="co">](installation.qmd)</span>{target="_blank"}.</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a>The code of at this page can be downloaded <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/HealthyNordicDiet_2_applying_TriplotGUI_code.R)</span>{target="_blank"}</span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data description</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>The data used in this page of tutorial can be downloaded <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda)</span>{target="_blank"} in rda format.</span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>The Data used for this example of code is ***HealthyNordicDiet_2***. This is a synthetic dataset that was simulated from the authentic data used in a case/control study nested within the Swedish prospective Västerbotten Intervention Programme cohort. The original study was set up to explore plasma metabolites that could objectively reflect healthy Nordic dietary patterns in a matched case-control study and to assess associations between such patterns and later development of type 2 diabetes. (Shi et al. 2018). The simulated data ***HealthyNordicDiet_2*** is a list that contains three data frames:</span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Clinical measurements (ClinData, 11 variables): <span class="in">`"ID"`</span>,<span class="in">`"T2D"`</span>(Cases and controls for type 2 diabetes), <span class="in">`"PairedInfo"`</span>(Pairing information for case and controls),<span class="in">`"Energy"`</span>,<span class="in">`"Gender"`</span>,<span class="in">`"Age"`</span>,<span class="in">`"BMI"`</span>,<span class="in">`"Smoking"`</span>,<span class="in">`"PhysicalActivityIndex"`</span>,<span class="in">`"Education"`</span>,<span class="in">`"FastingGlucose"`</span>.\</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Plasma metabolites predictive of BMI (MetaboliteData, 20 variables)</span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dietary intake as measured by food frequency questionnaires (FoodData, 11 variables): <span class="in">`"HFI"`</span>( Healthy Food Index),<span class="in">`"BSDS"`</span>(the Baltic Sea Diet Score),<span class="in">`"Wholegrains"`</span>,<span class="in">`"Sausage"`</span>,<span class="in">`"Pizza"`</span>,<span class="in">`"Refined.bread"`</span>, <span class="in">`"Fruits"`</span>,<span class="in">`"Liquor"`</span>,<span class="in">`"Wine"`</span>,<span class="in">`"Hamburger"`</span>,<span class="in">`"Poultry"`</span>,<span class="in">`"Fish"`</span>,<span class="in">`"Margarine"`</span>,<span class="in">`"Cabbage"`</span>,<span class="in">`"Carrot"`</span>,<span class="in">`"low_fat_Dairy"`</span>,<span class="in">`"Vegetables"`</span></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>The data frames are row-wise matched by observation and consist of 1000 synthetic observations.</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>**Reference**</span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>Shi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., &amp; Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. The American Journal of Clinical Nutrition, 108(3), 564-575. <span class="co">[</span><span class="ot">10.1093/ajcn/nqy145</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub)</span>{target="_blank"}</span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>Schillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. Metabolites. 2019 Jul 6;9(7):133. <span class="co">[</span><span class="ot">doi: 10.3390/metabo9070133</span><span class="co">](https://www.mdpi.com/2218-1989/9/7/133)</span>{target="_blank"}</span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research question</span></span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>We want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI.</span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data exploration</span></span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>***HealthyNordicDiet_2*** is loaded in the R environment up on running <span class="in">`library(TriplotGUI)`</span>. We will do some data exploration first to see how the data looks like.</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r noshowcode_runcode_noshowoutput_1}</span></span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TriplotGUI)</span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check HealthyNordicDiet_2</span></span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>Check ***HealthyNordicDiet_2*** as a list:</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_1}</span></span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(HealthyNordicDiet_2)</span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(HealthyNordicDiet_2)</span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check datasets</span></span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a>Check the names of variables in each data:</span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_2}</span></span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HealthyNordicDiet_2<span class="sc">$</span>ClinData)  </span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HealthyNordicDiet_2<span class="sc">$</span>MetaboliteData)</span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HealthyNordicDiet_2<span class="sc">$</span>FoodData)</span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check variables' class</span></span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a>We Transform the data to dataframe format and then use TriplotGUI's <span class="in">`checkdata()`</span> function in to examine the class of variables.</span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_1}</span></span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-131"><a href="#cb46-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-132"><a href="#cb46-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb46-133"><a href="#cb46-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-134"><a href="#cb46-134" aria-hidden="true" tabindex="-1"></a>ClinData<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(HealthyNordicDiet_2<span class="sc">$</span>ClinData)</span>
<span id="cb46-135"><a href="#cb46-135" aria-hidden="true" tabindex="-1"></a>MetaboliteData<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(HealthyNordicDiet_2<span class="sc">$</span>MetaboliteData)</span>
<span id="cb46-136"><a href="#cb46-136" aria-hidden="true" tabindex="-1"></a>FoodData<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(HealthyNordicDiet_2<span class="sc">$</span>FoodData)</span>
<span id="cb46-137"><a href="#cb46-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-138"><a href="#cb46-138" aria-hidden="true" tabindex="-1"></a>ClinData_check<span class="ot">&lt;-</span><span class="fu">checkdata</span>(ClinData)</span>
<span id="cb46-139"><a href="#cb46-139" aria-hidden="true" tabindex="-1"></a>MetaboliteData_check<span class="ot">&lt;-</span><span class="fu">checkdata</span>(MetaboliteData)</span>
<span id="cb46-140"><a href="#cb46-140" aria-hidden="true" tabindex="-1"></a>FoodData_check<span class="ot">&lt;-</span><span class="fu">checkdata</span>(FoodData)</span>
<span id="cb46-141"><a href="#cb46-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-142"><a href="#cb46-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-143"><a href="#cb46-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_3}</span></span>
<span id="cb46-144"><a href="#cb46-144" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-145"><a href="#cb46-145" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-146"><a href="#cb46-146" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-147"><a href="#cb46-147" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-148"><a href="#cb46-148" aria-hidden="true" tabindex="-1"></a>ClinData_check<span class="sc">$</span>class_sumamry_statistics</span>
<span id="cb46-149"><a href="#cb46-149" aria-hidden="true" tabindex="-1"></a>MetaboliteData_check<span class="sc">$</span>class_sumamry_statistics<span class="sc">$</span>check_class_table</span>
<span id="cb46-150"><a href="#cb46-150" aria-hidden="true" tabindex="-1"></a>FoodData_check<span class="sc">$</span>class_sumamry_statistics</span>
<span id="cb46-151"><a href="#cb46-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-152"><a href="#cb46-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-153"><a href="#cb46-153" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb46-154"><a href="#cb46-154" aria-hidden="true" tabindex="-1"></a>Note that <span class="in">`"HFI"`</span>(Healthy Food Index) is used as a factor variable and <span class="in">`"BSDS"`</span>(the Baltic Sea Diet Score) is used as a numeric variable. You could use <span class="in">`table(FoodData$HFI)`</span> and <span class="in">`table(FoodData$BSDS)`</span> to check the difference.</span>
<span id="cb46-155"><a href="#cb46-155" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-156"><a href="#cb46-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-157"><a href="#cb46-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check sanities for variables</span></span>
<span id="cb46-158"><a href="#cb46-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-159"><a href="#cb46-159" aria-hidden="true" tabindex="-1"></a>Whether each variable contains missing (NA) or abnormal values (e.g. NAN, Inf, blank value) can also be checked</span>
<span id="cb46-160"><a href="#cb46-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-161"><a href="#cb46-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_4}</span></span>
<span id="cb46-162"><a href="#cb46-162" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-163"><a href="#cb46-163" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-164"><a href="#cb46-164" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-165"><a href="#cb46-165" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-166"><a href="#cb46-166" aria-hidden="true" tabindex="-1"></a>ClinData_check<span class="sc">$</span>everycolumn</span>
<span id="cb46-167"><a href="#cb46-167" aria-hidden="true" tabindex="-1"></a>MetaboliteData_check<span class="sc">$</span>everycolumn</span>
<span id="cb46-168"><a href="#cb46-168" aria-hidden="true" tabindex="-1"></a>FoodData_check<span class="sc">$</span>everycolumn</span>
<span id="cb46-169"><a href="#cb46-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-170"><a href="#cb46-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-171"><a href="#cb46-171" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb46-172"><a href="#cb46-172" aria-hidden="true" tabindex="-1"></a>You shall only continue when the class of variables are correct and the missing or abnormal values in the variable are properly handled.</span>
<span id="cb46-173"><a href="#cb46-173" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-174"><a href="#cb46-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-175"><a href="#cb46-175" aria-hidden="true" tabindex="-1"></a><span class="fu">## Build data for analysis</span></span>
<span id="cb46-176"><a href="#cb46-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-177"><a href="#cb46-177" aria-hidden="true" tabindex="-1"></a>We see food data as our exposures and BMI and type 2 diabetes as outcomes. Note that BMI is a continuous variable. We can additionally construct BMI as a categorical outcome using the criteria below and see how this may differ the result. - BMI<span class="sc">\&lt;</span>= 18.5: Underweight - 18.5<span class="sc">\&lt;</span>BMI<span class="sc">\&lt;</span>= 25: Normal - 25<span class="sc">\&lt;</span> BMI<span class="sc">\&lt;</span>= 30: Overweight - 30<span class="sc">\&lt;</span> BMI: Obese</span>
<span id="cb46-178"><a href="#cb46-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-179"><a href="#cb46-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_4_1}</span></span>
<span id="cb46-180"><a href="#cb46-180" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-181"><a href="#cb46-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-182"><a href="#cb46-182" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-183"><a href="#cb46-183" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-184"><a href="#cb46-184" aria-hidden="true" tabindex="-1"></a>BMI<span class="ot">&lt;-</span>ClinData[,<span class="st">"BMI"</span>]</span>
<span id="cb46-185"><a href="#cb46-185" aria-hidden="true" tabindex="-1"></a>BMI_cat<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">length=</span><span class="fu">length</span>(BMI))</span>
<span id="cb46-186"><a href="#cb46-186" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(BMI)){</span>
<span id="cb46-187"><a href="#cb46-187" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(BMI[i]<span class="sc">&lt;=</span><span class="fl">18.5</span>){</span>
<span id="cb46-188"><a href="#cb46-188" aria-hidden="true" tabindex="-1"></a>    BMI_cat[i]<span class="ot">&lt;-</span><span class="st">"underweight"</span></span>
<span id="cb46-189"><a href="#cb46-189" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span> (BMI[i]<span class="sc">&gt;</span><span class="fl">18.5</span><span class="sc">&amp;</span>BMI[i]<span class="sc">&lt;=</span><span class="dv">25</span>){</span>
<span id="cb46-190"><a href="#cb46-190" aria-hidden="true" tabindex="-1"></a>    BMI_cat[i]<span class="ot">&lt;-</span><span class="st">"normal"</span></span>
<span id="cb46-191"><a href="#cb46-191" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(BMI[i]<span class="sc">&gt;</span><span class="dv">25</span><span class="sc">&amp;</span>BMI[i]<span class="sc">&lt;=</span><span class="dv">30</span>){</span>
<span id="cb46-192"><a href="#cb46-192" aria-hidden="true" tabindex="-1"></a>    BMI_cat[i]<span class="ot">&lt;-</span><span class="st">"overweight"</span></span>
<span id="cb46-193"><a href="#cb46-193" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb46-194"><a href="#cb46-194" aria-hidden="true" tabindex="-1"></a>    BMI_cat[i]<span class="ot">&lt;-</span><span class="st">"obese"</span></span>
<span id="cb46-195"><a href="#cb46-195" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb46-196"><a href="#cb46-196" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-197"><a href="#cb46-197" aria-hidden="true" tabindex="-1"></a>BMI_cat<span class="ot">&lt;-</span><span class="fu">as.factor</span>(BMI_cat)</span>
<span id="cb46-198"><a href="#cb46-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-199"><a href="#cb46-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-200"><a href="#cb46-200" aria-hidden="true" tabindex="-1"></a>We want to explore the exposure-outcome relationships through the metabolomics data, using metabolites as assumed mediators. Gender, age, education, physical activity and smoking are used as potential confounders for exposure-mediator and mediator-outcome association. Auxiliary information regarding case-control pairs, fasting glucose level, education and physical activity are also provided.</span>
<span id="cb46-201"><a href="#cb46-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-202"><a href="#cb46-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_5}</span></span>
<span id="cb46-203"><a href="#cb46-203" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-204"><a href="#cb46-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-205"><a href="#cb46-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-206"><a href="#cb46-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-207"><a href="#cb46-207" aria-hidden="true" tabindex="-1"></a>exposure2<span class="ot">&lt;-</span>FoodData</span>
<span id="cb46-208"><a href="#cb46-208" aria-hidden="true" tabindex="-1"></a>Omics2<span class="ot">&lt;-</span>MetaboliteData</span>
<span id="cb46-209"><a href="#cb46-209" aria-hidden="true" tabindex="-1"></a>outcome2<span class="ot">&lt;-</span><span class="fu">cbind.data.frame</span>(ClinData[,<span class="fu">c</span>(<span class="st">"T2D"</span>,<span class="st">"BMI"</span>)],BMI_cat)</span>
<span id="cb46-210"><a href="#cb46-210" aria-hidden="true" tabindex="-1"></a>covariates2<span class="ot">&lt;-</span>ClinData[,<span class="fu">c</span>(<span class="st">"Gender"</span> ,<span class="st">"Age"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>,<span class="st">"Smoking"</span> )]</span>
<span id="cb46-211"><a href="#cb46-211" aria-hidden="true" tabindex="-1"></a>auxilary2<span class="ot">&lt;-</span>ClinData[,<span class="fu">c</span>(<span class="st">"PairedInfo"</span>,<span class="st">"FastingGlucose"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>, <span class="st">"Energy"</span>)]</span>
<span id="cb46-212"><a href="#cb46-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-213"><a href="#cb46-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-214"><a href="#cb46-214" aria-hidden="true" tabindex="-1"></a><span class="fu"># Code example of using TriplotGUI</span></span>
<span id="cb46-215"><a href="#cb46-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-216"><a href="#cb46-216" aria-hidden="true" tabindex="-1"></a>We will use a complex settings in this example. Please go to <span class="co">[</span><span class="ot">Tutorial(simple)</span><span class="co">](simple_code.qmd)</span>{target="_blank"}.if you want to try simple settings.</span>
<span id="cb46-217"><a href="#cb46-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-218"><a href="#cb46-218" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 1: Data reduction of omics data {#simple_link}</span></span>
<span id="cb46-219"><a href="#cb46-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-220"><a href="#cb46-220" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`TriplotGUI`</span> package, first we perform dimension reduction, using weighted correlation network analysis (WGCNA) on metabolomics data.</span>
<span id="cb46-221"><a href="#cb46-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-222"><a href="#cb46-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_2}</span></span>
<span id="cb46-223"><a href="#cb46-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-224"><a href="#cb46-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-225"><a href="#cb46-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb46-226"><a href="#cb46-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-227"><a href="#cb46-227" aria-hidden="true" tabindex="-1"></a><span class="co">#* USing the most simple settings</span></span>
<span id="cb46-228"><a href="#cb46-228" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="ot">&lt;-</span><span class="fu">PCAorWGCNA_plots</span>(<span class="at">dataframe=</span>Omics2,</span>
<span id="cb46-229"><a href="#cb46-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-230"><a href="#cb46-230" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">plottype=</span><span class="fu">c</span>(<span class="st">"scree"</span>,<span class="st">"score"</span>,<span class="st">"loading"</span>,<span class="st">"scoreloading"</span>),</span>
<span id="cb46-231"><a href="#cb46-231" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">pc_type=</span><span class="st">"principal"</span>, </span>
<span id="cb46-232"><a href="#cb46-232" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># Use principal() instead of prcomp() to perform PCA</span></span>
<span id="cb46-233"><a href="#cb46-233" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">first_PC=</span><span class="dv">1</span>,</span>
<span id="cb46-234"><a href="#cb46-234" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">second_PC=</span><span class="dv">2</span>,</span>
<span id="cb46-235"><a href="#cb46-235" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">option=</span><span class="st">"WGCNA"</span>,</span>
<span id="cb46-236"><a href="#cb46-236" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">scale=</span>T,</span>
<span id="cb46-237"><a href="#cb46-237" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">center=</span>T,</span>
<span id="cb46-238"><a href="#cb46-238" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">eigen_loading=</span><span class="st">"loading"</span>,</span>
<span id="cb46-239"><a href="#cb46-239" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">rotate=</span><span class="st">"none"</span>,</span>
<span id="cb46-240"><a href="#cb46-240" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size_variable=</span>auxilary2<span class="sc">$</span>FastingGlucose,</span>
<span id="cb46-241"><a href="#cb46-241" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">size_variable_name=</span><span class="st">"FastigGlucose"</span>,</span>
<span id="cb46-242"><a href="#cb46-242" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color_variable=</span>auxilary2<span class="sc">$</span>Education,</span>
<span id="cb46-243"><a href="#cb46-243" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">color_variable_name=</span><span class="st">"Education"</span>,</span>
<span id="cb46-244"><a href="#cb46-244" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">shape_variable=</span>auxilary2<span class="sc">$</span>PhysicalActivityIndex,</span>
<span id="cb46-245"><a href="#cb46-245" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">shape_variable_name=</span><span class="st">"PhysicalActivityIndex"</span>,</span>
<span id="cb46-246"><a href="#cb46-246" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">scale_scoreloading=</span>T,</span>
<span id="cb46-247"><a href="#cb46-247" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">loadings_name=</span>T,</span>
<span id="cb46-248"><a href="#cb46-248" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">loadings_cutvalue=</span><span class="cn">NULL</span>,</span>
<span id="cb46-249"><a href="#cb46-249" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">loadings_cutpercent=</span><span class="fl">0.2</span>,</span>
<span id="cb46-250"><a href="#cb46-250" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">minModuleSize=</span><span class="dv">2</span>)</span>
<span id="cb46-251"><a href="#cb46-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-252"><a href="#cb46-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-253"><a href="#cb46-253" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb46-254"><a href="#cb46-254" aria-hidden="true" tabindex="-1"></a>You could try out the arguments of the <span class="in">`PCAorWGCNA_plots()`</span> function and view the whole function <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCAorWGCNA_plots.R?ref_type=heads)</span>{target="_blank"}</span>
<span id="cb46-255"><a href="#cb46-255" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-256"><a href="#cb46-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-257"><a href="#cb46-257" aria-hidden="true" tabindex="-1"></a>You can see scree plot, score plot, loadings plot and biplot at this stage.</span>
<span id="cb46-258"><a href="#cb46-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-259"><a href="#cb46-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6}</span></span>
<span id="cb46-260"><a href="#cb46-260" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-261"><a href="#cb46-261" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-262"><a href="#cb46-262" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-263"><a href="#cb46-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-264"><a href="#cb46-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb46-265"><a href="#cb46-265" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="sc">$</span>scree_plot</span>
<span id="cb46-266"><a href="#cb46-266" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="sc">$</span>score_plot</span>
<span id="cb46-267"><a href="#cb46-267" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="sc">$</span>loading_plot</span>
<span id="cb46-268"><a href="#cb46-268" aria-hidden="true" tabindex="-1"></a>reduced_Omics2<span class="sc">$</span>scoreloading_plot</span>
<span id="cb46-269"><a href="#cb46-269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-270"><a href="#cb46-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-271"><a href="#cb46-271" aria-hidden="true" tabindex="-1"></a>We then build a TPObject, which is used for saving information and pass them through steps in TriplotGUI.</span>
<span id="cb46-272"><a href="#cb46-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-273"><a href="#cb46-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_7}</span></span>
<span id="cb46-274"><a href="#cb46-274" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-275"><a href="#cb46-275" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-276"><a href="#cb46-276" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-277"><a href="#cb46-277" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-278"><a href="#cb46-278" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb46-279"><a href="#cb46-279" aria-hidden="true" tabindex="-1"></a>scores<span class="ot">=</span>reduced_Omics2<span class="sc">$</span>object<span class="sc">$</span>scores</span>
<span id="cb46-280"><a href="#cb46-280" aria-hidden="true" tabindex="-1"></a>loadings<span class="ot">&lt;-</span>reduced_Omics2<span class="sc">$</span>object<span class="sc">$</span>loadings</span>
<span id="cb46-281"><a href="#cb46-281" aria-hidden="true" tabindex="-1"></a>variance<span class="ot">&lt;-</span> reduced_Omics2<span class="sc">$</span>object<span class="sc">$</span>variance</span>
<span id="cb46-282"><a href="#cb46-282" aria-hidden="true" tabindex="-1"></a>TPObject1<span class="ot">&lt;-</span><span class="fu">makeTPO</span>(<span class="at">scores=</span>scores,</span>
<span id="cb46-283"><a href="#cb46-283" aria-hidden="true" tabindex="-1"></a>                   <span class="at">loadings=</span>loadings,</span>
<span id="cb46-284"><a href="#cb46-284" aria-hidden="true" tabindex="-1"></a>                   <span class="at">variance=</span>variance)</span>
<span id="cb46-285"><a href="#cb46-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-286"><a href="#cb46-286" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-287"><a href="#cb46-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-288"><a href="#cb46-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 2: Exposures’ correlations &amp; Outcomes’ associations</span></span>
<span id="cb46-289"><a href="#cb46-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-290"><a href="#cb46-290" aria-hidden="true" tabindex="-1"></a>The correlations between principal component (PC) scores and food items were calculated using Pearson correlations, adjusting for confounders. The associations between PC scores and risk markers were investigated using linear regression.</span>
<span id="cb46-291"><a href="#cb46-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-292"><a href="#cb46-292" aria-hidden="true" tabindex="-1"></a>Correlation matrix of correlation coefficients and p values between the TPO scores saved in the TPObject and the dietary variables in the data is generated, using a pair-wise Pearson correlations, adjusting for confounders.</span>
<span id="cb46-293"><a href="#cb46-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-294"><a href="#cb46-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_3}</span></span>
<span id="cb46-295"><a href="#cb46-295" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-296"><a href="#cb46-296" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-297"><a href="#cb46-297" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb46-298"><a href="#cb46-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-299"><a href="#cb46-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb46-300"><a href="#cb46-300" aria-hidden="true" tabindex="-1"></a>Correlations_object<span class="ot">&lt;-</span><span class="fu">makeCorr</span>(<span class="at">TPObject=</span>TPObject1,</span>
<span id="cb46-301"><a href="#cb46-301" aria-hidden="true" tabindex="-1"></a>                              <span class="at">corrData=</span>exposure2,</span>
<span id="cb46-302"><a href="#cb46-302" aria-hidden="true" tabindex="-1"></a>                              <span class="at">use=</span><span class="st">'pairwise'</span>,</span>
<span id="cb46-303"><a href="#cb46-303" aria-hidden="true" tabindex="-1"></a>                              <span class="at">method=</span><span class="st">'pearson'</span>,</span>
<span id="cb46-304"><a href="#cb46-304" aria-hidden="true" tabindex="-1"></a>                              <span class="at">allowcategorical=</span>F,</span>
<span id="cb46-305"><a href="#cb46-305" aria-hidden="true" tabindex="-1"></a>                              <span class="at">partial=</span>T,</span>
<span id="cb46-306"><a href="#cb46-306" aria-hidden="true" tabindex="-1"></a>                              <span class="at">confounder=</span>covariates2)</span>
<span id="cb46-307"><a href="#cb46-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-308"><a href="#cb46-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-309"><a href="#cb46-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-310"><a href="#cb46-310" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb46-311"><a href="#cb46-311" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`allowcategorical=F`</span> performs one-hot-encoding to transform categorical exposures variables with n<span class="sc">\&gt;</span>2 classes to n binary variables. You can use <span class="in">`Correlations_object$cor_estimate`</span> to check that each HFI level is separated in to a binary variable and the correlation coefficients between PCs and the binary variables were calculated. If <span class="in">`allowcategorical=T`</span> is specified, then the <span class="in">`HFI`</span> variable is forced as numeric variables. This is not recommended unless you are sure that the level itself reflect the numeric value.</span>
<span id="cb46-312"><a href="#cb46-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-313"><a href="#cb46-313" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`partial=T`</span> specifies that the confounders will be adjusted.</span>
<span id="cb46-314"><a href="#cb46-314" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-315"><a href="#cb46-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-316"><a href="#cb46-316" aria-hidden="true" tabindex="-1"></a>The result of correlations are then added into the TPObject.</span>
<span id="cb46-317"><a href="#cb46-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-318"><a href="#cb46-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_8}</span></span>
<span id="cb46-319"><a href="#cb46-319" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-320"><a href="#cb46-320" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-321"><a href="#cb46-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-322"><a href="#cb46-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-323"><a href="#cb46-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb46-324"><a href="#cb46-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-325"><a href="#cb46-325" aria-hidden="true" tabindex="-1"></a>TPObject2<span class="ot">&lt;-</span><span class="fu">addCorr</span>(<span class="at">TPObject=</span>TPObject1,</span>
<span id="cb46-326"><a href="#cb46-326" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Corr=</span>Correlations_object<span class="sc">$</span>cor_estimate,</span>
<span id="cb46-327"><a href="#cb46-327" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Corr_p=</span>Correlations_object<span class="sc">$</span>cor_pvalue)</span>
<span id="cb46-328"><a href="#cb46-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-329"><a href="#cb46-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-330"><a href="#cb46-330" aria-hidden="true" tabindex="-1"></a>Matrices of risk estimates and p values between the TPO scores saved in the TPObject and the outcome variables are generated, adjusting for confounders.</span>
<span id="cb46-331"><a href="#cb46-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-332"><a href="#cb46-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_4}</span></span>
<span id="cb46-333"><a href="#cb46-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-334"><a href="#cb46-334" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-335"><a href="#cb46-335" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb46-336"><a href="#cb46-336" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-337"><a href="#cb46-337" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb46-338"><a href="#cb46-338" aria-hidden="true" tabindex="-1"></a>Risks_object<span class="ot">&lt;-</span><span class="fu">coefficient_get</span>(<span class="at">TPObject=</span>TPObject2,</span>
<span id="cb46-339"><a href="#cb46-339" aria-hidden="true" tabindex="-1"></a>                              <span class="at">outcome=</span>outcome2,</span>
<span id="cb46-340"><a href="#cb46-340" aria-hidden="true" tabindex="-1"></a>                              <span class="at">confounder=</span>covariates2,</span>
<span id="cb46-341"><a href="#cb46-341" aria-hidden="true" tabindex="-1"></a>                              <span class="at">partial=</span>T,</span>
<span id="cb46-342"><a href="#cb46-342" aria-hidden="true" tabindex="-1"></a>                              <span class="at">multinomial=</span>T,</span>
<span id="cb46-343"><a href="#cb46-343" aria-hidden="true" tabindex="-1"></a>                              <span class="at">pair=</span>auxilary2<span class="sc">$</span>PairedInfo,</span>
<span id="cb46-344"><a href="#cb46-344" aria-hidden="true" tabindex="-1"></a>                              <span class="at">CI=</span><span class="fl">0.95</span>)</span>
<span id="cb46-345"><a href="#cb46-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-346"><a href="#cb46-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-347"><a href="#cb46-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-348"><a href="#cb46-348" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb46-349"><a href="#cb46-349" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`partial=T`</span> specifies that the confounders will be adjusted.</span>
<span id="cb46-350"><a href="#cb46-350" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When <span class="in">`pair`</span> information is not provided:</span>
<span id="cb46-351"><a href="#cb46-351" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`multinomial=F`</span> means that one-hot-encoding will be performed to transform categorical variables with n <span class="sc">\&gt;</span> 2 classes to n binary variables. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</span>
<span id="cb46-352"><a href="#cb46-352" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If specifying <span class="in">`multinomial=T`</span>, multinomial regression will be performed on the categorical outcome variable with n <span class="sc">\&gt;</span> 2 classes, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</span>
<span id="cb46-353"><a href="#cb46-353" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When <span class="in">`pair`</span> information for case - control pair is provided:</span>
<span id="cb46-354"><a href="#cb46-354" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`multinomial=F`</span> means that one-hot-encoding will be performed on categorical variables with n <span class="sc">\&gt;</span> 2 classes. And then conditional logistic regression will be performed on the binary variables and linear mixed model will be performed on continuous variables, using the pairing information.</span>
<span id="cb46-355"><a href="#cb46-355" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If specifying <span class="in">`multinomial=T`</span>, the pairing information will not be ignored and used (since the outcomes can have more than 2 classes), multinomial regression will be performed on the categorical outcome variable, which gives n-1 estimates. And logistic regression will be performed on the binary variables and linear regression will be performed on continuous variables.</span>
<span id="cb46-356"><a href="#cb46-356" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb46-357"><a href="#cb46-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-358"><a href="#cb46-358" aria-hidden="true" tabindex="-1"></a>The result of risk estimates are then added into the TPObject.</span>
<span id="cb46-359"><a href="#cb46-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-360"><a href="#cb46-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_9}</span></span>
<span id="cb46-361"><a href="#cb46-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-362"><a href="#cb46-362" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-363"><a href="#cb46-363" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-364"><a href="#cb46-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-365"><a href="#cb46-365" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb46-366"><a href="#cb46-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-367"><a href="#cb46-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-368"><a href="#cb46-368" aria-hidden="true" tabindex="-1"></a>TPObject3<span class="ot">&lt;-</span><span class="fu">addRisk</span>(<span class="at">TPObject=</span>TPObject2,</span>
<span id="cb46-369"><a href="#cb46-369" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Risk=</span>Risks_object)</span>
<span id="cb46-370"><a href="#cb46-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-371"><a href="#cb46-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-372"><a href="#cb46-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-373"><a href="#cb46-373" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 3: Visualization of Triplot</span></span>
<span id="cb46-374"><a href="#cb46-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-375"><a href="#cb46-375" aria-hidden="true" tabindex="-1"></a>Generate Triplot: Note that Triplot can be generated from any TPObject. You can try out different argument in the <span class="in">`TriplotGUI()`</span> function. The function is a wrapper of <span class="in">`PCA_TriplotGUI()`</span> and <span class="in">`WGCNA_TriplotGUI()`</span>. You can view the functions respectively here: <span class="co">[</span><span class="ot">`TriplotGUI()`</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/TriplotGUI.R?ref_type=heads)</span>{target="_blank"} [`PCA_TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCA_TriplotGUI.R?ref_type=heads){target="_blank"} [`WGCNA_TriplotGUI()`](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/WGCNA_TriplotGUI.R?ref_type=heads){target="_blank"}</span>
<span id="cb46-376"><a href="#cb46-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-377"><a href="#cb46-377" aria-hidden="true" tabindex="-1"></a>In this example we use WGCNA to perform data reduction, therefore specifying <span class="in">`option="WGCNA"`</span>.</span>
<span id="cb46-378"><a href="#cb46-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-379"><a href="#cb46-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_5}</span></span>
<span id="cb46-380"><a href="#cb46-380" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-381"><a href="#cb46-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-382"><a href="#cb46-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb46-383"><a href="#cb46-383" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-384"><a href="#cb46-384" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.output: false</span></span>
<span id="cb46-385"><a href="#cb46-385" aria-hidden="true" tabindex="-1"></a>Triplot_object3<span class="ot">&lt;-</span><span class="fu">TriplotGUI</span>(TPObject3,</span>
<span id="cb46-386"><a href="#cb46-386" aria-hidden="true" tabindex="-1"></a>                            <span class="at">first_PC=</span><span class="dv">1</span>,   <span class="do">## The first PC to map</span></span>
<span id="cb46-387"><a href="#cb46-387" aria-hidden="true" tabindex="-1"></a>                            <span class="at">second_PC=</span><span class="dv">2</span>,   <span class="do">## The first PC to map</span></span>
<span id="cb46-388"><a href="#cb46-388" aria-hidden="true" tabindex="-1"></a>                            <span class="at">plotLoads=</span><span class="cn">TRUE</span>,   </span>
<span id="cb46-389"><a href="#cb46-389" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Whether to plot loadings (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb46-390"><a href="#cb46-390" aria-hidden="true" tabindex="-1"></a>                            <span class="at">plotScores=</span><span class="cn">FALSE</span>,   </span>
<span id="cb46-391"><a href="#cb46-391" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Whether to plot scores (TRUE) or suppress them (FALSE; default)</span></span>
<span id="cb46-392"><a href="#cb46-392" aria-hidden="true" tabindex="-1"></a>                            <span class="at">plotCorr=</span><span class="cn">TRUE</span>,   </span>
<span id="cb46-393"><a href="#cb46-393" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Whether to plot correlations (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb46-394"><a href="#cb46-394" aria-hidden="true" tabindex="-1"></a>                            <span class="at">plotRisk=</span><span class="cn">TRUE</span>,      </span>
<span id="cb46-395"><a href="#cb46-395" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb46-396"><a href="#cb46-396" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb46-397"><a href="#cb46-397" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##For loadings</span></span>
<span id="cb46-398"><a href="#cb46-398" aria-hidden="true" tabindex="-1"></a>                            <span class="at">loadLabels=</span><span class="cn">TRUE</span>,   </span>
<span id="cb46-399"><a href="#cb46-399" aria-hidden="true" tabindex="-1"></a>                            <span class="do">###Whether to plot variable loading labels (TRUE; default) or not (FALSE)</span></span>
<span id="cb46-400"><a href="#cb46-400" aria-hidden="true" tabindex="-1"></a>                            <span class="at">loadArrowLength=</span><span class="fl">0.02</span>,   </span>
<span id="cb46-401"><a href="#cb46-401" aria-hidden="true" tabindex="-1"></a>                            <span class="do">###Length of arrow tip , set it as 0 if you want to remove it</span></span>
<span id="cb46-402"><a href="#cb46-402" aria-hidden="true" tabindex="-1"></a>                            <span class="at">loadCut=</span><span class="dv">0</span>,    </span>
<span id="cb46-403"><a href="#cb46-403" aria-hidden="true" tabindex="-1"></a>                            <span class="do">###lower limit Loadings below the cut are plotted in light grey and without label</span></span>
<span id="cb46-404"><a href="#cb46-404" aria-hidden="true" tabindex="-1"></a>                            <span class="at">loadLim=</span><span class="cn">NULL</span>,   </span>
<span id="cb46-405"><a href="#cb46-405" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##higher limit,Plot range for loadings</span></span>
<span id="cb46-406"><a href="#cb46-406" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb46-407"><a href="#cb46-407" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##For correlations</span></span>
<span id="cb46-408"><a href="#cb46-408" aria-hidden="true" tabindex="-1"></a>                            <span class="at">colCorr=</span><span class="st">"blue"</span>,   </span>
<span id="cb46-409"><a href="#cb46-409" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Color vector for correlations</span></span>
<span id="cb46-410"><a href="#cb46-410" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pchCorr=</span><span class="dv">16</span>,   </span>
<span id="cb46-411"><a href="#cb46-411" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Plotting character for correlations</span></span>
<span id="cb46-412"><a href="#cb46-412" aria-hidden="true" tabindex="-1"></a>                            <span class="at">whichCorr=</span><span class="cn">NULL</span>,  </span>
<span id="cb46-413"><a href="#cb46-413" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Which correlations to plot (vector of numbers)</span></span>
<span id="cb46-414"><a href="#cb46-414" aria-hidden="true" tabindex="-1"></a>                            <span class="at">corLim=</span><span class="cn">NULL</span>,     </span>
<span id="cb46-415"><a href="#cb46-415" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Plot range for correlations</span></span>
<span id="cb46-416"><a href="#cb46-416" aria-hidden="true" tabindex="-1"></a>                            <span class="at">corrLabels =</span> T,</span>
<span id="cb46-417"><a href="#cb46-417" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb46-418"><a href="#cb46-418" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##For risks</span></span>
<span id="cb46-419"><a href="#cb46-419" aria-hidden="true" tabindex="-1"></a>                            <span class="at">colRisk=</span><span class="st">"red"</span>,    </span>
<span id="cb46-420"><a href="#cb46-420" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Color vector for risk estimates</span></span>
<span id="cb46-421"><a href="#cb46-421" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pchRisk=</span><span class="dv">15</span>,    </span>
<span id="cb46-422"><a href="#cb46-422" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Plotting character for risk estimates</span></span>
<span id="cb46-423"><a href="#cb46-423" aria-hidden="true" tabindex="-1"></a>                            <span class="at">whichRisk=</span><span class="cn">NULL</span>,  </span>
<span id="cb46-424"><a href="#cb46-424" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Which risk estimates to plot (vector of numbers)</span></span>
<span id="cb46-425"><a href="#cb46-425" aria-hidden="true" tabindex="-1"></a>                            <span class="at">riskLim=</span><span class="cn">NULL</span>,            </span>
<span id="cb46-426"><a href="#cb46-426" aria-hidden="true" tabindex="-1"></a>                            <span class="do">##Plot range for risks</span></span>
<span id="cb46-427"><a href="#cb46-427" aria-hidden="true" tabindex="-1"></a>                            <span class="at">riskWhisker_percentage=</span><span class="fl">0.1</span>,  </span>
<span id="cb46-428"><a href="#cb46-428" aria-hidden="true" tabindex="-1"></a>                            <span class="do">## whisker length is how many percentage of confidence interval</span></span>
<span id="cb46-429"><a href="#cb46-429" aria-hidden="true" tabindex="-1"></a>                            <span class="at">riskLabels =</span> T,</span>
<span id="cb46-430"><a href="#cb46-430" aria-hidden="true" tabindex="-1"></a>                            <span class="at">size=</span><span class="dv">3</span>,</span>
<span id="cb46-431"><a href="#cb46-431" aria-hidden="true" tabindex="-1"></a>                            <span class="at">riskOR=</span>T)</span>
<span id="cb46-432"><a href="#cb46-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-433"><a href="#cb46-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-434"><a href="#cb46-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-435"><a href="#cb46-435" aria-hidden="true" tabindex="-1"></a>Plotting the triplot</span>
<span id="cb46-436"><a href="#cb46-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-437"><a href="#cb46-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_10}</span></span>
<span id="cb46-438"><a href="#cb46-438" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-439"><a href="#cb46-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-440"><a href="#cb46-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-441"><a href="#cb46-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-442"><a href="#cb46-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| fold.plot: true</span></span>
<span id="cb46-443"><a href="#cb46-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-444"><a href="#cb46-444" aria-hidden="true" tabindex="-1"></a>Triplot_object3<span class="sc">$</span>triplot</span>
<span id="cb46-445"><a href="#cb46-445" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-446"><a href="#cb46-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-447"><a href="#cb46-447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb46-448"><a href="#cb46-448" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb46-449"><a href="#cb46-449" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-450"><a href="#cb46-450" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb46-451"><a href="#cb46-451" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb46-452"><a href="#cb46-452" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-453"><a href="#cb46-453" aria-hidden="true" tabindex="-1"></a><span class="co">#don't run code, but show code</span></span>
<span id="cb46-454"><a href="#cb46-454" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb46-455"><a href="#cb46-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-456"><a href="#cb46-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-459"><a href="#cb46-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-460"><a href="#cb46-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-461"><a href="#cb46-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-462"><a href="#cb46-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb46-463"><a href="#cb46-463" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-464"><a href="#cb46-464" aria-hidden="true" tabindex="-1"></a><span class="co">#run code, and show code, don't show output</span></span>
<span id="cb46-465"><a href="#cb46-465" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb46-466"><a href="#cb46-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-467"><a href="#cb46-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-470"><a href="#cb46-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-471"><a href="#cb46-471" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-472"><a href="#cb46-472" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb46-473"><a href="#cb46-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-474"><a href="#cb46-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-475"><a href="#cb46-475" aria-hidden="true" tabindex="-1"></a><span class="co">#run code, not show code, but show output</span></span>
<span id="cb46-476"><a href="#cb46-476" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb46-477"><a href="#cb46-477" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="cf">function</span>(x){x<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb46-478"><a href="#cb46-478" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(<span class="dv">2</span>)</span>
<span id="cb46-479"><a href="#cb46-479" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-480"><a href="#cb46-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-483"><a href="#cb46-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-484"><a href="#cb46-484" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-485"><a href="#cb46-485" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb46-486"><a href="#cb46-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: false</span></span>
<span id="cb46-487"><a href="#cb46-487" aria-hidden="true" tabindex="-1"></a><span class="co">#| classes: styled-output</span></span>
<span id="cb46-488"><a href="#cb46-488" aria-hidden="true" tabindex="-1"></a><span class="co">#run code, not show code, not show output</span></span>
<span id="cb46-489"><a href="#cb46-489" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span></span>
<span id="cb46-490"><a href="#cb46-490" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="cf">function</span>(x){x<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb46-491"><a href="#cb46-491" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(<span class="dv">2</span>)</span>
<span id="cb46-492"><a href="#cb46-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-493"><a href="#cb46-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-496"><a href="#cb46-496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb46-497"><a href="#cb46-497" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb46-498"><a href="#cb46-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb46-499"><a href="#cb46-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb46-500"><a href="#cb46-500" aria-hidden="true" tabindex="-1"></a><span class="co">#run code, and show code, and show output</span></span>
<span id="cb46-501"><a href="#cb46-501" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb46-502"><a href="#cb46-502" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="cf">function</span>(x){x<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb46-503"><a href="#cb46-503" aria-hidden="true" tabindex="-1"></a><span class="fu">s</span>(<span class="dv">23</span>)</span>
<span id="cb46-504"><a href="#cb46-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb46-505"><a href="#cb46-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-506"><a href="#cb46-506" aria-hidden="true" tabindex="-1"></a>FOR REFERENCE: <span class="in">`r fontawesome::fa("graduation-cap", fill = "#98A08D", a11y = "sem")`</span> <span class="sc">\#</span> stopped working 5/1/2023?</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left"><span class="faux-block">© 2024 Yingxiao Yan CC BY-SA 4.0</span></div>   
    <div class="nav-footer-center"><span class="faux-block"><a href="https://gitlab.com/YingxiaoYan/TriplotGUI">TriplotGUI gitlab</a></span></div>
    <div class="nav-footer-right"><span class="faux-block cyan"><a href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/">View source of this site on GitLab</a></span></div>
  </div>
</footer>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>