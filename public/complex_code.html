<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Tutorial(complex) - Code – TriplotGUI </title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./img/TriplotGUI_logo_white.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": true,
  "collapse-after": 5,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: white;
      }

      .quarto-title-block .quarto-title-banner {
        color: white;
      }
</style>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="styles.scss">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./img/TriplotGUI_logo_black.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">TriplotGUI <i class="fa-brands fa-gitlab" aria-label="gitlab"></i></span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./introduction.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./installation.html"> 
<span class="menu-text">Setup</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./workflow.html"> 
<span class="menu-text">Manual</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorial(simple" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorial(simple)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorial(simple">
<li>
    <a class="dropdown-item" href="./simple.html">
 <span class="dropdown-text">User Interface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./simple_code.html">
 <span class="dropdown-text">Code</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorial(complex" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorial(complex)</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tutorial(complex">
<li>
    <a class="dropdown-item" href="./complex.html">
 <span class="dropdown-text">User Interface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./complex_code.html">
 <span class="dropdown-text">Code</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./papers.html"> 
<span class="menu-text">Papers</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About us</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item compact">
    <a class="nav-link" href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/" target="_blank"> <i class="bi bi-folder-symlink" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/yingxiao-yan" target="_blank"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:yingxiao@chalmers.se"> <i class="bi bi-envelope" role="img" aria-label="email">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <div class="quarto-title-block"><div><h1 class="title">Tutorial(complex) - Code</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">Complex demo of using TriplotGUI’s code</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Tutorial</h2>
   
  <ul>
<li><a href="#data-description" id="toc-data-description" class="nav-link active" data-scroll-target="#data-description">Data description</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question">Research question</a></li>
  <li>
<a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data exploration</a>
  <ul>
<li><a href="#check-healthynordicdiet_2" id="toc-check-healthynordicdiet_2" class="nav-link" data-scroll-target="#check-healthynordicdiet_2">Check HealthyNordicDiet_2</a></li>
  <li><a href="#check-datasets" id="toc-check-datasets" class="nav-link" data-scroll-target="#check-datasets">Check datasets</a></li>
  <li><a href="#check-variables-class" id="toc-check-variables-class" class="nav-link" data-scroll-target="#check-variables-class">Check variables’ class</a></li>
  <li><a href="#check-sanities-for-variables" id="toc-check-sanities-for-variables" class="nav-link" data-scroll-target="#check-sanities-for-variables">Check sanities for variables</a></li>
  <li><a href="#build-data-for-analysis" id="toc-build-data-for-analysis" class="nav-link" data-scroll-target="#build-data-for-analysis">Build data for analysis</a></li>
  </ul>
</li>
  <li>
<a href="#code-example-of-using-triplotgui" id="toc-code-example-of-using-triplotgui" class="nav-link" data-scroll-target="#code-example-of-using-triplotgui">Code example of using TriplotGUI</a>
  <ul>
<li><a href="#simple_link" id="toc-simple_link" class="nav-link" data-scroll-target="#simple_link">Step 1: Data reduction of Omics variables</a></li>
  <li><a href="#step-2-3-exposure-omics-and-omics-outcome-associations" id="toc-step-2-3-exposure-omics-and-omics-outcome-associations" class="nav-link" data-scroll-target="#step-2-3-exposure-omics-and-omics-outcome-associations">Step 2-3: Exposure-Omics and Omics-Outcome associations</a></li>
  <li><a href="#step-4-meet-in-the-middle-triplot-visualization" id="toc-step-4-meet-in-the-middle-triplot-visualization" class="nav-link" data-scroll-target="#step-4-meet-in-the-middle-triplot-visualization">Step 4: Meet-in-the-middle Triplot Visualization</a></li>
  <li><a href="#step-5-mediation-analysis-and-visualization" id="toc-step-5-mediation-analysis-and-visualization" class="nav-link" data-scroll-target="#step-5-mediation-analysis-and-visualization">Step 5: Mediation analysis and visualization</a></li>
  <li><a href="#comparative-visualization" id="toc-comparative-visualization" class="nav-link" data-scroll-target="#comparative-visualization">Comparative Visualization</a></li>
  <li><a href="#data-download" id="toc-data-download" class="nav-link" data-scroll-target="#data-download">Data download</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial/edit/main/complex_code.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial/blob/main/complex_code.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content"><p>The code at this page can be downloaded <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/HealthyNordicDiet_2_applying_TriplotGUI_code.R" target="_blank">here</a></p>
<p>Before starting, please ensure you have installed the TriplotGUI package following the <a href="./installation.html" target="_blank" style="color:blue">Setup</a> instructions.</p>
<section id="data-description" class="level1"><h1>Data description</h1>
<p>The data used in this tutorial section can be downloaded <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda" target="_blank">here</a> in rda format.</p>
<p>This example utilizes <strong><em>HealthyNordicDiet_2</em></strong>, which is a modified version of the <strong>HealthyNordicDiet</strong> data provided by the <a href="https://gitlab.com/CarlBrunius/triplot/-/blob/master/vignettes/Triplot_Tutorial.md?ref_type=heads" target="_blank"><em>Triplot</em></a> package (Schillemans et al.&nbsp;2019). The <strong>HealthyNordicDiet</strong> is a synthetic dataset that simulates data from a case-control study within the Swedish Västerbotten Intervention Programme cohort, exploring plasma metabolites reflecting healthy Nordic dietary patterns and their association with type 2 diabetes development (Shi et al.&nbsp;2018). The simulated <strong><em>HealthyNordicDiet_2</em></strong> data consists of three data frames:</p>
<ul>
<li>Clinical measurements (ClinData): Contains 11 variables: <code>"ID"</code>,<code>"T2D"</code>(Cases and controls for type 2 diabetes), <code>"PairedInfo"</code>(Pairing/matching information for case and controls, a unique number is assigned to each case-control pairs),<code>"Energy"</code>,<code>"Gender"</code>,<code>"Age"</code>,<code>"BMI"</code>,<code>"Smoking"</code>,<code>"PhysicalActivityIndex"</code>,<code>"Education"</code>,<code>"FastingGlucose"</code>.<br>
</li>
<li>Plasma metabolites predictive of BMI (MetaboliteData): Comprises 20 variables</li>
<li>Dietary intake as measured by food frequency questionnaires (FoodData): Includes 11 variables: <code>"HFI"</code>(Healthy Food Index),<code>"BSDS"</code>(the Baltic Sea Diet Score),<code>"Wholegrains"</code>,<code>"Sausage"</code>,<code>"Pizza"</code>,<code>"Refined.bread"</code>, <code>"Fruits"</code>,<code>"Liquor"</code>,<code>"Wine"</code>,<code>"Hamburger"</code>,<code>"Poultry"</code>,<code>"Fish"</code>,<code>"Margarine"</code>,<code>"Cabbage"</code>,<code>"Carrot"</code>,<code>"low_fat_Dairy"</code>,<code>"Vegetables"</code>
</li>
</ul>
<p>The data frames are row-wise matched by observations and consist of 1000 synthetic observations.</p>
<p><strong>Reference</strong></p>
<p>Shi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., &amp; Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. <em>The American Journal of Clinical Nutrition</em>, 108(3), 564-575. <a href="https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub" target="_blank">10.1093/ajcn/nqy145</a></p>
<p>Schillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. <em>Metabolites</em>. 2019 Jul 6;9(7):133. <a href="https://www.mdpi.com/2218-1989/9/7/133" target="_blank">doi: 10.3390/metabo9070133</a></p>
</section><section id="research-question" class="level1"><h1>Research question</h1>
<p>We want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI. We assume that metabolites serves as mediators, mediating the effect of dietary exposures on Type 2 diabetes and BMI.</p>
</section><section id="data-exploration" class="level1"><h1>Data exploration</h1>
<p><strong><em>HealthyNordicDiet_2</em></strong> is loaded in the R environment upon running <code><a href="https://rdrr.io/r/base/library.html">library(TriplotGUI)</a></code>. Let’s begin with some data exploration to understand the structure and contents of the dataset:</p>
<div class="cell styled-output">

</div>
<section id="check-healthynordicdiet_2" class="level2"><h2 class="anchored" data-anchor-id="check-healthynordicdiet_2">Check HealthyNordicDiet_2</h2>
<p>Check the <strong><em>HealthyNordicDiet_2</em></strong> list:</p>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "ClinData"       "MetaboliteData" "FoodData"      </code></pre>
</div>
</div>
</section><section id="check-datasets" class="level2"><h2 class="anchored" data-anchor-id="check-datasets">Check datasets</h2>
<p>Check the names of variables in each data:</p>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">ClinData</span><span class="op">)</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "ID"                    "T2D"                   "PairedInfo"           
 [4] "Energy"                "Gender"                "Age"                  
 [7] "BMI"                   "Smoking"               "PhysicalActivityIndex"
[10] "Education"             "FastingGlucose"       </code></pre>
</div>
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">MetaboliteData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "Pipecolic.acid.betaine"         "lysoPC.18.0."                  
 [3] "HP143.1179.1.55"                "lysoPE.22.6."                  
 [5] "HN151.0065.4.97"                "RP225.1482.9.15"               
 [7] "X3.4.5.Trimethoxycinnamic.acid" "DHA"                           
 [9] "RP383.1671.10.53"               "gama.tocopherol"               
[11] "RP431.3516.11.96"               "RP490.3516.8.99"               
[13] "lysoPC.22.6."                   "Steroid.glucuronide"           
[15] "RP684.5545.13.41"               "RP197.0926.3.17"               
[17] "RP303.6468.9.98"                "RP816.5684.12.52"              
[19] "RP827.5356.11.88"               "RP826.5442.12.17"              
[21] "RN201.1498.8.23"                "RN203.0022.3.00"               
[23] "EPA"                            "PC.18.2.15.0."                 
[25] "RN814.5610.12.14"               "RN153.0190.3.5"                
[27] "RN427.1641.10.59"               "RN457.1742.10.50"              
[29] "RN830.5845.12.46"               "RN446.1541.10.59"              
[31] "RN472.1596.10.53"              </code></pre>
</div>
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">FoodData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> [1] "HFI"           "BSDS"          "Wholegrains"   "Sausage"      
 [5] "Pizza"         "Refined.bread" "Fruits"        "Liquor"       
 [9] "Wine"          "Hamburger"     "Poultry"       "Fish"         
[13] "Margarine"     "Cabbage"       "Carrot"        "low_fat_Dairy"
[17] "Vegetables"   </code></pre>
</div>
</div>
</section><section id="check-variables-class" class="level2"><h2 class="anchored" data-anchor-id="check-variables-class">Check variables’ class</h2>
<p>We then transform the data to dataframe format and use TriplotGUI’s <code>checkdata()</code> function to examine the classes of variables.</p>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ClinData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">ClinData</span><span class="op">)</span></span>
<span><span class="va">MetaboliteData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">MetaboliteData</span><span class="op">)</span></span>
<span><span class="va">FoodData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">HealthyNordicDiet_2</span><span class="op">$</span><span class="va">FoodData</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ClinData_check</span> <span class="op">&lt;-</span> <span class="fu">checkdata</span><span class="op">(</span><span class="va">ClinData</span><span class="op">)</span></span>
<span><span class="va">MetaboliteData_check</span> <span class="op">&lt;-</span> <span class="fu">checkdata</span><span class="op">(</span><span class="va">MetaboliteData</span><span class="op">)</span></span>
<span><span class="va">FoodData_check</span> <span class="op">&lt;-</span> <span class="fu">checkdata</span><span class="op">(</span><span class="va">FoodData</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ClinData_check</span><span class="op">$</span><span class="va">class_summary_statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$check_class_vector
                   ID                   T2D            PairedInfo 
            "numeric"              "factor"              "factor" 
               Energy                Gender                   Age 
            "numeric"              "factor"             "numeric" 
                  BMI               Smoking PhysicalActivityIndex 
            "numeric"              "factor"              "factor" 
            Education        FastingGlucose 
             "factor"             "numeric" 

$check_class_table
check_class_vector
 factor numeric 
      6       5 </code></pre>
</div>
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">MetaboliteData_check</span><span class="op">$</span><span class="va">class_summary_statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$check_class_vector
        Pipecolic.acid.betaine                   lysoPC.18.0. 
                     "numeric"                      "numeric" 
               HP143.1179.1.55                   lysoPE.22.6. 
                     "numeric"                      "numeric" 
               HN151.0065.4.97                RP225.1482.9.15 
                     "numeric"                      "numeric" 
X3.4.5.Trimethoxycinnamic.acid                            DHA 
                     "numeric"                      "numeric" 
              RP383.1671.10.53                gama.tocopherol 
                     "numeric"                      "numeric" 
              RP431.3516.11.96                RP490.3516.8.99 
                     "numeric"                      "numeric" 
                  lysoPC.22.6.            Steroid.glucuronide 
                     "numeric"                      "numeric" 
              RP684.5545.13.41                RP197.0926.3.17 
                     "numeric"                      "numeric" 
               RP303.6468.9.98               RP816.5684.12.52 
                     "numeric"                      "numeric" 
              RP827.5356.11.88               RP826.5442.12.17 
                     "numeric"                      "numeric" 
               RN201.1498.8.23                RN203.0022.3.00 
                     "numeric"                      "numeric" 
                           EPA                  PC.18.2.15.0. 
                     "numeric"                      "numeric" 
              RN814.5610.12.14                 RN153.0190.3.5 
                     "numeric"                      "numeric" 
              RN427.1641.10.59               RN457.1742.10.50 
                     "numeric"                      "numeric" 
              RN830.5845.12.46               RN446.1541.10.59 
                     "numeric"                      "numeric" 
              RN472.1596.10.53 
                     "numeric" 

$check_class_table
check_class_vector
numeric 
     31 </code></pre>
</div>
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FoodData_check</span><span class="op">$</span><span class="va">class_summary_statistics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$check_class_vector
          HFI          BSDS   Wholegrains       Sausage         Pizza 
     "factor"     "numeric"     "numeric"     "numeric"     "numeric" 
Refined.bread        Fruits        Liquor          Wine     Hamburger 
    "numeric"     "numeric"     "numeric"     "numeric"     "numeric" 
      Poultry          Fish     Margarine       Cabbage        Carrot 
    "numeric"     "numeric"     "numeric"     "numeric"     "numeric" 
low_fat_Dairy    Vegetables 
    "numeric"     "numeric" 

$check_class_table
check_class_vector
 factor numeric 
      1      16 </code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that in the given data, <code>"HFI"</code>(Healthy Food Index) is a factor variable and <code>"BSDS"</code>(the Baltic Sea Diet Score) is a numeric variable. You could use <code>table(FoodData$HFI)</code> and <code>table(FoodData$BSDS)</code> to check the difference.</p>
</div>
</div>
</section><section id="check-sanities-for-variables" class="level2"><h2 class="anchored" data-anchor-id="check-sanities-for-variables">Check sanities for variables</h2>
<p>To check for missing (NA) or abnormal values (e.g., NaN, negative values, infinite values, blank values) in each variable, you can use the <code>checkdata()</code> function. This function generates a summary table for each data frame, showing the number of observations containing NA, NaN, zero, negative, infinite (Inf), and blank values, along with their percentages.</p>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"kableExtra"</span><span class="op">)</span>  <span class="co"># Install the package if it's not available.</span></span>
<span></span>
<span><span class="op">}</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span>             <span class="co"># Load it after installation.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ClinData_check</span><span class="op">$</span><span class="va">everycolumn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ID</th>
<th style="text-align: right;">T2D</th>
<th style="text-align: right;">PairedInfo</th>
<th style="text-align: right;">Energy</th>
<th style="text-align: right;">Gender</th>
<th style="text-align: right;">Age</th>
<th style="text-align: right;">BMI</th>
<th style="text-align: right;">Smoking</th>
<th style="text-align: right;">PhysicalActivityIndex</th>
<th style="text-align: right;">Education</th>
<th style="text-align: right;">FastingGlucose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NA_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NaN_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NaN_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">negative_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">negative_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inf_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">inf_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blank_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blank_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">MetaboliteData_check</span><span class="op">$</span><span class="va">everycolumn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 5%">
<col style="width: 0%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 0%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Pipecolic.acid.betaine</th>
<th style="text-align: right;">lysoPC.18.0.</th>
<th style="text-align: right;">HP143.1179.1.55</th>
<th style="text-align: right;">lysoPE.22.6.</th>
<th style="text-align: right;">HN151.0065.4.97</th>
<th style="text-align: right;">RP225.1482.9.15</th>
<th style="text-align: right;">X3.4.5.Trimethoxycinnamic.acid</th>
<th style="text-align: right;">DHA</th>
<th style="text-align: right;">RP383.1671.10.53</th>
<th style="text-align: right;">gama.tocopherol</th>
<th style="text-align: right;">RP431.3516.11.96</th>
<th style="text-align: right;">RP490.3516.8.99</th>
<th style="text-align: right;">lysoPC.22.6.</th>
<th style="text-align: right;">Steroid.glucuronide</th>
<th style="text-align: right;">RP684.5545.13.41</th>
<th style="text-align: right;">RP197.0926.3.17</th>
<th style="text-align: right;">RP303.6468.9.98</th>
<th style="text-align: right;">RP816.5684.12.52</th>
<th style="text-align: right;">RP827.5356.11.88</th>
<th style="text-align: right;">RP826.5442.12.17</th>
<th style="text-align: right;">RN201.1498.8.23</th>
<th style="text-align: right;">RN203.0022.3.00</th>
<th style="text-align: right;">EPA</th>
<th style="text-align: right;">PC.18.2.15.0.</th>
<th style="text-align: right;">RN814.5610.12.14</th>
<th style="text-align: right;">RN153.0190.3.5</th>
<th style="text-align: right;">RN427.1641.10.59</th>
<th style="text-align: right;">RN457.1742.10.50</th>
<th style="text-align: right;">RN830.5845.12.46</th>
<th style="text-align: right;">RN446.1541.10.59</th>
<th style="text-align: right;">RN472.1596.10.53</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NA_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NaN_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">NaN_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">negative_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">negative_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inf_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">inf_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blank_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">blank_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">FoodData_check</span><span class="op">$</span><span class="va">everycolumn</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">HFI</th>
<th style="text-align: right;">BSDS</th>
<th style="text-align: right;">Wholegrains</th>
<th style="text-align: right;">Sausage</th>
<th style="text-align: right;">Pizza</th>
<th style="text-align: right;">Refined.bread</th>
<th style="text-align: right;">Fruits</th>
<th style="text-align: right;">Liquor</th>
<th style="text-align: right;">Wine</th>
<th style="text-align: right;">Hamburger</th>
<th style="text-align: right;">Poultry</th>
<th style="text-align: right;">Fish</th>
<th style="text-align: right;">Margarine</th>
<th style="text-align: right;">Cabbage</th>
<th style="text-align: right;">Carrot</th>
<th style="text-align: right;">low_fat_Dairy</th>
<th style="text-align: right;">Vegetables</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NA_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">NA_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NaN_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">NaN_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">negative_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">negative_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">63.000</td>
<td style="text-align: right;">139.000</td>
<td style="text-align: right;">195.000</td>
<td style="text-align: right;">155.000</td>
<td style="text-align: right;">180.00</td>
<td style="text-align: right;">367.000</td>
<td style="text-align: right;">288.000</td>
<td style="text-align: right;">231.000</td>
<td style="text-align: right;">117.000</td>
<td style="text-align: right;">79.000</td>
<td style="text-align: right;">41.000</td>
<td style="text-align: right;">253.000</td>
<td style="text-align: right;">225.000</td>
<td style="text-align: right;">237.000</td>
<td style="text-align: right;">192.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">zero_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.195</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.367</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.041</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">0.237</td>
<td style="text-align: right;">0.192</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inf_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">inf_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">blank_number</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">blank_percentage</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You shall only continue to use the data when the class of variables are correct and the missing or abnormal values in the variable are properly handled.</p>
</div>
</div>
</section><section id="build-data-for-analysis" class="level2"><h2 class="anchored" data-anchor-id="build-data-for-analysis">Build data for analysis</h2>
<p>We treat food variables as our exposures and BMI and type 2 diabetes as outcomes. Note that BMI is a continuous variable. We can additionally construct BMI as a categorical outcome using the following criteria:</p>
<ul>
<li>BMI &lt;= 18.5: Underweight</li>
<li>18.5 &lt;BMI &lt;= 25: Normal</li>
<li>25 &lt; BMI &lt;= 30: Overweight</li>
<li>30 &lt; BMI: Obese</li>
</ul>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BMI</span> <span class="op">&lt;-</span> <span class="va">ClinData</span><span class="op">[</span>,<span class="st">"BMI"</span><span class="op">]</span> </span>
<span></span>
<span><span class="va">BMI_cat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">BMI</span>,  </span>
<span>               breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">18.5</span>, <span class="fl">25</span>, <span class="fl">30</span>, <span class="cn">Inf</span><span class="op">)</span>,  </span>
<span>               labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'underweight'</span>, <span class="st">'normal'</span>, <span class="st">'overweight'</span>, <span class="st">'obese'</span><span class="op">)</span>,  </span>
<span>               right <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We want to explore the exposure-outcome relationships through the metabolomics data, using metabolites as assumed mediators. Food data serves as exposures, while BMI (both continuous and categorical) and Type 2 Diabetes are treated as outcomes. Gender, age, education, physical activity, and smoking are used as potential confounders for the exposure-mediator and mediator-outcome associations. Additionally, auxiliary information regarding case-control matches, fasting glucose levels, education, and physical activity is provided to enhance the analysis.</p>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">exposure2</span> <span class="op">&lt;-</span> <span class="va">FoodData</span></span>
<span><span class="va">Omics2</span> <span class="op">&lt;-</span> <span class="va">MetaboliteData</span></span>
<span><span class="va">outcome2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind.data.frame</a></span><span class="op">(</span><span class="va">ClinData</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T2D"</span>,<span class="st">"BMI"</span><span class="op">)</span><span class="op">]</span>, <span class="va">BMI_cat</span><span class="op">)</span></span>
<span><span class="va">covariates2</span> <span class="op">&lt;-</span> <span class="va">ClinData</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Gender"</span> ,<span class="st">"Age"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>,<span class="st">"Smoking"</span> <span class="op">)</span><span class="op">]</span></span>
<span><span class="va">auxiliary2</span> <span class="op">&lt;-</span> <span class="va">ClinData</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PairedInfo"</span>,<span class="st">"FastingGlucose"</span>,<span class="st">"Education"</span>,<span class="st">"PhysicalActivityIndex"</span>, <span class="st">"Energy"</span><span class="op">)</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="code-example-of-using-triplotgui" class="level1"><h1>Code example of using TriplotGUI</h1>
<p>We will use more complex settings in this example. Please go to <a href="./simple_code.html" target="_blank">Tutorial(simple)</a>.if you want to try simpler settings.</p>
<section id="simple_link" class="level2"><h2 class="anchored" data-anchor-id="simple_link">Step 1: Data reduction of Omics variables</h2>
<p>Using <code>TriplotGUI</code> package, first we perform dimension reduction, using weighted correlation network analysis (WGCNA) on metabolomics data.</p>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using the complex settings</span></span>
<span><span class="va">reduced_Omics2</span> <span class="op">&lt;-</span> <span class="fu">OmicsReduction</span><span class="op">(</span>dataframe <span class="op">=</span> <span class="va">Omics2</span>,</span>
<span>                                   plotType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"scree"</span>,<span class="st">"score"</span>,<span class="st">"loading"</span>,<span class="st">"scoreloading"</span><span class="op">)</span>,</span>
<span>                                   pcType <span class="op">=</span> <span class="st">"principal"</span>, </span>
<span><span class="co"># Users can choose freely to use principal() instead of prcomp() to perform PCA.The result should be very similar, but principal() allows more functionalities</span></span>
<span>                                   firstPC <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                   secondPC<span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                   option <span class="op">=</span> <span class="st">"WGCNA"</span>,</span>
<span><span class="co"># In this example we use WGCNA to perform data reduction, therefore specifying `option="WGCNA"`.</span></span>
<span>                                   scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                   eigenLoading <span class="op">=</span> <span class="st">"loading"</span>,</span>
<span><span class="co"># If you want to show loading or scale it to eigevalues.</span></span>
<span>                                   rotate <span class="op">=</span> <span class="st">"none"</span>,</span>
<span><span class="co"># This argument is inherited from the principal() function</span></span>
<span>                                   sizeVariable <span class="op">=</span> <span class="va">auxiliary2</span><span class="op">$</span><span class="va">FastingGlucose</span>,</span>
<span>                                   sizeVariableName <span class="op">=</span> <span class="st">"FastigGlucose"</span>,</span>
<span>                                   colorVariable <span class="op">=</span> <span class="va">auxiliary2</span><span class="op">$</span><span class="va">Education</span>,</span>
<span>                                   colorVariableName <span class="op">=</span> <span class="st">"Education"</span>,</span>
<span>                                   shapeVariable <span class="op">=</span> <span class="va">auxiliary2</span><span class="op">$</span><span class="va">PhysicalActivityIndex</span>,</span>
<span>                                   shapeVariableName <span class="op">=</span> <span class="st">"PhysicalActivityIndex"</span>,</span>
<span><span class="co"># The size,shape,color variables are used to differentiate points on the score plot and biplot </span></span>
<span>                                   loadingsName <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span><span class="co"># Show the names of loadings</span></span>
<span>                                   loadingsCutpercent <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span><span class="co"># The loadings bigger than 20% of all the loadings will show up</span></span>
<span>                                   minModuleSize <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="co"># The mimimum number of variable in each cluster of WGCNA</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>In WGCNA, Omics variables are grouped into clusters. PCA is performed on each cluster, and the first principal component of each cluster is used as the module for WGCNA.</p></li>
<li><p>You could try out the arguments of the <code>OmicsReduction()</code> function to visualize the results and view the whole function <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCAorWGCNA_plots.R?ref_type=heads" target="_blank">here</a></p></li>
<li>
<p>The <code>minModuleSize</code> argument in <code>OmicsReduction()</code> is crucial as it defines the minimum number of variables in each cluster. Setting this too high may result in all variables being grouped into a single cluster. For instance, with 20 variables and <code>minModuleSize=15</code>, you might end up with one cluster containing all 20 variables. In this case, only the first principal component of this single cluster would be used and displayed on both axes of the resulting triplots.</p>
<p>To avoid this, adjust <code>minModuleSize</code> based on your total variable count and desired cluster granularity. Experiment with different values to achieve a balance between meaningful clusters and interpretable results.</p>
</li>
</ul>
</div>
</div>
<p>You can see scree plot, score plot, loadings plot and biplot at this stage.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">scree_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_6A-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6A-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>The scree plot in WGCNA visualizes the variance explained by each cluster. Clusters are color-coded, with column heights representing the proportion of total variance explained by each cluster. The darker color in each column shows the variance explained by the first principal component (module) of that cluster.</p>
<p>The grey cluster, showing only a darker color, indicates it contains just one variable, which serves as its own first principal component/module. This can occur even with <code>minModuleSize=2</code>, as some variables may be left unclustered.</p>
<p>Clusters are arranged from left to right based on the number of variables they contain, with the leftmost cluster having the most variables and the rightmost having the least. This arrangement helps in quickly identifying the relative sizes and importance of different clusters in the dataset.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">score_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_6B-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6B-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>In the score plot, observations are colored by education level, with different shapes representing varying physical activity indices and different sizes indicating fasting glucose levels. This visualization allows for an integrated view of how these characteristics relate to the modules derived from the WGCNA analysis, highlighting patterns among individuals based on their traits.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">loading_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_6C-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6C-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>The loading plot displays loadings aligned along the axes, reflecting the use of first principal components/modules from each cluster in WGCNA. This alignment occurs because each axis represents a distinct principal component analysis, making it impossible for loadings to point in the direction of another axis.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">scoreloading_plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_6D-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_6D-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sometimes the following text will show up in your console and the figure cannot be directly run:</p>
<p><code>libpng warning: Image width is zero in IHDR</code></p>
<p><code>libpng error: Invalid IHDR data</code></p>
<p><code>Warning message:</code></p>
<p><code>In dev.off(which) : agg could not write to the given file\</code></p>
<p>Run <code><a href="https://rdrr.io/r/base/gc.html">gc()</a></code> in your console to clear the memory. Then rerun the code again to view the figure.</p>
</div>
</div>
<p>Although informative, the biplot combining both score and loading can appear cluttered due to the high density of information it contains.</p>
<p>A TPObject is constructed based on the data reduction results from the WGCNA analysis. This object serves as a central repository for storing and trandfering information generated through the various steps during the analysis.</p>
<div class="cell styled-output" data-fold.output="false">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">scores</span></span>
<span><span class="va">loadings</span> <span class="op">&lt;-</span> <span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">loadings</span></span>
<span><span class="va">variance</span> <span class="op">&lt;-</span> <span class="va">reduced_Omics2</span><span class="op">$</span><span class="va">object</span><span class="op">$</span><span class="va">variance</span></span>
<span><span class="va">TPObject1</span> <span class="op">&lt;-</span> <span class="fu">makeTPO</span><span class="op">(</span>scores <span class="op">=</span> <span class="va">scores</span>,</span>
<span>                     loadings <span class="op">=</span> <span class="va">loadings</span>,</span>
<span>                     variance <span class="op">=</span> <span class="va">variance</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Making TriPlotObject (TPO)
--------------------------

Score matrix has 1000 observations and 5 components.

TPO has 0 attached correlations.
TPO has 0 attached risks.</code></pre>
</div>
</div>
</section><section id="step-2-3-exposure-omics-and-omics-outcome-associations" class="level2"><h2 class="anchored" data-anchor-id="step-2-3-exposure-omics-and-omics-outcome-associations">Step 2-3: Exposure-Omics and Omics-Outcome associations</h2>
<p>The associations between modules and food items and the associations between modules and risk markers can be then calculated, with confounders adjusted. Note that it is possible for users to skip code regarding exposure association or risk association, if their interests focus on only outcome associations or exposure associations with Omics variables.</p>
<p>The modules information saved in the TPObject can be directly utilized in the <code>exposureAssociation()</code> function. This function calculates exposure associations coefficients and p-values between the modules and exposures (food variables and diet scores), while adjusting for specified confounders.</p>
<div class="cell styled-output" data-fold.output="false">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Correlations_object</span> <span class="op">&lt;-</span> <span class="fu">exposureAssociation</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject1</span>,</span>
<span>                                exposure <span class="op">=</span> <span class="va">exposure2</span>,</span>
<span>                                use <span class="op">=</span> <span class="st">'pairwise'</span>, </span>
<span>                                <span class="co"># use inherit from cor() function </span></span>
<span>                                method <span class="op">=</span> <span class="st">'pearson'</span>,</span>
<span>                                <span class="co"># method inherit from cor() function </span></span>
<span>                                allowCategorical <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                <span class="co"># one-hot-encoding on categorical exposures</span></span>
<span>                                partial <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                <span class="co"># perform confonder adjustment</span></span>
<span>                                confounder <span class="op">=</span> <span class="va">covariates2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>
<p>The <code>exposureAssociation()</code> function offers options for handling categorical variables and adjusting for confounders. When setting <code>allowcategorical=FALSE</code>, categorical exposures with more than two classes undergo one-hot-encoding, transforming them into binary variables. This can be verified by examining <code>Correlations_object$cor_estimate</code>, which shows separate correlation coefficients for each binary representation of HFI levels. However, <code>allowcategorical=FALSE</code> is limited for meaningful use. The binary variables may be only meaningful when we want to compare one level to all the other levels together. We use this option for categorical variable <code>"HFI"</code> for demonstration purpose. Ideally, one should use <code>allowcategorical=TRUE</code> for HFI.</p>
<p>Conversely, <code>allowcategorical=TRUE</code> leaves categorical variables like <code>"HFI"</code> untransformed. In this case, linear models regressing modules on <code>"HFI"</code> are used for correlation analysis. The correlation coefficients are derived from the square root of the proportion of HFI’s sum of squares to the total sum of squares.</p>
</li>
<li><p>Setting <code>partial=TRUE</code> ensures that specified confounders are adjusted for in the correlation analysis.</p></li>
</ul>
</div>
</div>
<p>The correlation results obtained from the <code>exposureAssociation()</code> function are then incorporated into the TPObject.</p>
<div class="cell styled-output" data-fold.output="false">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPObject2</span> <span class="op">&lt;-</span> <span class="fu">addExposure</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject1</span>,</span>
<span>                     corrEstimate <span class="op">=</span> <span class="va">Correlations_object</span><span class="op">$</span><span class="va">cor_estimate</span>,</span>
<span>                     corrPvalue <span class="op">=</span> <span class="va">Correlations_object</span><span class="op">$</span><span class="va">cor_pvalue</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Adding correlation to TPO
-------------------------

TPO has 23 attached correlations.
TPO has 0 attached risks.</code></pre>
</div>
</div>
<p>The modules information saved in the TPObject can be directly utilized in the <code>outcomeAssociation()</code> function. This function calculates risk estimates and p-values between the modules and outcomes (BMI, type 2 diabetes and categorical BMI), while adjusting for specified confounders.</p>
<div class="cell styled-output" data-fold.output="false">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Risks_object</span> <span class="op">&lt;-</span> <span class="fu">outcomeAssociation</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject2</span>,</span>
<span>                                outcome <span class="op">=</span> <span class="va">outcome2</span>,</span>
<span>                                confounder <span class="op">=</span> <span class="va">covariates2</span>,</span>
<span>                                partial <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                <span class="co"># performs confounder adjustment</span></span>
<span>                                multinomial <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                <span class="co"># multinomial regression is used</span></span>
<span>                                pair <span class="op">=</span> <span class="va">auxiliary2</span><span class="op">$</span><span class="va">PairedInfo</span>,</span>
<span>                                <span class="co"># use the pairing information of case and control</span></span>
<span>                                CI <span class="op">=</span> <span class="fl">0.95</span></span>
<span>                                <span class="co"># confidence interval</span></span>
<span>                                <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>outcomeAssociation()</code> function offers various options for handling outcomes and adjusting for confounders, with behavior differing based on whether pair information is provided.</p>
<ul>
<li>Without <code>pair</code> information:
<ul>
<li>
<code>multinomial=FALSE</code> transforms categorical outcomes with &gt;2 classes into binary variables via one-hot-encoding. Logistic regression is used for binary outcomes, and linear regression for continuous outcomes.</li>
<li>
<code>multinomial=TRUE</code> applies multinomial regression to categorical outcomes with &gt;2 classes, yielding n-1 estimates. Binary and continuous outcomes are handled as before.</li>
</ul>
</li>
<li>With pair information:
<ul>
<li>
<code>multinomial=FALSE</code> transforms categorical outcomes as above, then uses conditional logistic regression for binary outcomes and linear mixed models for continuous outcomes, incorporating pairing information.</li>
<li>
<code>multinomial=TRUE</code> ignores pairing information, applying multinomial regression to categorical outcomes and standard logistic/linear regression to binary/continuous outcomes.</li>
</ul>
</li>
<li>Setting <code>partial=TRUE</code> ensures adjustment for specified confounders in all analyses.</li>
</ul>
</div>
</div>
<p>The results for risk estimates obtained from the <code>outcomeAssociation()</code> function are then incorporated into the TPObject.</p>
<div class="cell styled-output" data-fold.output="false">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPObject3</span> <span class="op">&lt;-</span> <span class="fu">addOutcome</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject2</span>, </span>
<span>                     Risk <span class="op">=</span> <span class="va">Risks_object</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Adding risk to TPO
------------------

TPO has 23 attached correlations.
TPO has 5 attached risks.</code></pre>
</div>
</div>
</section><section id="step-4-meet-in-the-middle-triplot-visualization" class="level2"><h2 class="anchored" data-anchor-id="step-4-meet-in-the-middle-triplot-visualization">Step 4: Meet-in-the-middle Triplot Visualization</h2>
<p>The TPObject created from all steps can be used to generate a Triplot using the <code>TriplotGUI()</code> function. The function serves as a wrapper for <code>PCA_TriplotGUI()</code> and <code>WGCNA_TriplotGUI()</code>. You can check the functions respectively here: <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/TriplotGUI.R?ref_type=heads" target="_blank"><code>TriplotGUI()</code></a>, <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCA_TriplotGUI.R?ref_type=heads" target="_blank"><code>PCA_TriplotGUI()</code></a>, <a href="https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/WGCNA_TriplotGUI.R?ref_type=heads" target="_blank"><code>WGCNA_TriplotGUI()</code></a>.</p>
<div class="cell styled-output" data-fold.output="false">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPO_plots3</span> <span class="op">&lt;-</span> <span class="fu">TriplotGUI</span><span class="op">(</span><span class="va">TPObject3</span>,</span>
<span>                              firstPC <span class="op">=</span> <span class="fl">1</span>, <span class="co">## The first PC to map</span></span>
<span>                              secondPC <span class="op">=</span> <span class="fl">2</span>, <span class="co">## The first PC to map</span></span>
<span>                              plotLoads <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">##Whether to plot loadings (TRUE; default) or suppress them (FALSE)</span></span>
<span>                              plotScores <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">##Whether to plot scores (TRUE) or suppress them (FALSE; default)</span></span>
<span>                              plotCorr <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">##Whether to plot correlations (TRUE; default) or suppress them (FALSE)</span></span>
<span>                              plotRisk <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span>                              <span class="co">###############################################</span></span>
<span>                              <span class="co">##For loadings</span></span>
<span>                              loadLabels <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co">###Whether to plot variable loading labels (TRUE; default) or not (FALSE)</span></span>
<span>                              loadArrowLength <span class="op">=</span> <span class="fl">0.02</span>, <span class="co">###Length of arrow tip , set it as 0 if you want to remove it</span></span>
<span>                              loadCut <span class="op">=</span> <span class="fl">0</span>, <span class="co">###lower limit Loadings below the cut are plotted in light grey and without label</span></span>
<span>                              loadLim <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##higher limit,Plot range for loadings</span></span>
<span>                              <span class="co">###############################################</span></span>
<span>                              <span class="co">##For correlations</span></span>
<span>                              colCorr <span class="op">=</span> <span class="st">"blue"</span>, <span class="co">##Color vector for correlations</span></span>
<span>                              pchCorr <span class="op">=</span> <span class="fl">16</span>, <span class="co">##Plotting character for correlations</span></span>
<span>                              whichCorr <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##Which correlations to plot (vector of numbers)</span></span>
<span>                              corLim <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##Plot range for correlations</span></span>
<span>                              corrLabels <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                              <span class="co">###############################################</span></span>
<span>                              <span class="co">##For risks</span></span>
<span>                              colRisk <span class="op">=</span> <span class="st">"red"</span>, <span class="co">##Color vector for risk estimates</span></span>
<span>                              pchRisk <span class="op">=</span> <span class="fl">15</span>, <span class="co">##Plotting character for risk estimates</span></span>
<span>                              whichRisk <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##Which risk estimates to plot (vector of numbers)</span></span>
<span>                              riskLim <span class="op">=</span> <span class="cn">NULL</span>, <span class="co">##Plot range for risks</span></span>
<span>                              riskWhiskerPercentage <span class="op">=</span> <span class="fl">0.1</span>, <span class="co">## whisker length is how many percentage of confidence interval</span></span>
<span>                              riskLabels <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">3</span>, <span class="co"># the size of points ont he plot</span></span>
<span>                              riskOR <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                              <span class="co"># plot the risk estimates as odds ratio</span></span>
<span>                              <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We then visualize the triplot.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPO_plots3</span><span class="op">$</span><span class="va">triplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_10-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>In the triplot visualization, black arrows represent loadings of Omics variables, forming patterns in different modules (axes). Blue circle points show exposure correlations with the modules, while red square points indicate outcome associations with the modules.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that we use first and second module for our example here. In reality, you may use the <code>checkTPO()</code> function in TriplotGUI to view which modules may be more of your interest (that are associated with specific exposures and outcomes).</p>
</div>
</div>
<p>Based on the triplot visualization of the TriplotGUI interface, we can interpret the following key points:</p>
<ul>
<li><p>The first (top right) and third (bottom left) dimension generally represents a spectrum of dietary healthiness. Healthier foods (e.g., <code>"Fruits"</code>, <code>"Vegetables"</code>) and higher healthy food indices (<code>"HFI"</code>, <code>"BSDS"</code>) are positioned on one side in the first dimension, while less healthy foods (e.g., <code>"Hamburger"</code>, <code>"Sausage"</code>, <code>"Margarine"</code>) are on the opposite side in the third dimension.</p></li>
<li><p>The second (top left) and fourth (bottom right) dimensions are associated with health outcomes, including the numeric outcome <code>"BMI"</code>, binary outcome <code>"T2D"</code>, and one-hot-encoded categorical <code>"BMI_cat"</code> outcome.</p></li>
<li>
<p>Explanation for some variables in the plot:</p>
<ul>
<li>
<code>"HFI"</code> stands for healthy food index. A higher <code>"HFI"</code> suggests healthier diet. <code>"HFI"</code> ranges from 0 to 6. You can see that there are <em>HFI_0</em>, <em>HFI_1</em>…<em>HFI_6</em> in the figure and that is because <code>"HFI"</code> is used as a factor exposure variable in exposure’s correlation and is one-hot-encoded to the same number of binary variables as its number of levels. For example, <em>HFI_6</em> is a binary variable where individuals with <code>"HFI"</code> as 6 (most healthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. <em>HFI_0</em> is a binary variable where individuals with <code>"HFI"</code> as 0 (most unhealthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. <em>HFI_1</em>…<em>HFI_5</em> has limited use since it only separates the group of people with certain <code>"HFI"</code> value from to the rest, which is a mixture of people with healthier and less healthier diet.</li>
<li>
<code>"BSDS"</code> stands for Baltic Sea Diet Score ranging. A higher <code>"BSDS"</code> suggests healthier diet. <code>"BSDS"</code> is used as a numeric variable ranging from 2 to 25 in the correlation.</li>
<li>
<em>BMI_cat_obese</em>, <em>BMI_cat_overweight</em>, <em>BMI_cat_underweight</em> are the odds ratio generated from the multinomial regression, since <code>"BMI_cat"</code> is a categorical outcome and multinomial regression is performed in outcome’s association in this example. Normal weight is uses as a reference and odds ratio of obese, overweight and underweight is produced. (Note that the first level of the factor variable is set as the default reference, in this case it is <em>normal</em>).</li>
</ul>
</li>
<li><p>Adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code>, the first module (on x-axis) correlates positively with generally healthy food (e.g.&nbsp;<code>"fruits"</code>, <code>"vegatables"</code>) and food index (e.g.&nbsp;<code>"BSDS"</code>) and negatively with unhealthy food (e.g.&nbsp;<code>"Hamburger"</code>, <code>"pizza"</code>). It also reversely associated with <code>"T2D"</code> and <code>"BMI"</code>. From the result from <code>"BMI_cat"</code>, this components also reversely associated with being obese.</p></li>
<li><p>Adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code>, the second module (on y-axis) associated positively with generally healthy food (e.g.&nbsp;<code>"fruits"</code>, <code>"vegatables"</code>) and food index (e.g.&nbsp;<code>"BSDS"</code>) and negatively with unhealthy food (e.g.&nbsp;<code>"Hamburger"</code>, <code>"pizza"</code>). However, the module correlates also positively with <code>"T2D"</code>,<code>"BMI"</code>, <em>obese</em>, <em>overweight</em> and negatively associated with <em>underweight</em>.</p></li>
</ul>
<p>Based on what we summarized above, the two modules may be associated with a overall healthy eating pattern. And in this healthy eating pattern, the first module is associated more with the beneficial effect on health and the second module represents the adverse health effect.</p>
</section><section id="step-5-mediation-analysis-and-visualization" class="level2"><h2 class="anchored" data-anchor-id="step-5-mediation-analysis-and-visualization">Step 5: Mediation analysis and visualization</h2>
<p>In mediation analysis in TriplotGUI, we focus on a specific set of variables for mediation analysis: we select <code>"BSDS"</code> (Baltic Sea Diet Score) and <code>"Hamburger"</code> as our exposures, <code>"BMI"</code> and <code>"T2D"</code> as outcome to enter our next step. We choose first and second modules as our mediators.</p>
<p>This time, we perform the mediation analysis with the <code>getMediationCounterfactual()</code> function, using the counterfactual/potential outcome method implemented through the <code>mediation</code> package in R on our exposures (i.e.&nbsp;<code>"BSDS"</code>, <code>"Hamburger"</code>), mediators (i.e.&nbsp;the first and second modules) and outcome (i.e.&nbsp;<code>"T2D"</code>, <code>"BMI"</code>) of interest, adjusting for <code>"Age"</code>, <code>"Gender"</code>, <code>"Smoking"</code>, <code>"Education"</code> and <code>"FastingGlucose"</code> for both exposure-mediator and mediator-outcome relationship.</p>
<div class="cell styled-output" data-fold.output="false">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mediation_object3</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">getMediationCounterfactual</span> <span class="op">(</span>mediator <span class="op">=</span> <span class="va">TPObject3</span><span class="op">$</span><span class="va">scores</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, </span>
<span>                             <span class="co"># Specfiying at least 2 components so that there can be a 2-dimensional plot</span></span>
<span>                               exposure<span class="op">=</span><span class="va">exposure2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hamburger"</span>,<span class="st">"BSDS"</span><span class="op">)</span>,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>                             outcome <span class="op">=</span> <span class="va">outcome2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"BMI"</span>,<span class="st">"T2D"</span><span class="op">)</span>,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>                             exposureTreatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">19</span><span class="op">)</span>,</span>
<span>                             exposureControl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                             confounderME <span class="op">=</span> <span class="va">covariates2</span>,</span>
<span>                             confounderOE <span class="op">=</span> <span class="va">covariates2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the counterfactual mediation analysis, contrast values of treatment and controls for each exposure needs to be specified. For each individual, the analysis considers what would happen if they received the treatment versus if they received the control. In brief, the algorithm uses these contrast values to calculate the potential outcomes under each scenario to estimate the direct and indirect effects. For a detailed explanation please refer to <a href="https://www.jstatsoft.org/article/view/v059i05" target="_blank">this paper</a> of the <code>mediation</code> R package.</p>
<p>If an exposure variable is continuous (numeric variable), it is recommended that the treatment and control contrast values are chosen between the range of the exposure variable. If an exposure variable is categorical (factor variable), the treatment and control contrast values should be chosen from the levels of the exposure variable.</p>
</div>
</div>
<p>Then we can also Look at the barplot for mediations, which provides a clear visual representation of the direct, indirect, and total effects for each combination of exposure, mediator (principal component), and outcome. This visualization allows for a more intuitive understanding of the mediation analysis results.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mediation_plots3</span> <span class="op">&lt;-</span> <span class="fu">mediationBarplot</span><span class="op">(</span>mediationObject <span class="op">=</span> <span class="va">mediation_object3</span>,</span>
<span>                                         cex <span class="op">=</span> <span class="fl">2</span><span class="co">#,</span></span>
<span>                                         <span class="co"># size of the text</span></span>
<span>                                         <span class="co">#by_row = "one_column"</span></span>
<span>                                         <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mediation_plots3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_11-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The barplot displays direct, indirect, and total effects for each exposure-mediator-outcome combination, offering a convenient tool to assess the direction and magnitude of mediation estimates.</p>
<ul>
<li>Color coding enhances interpretation: red indicates significant positive effects (p&lt;0.05), cyan shows significant negative effects (p&lt;0.05), and grey represents insignificant effects.</li>
<li>Significance levels are denoted by stars: one star for p&lt;0.05, two stars for p&lt;0.01, and three stars for p&lt;0.001.</li>
</ul>
</div>
</div>
<p>We will make an example interpretation of the mediation barplot using BSDS as exposure, turquoise module as mediator (the module on the x axis in the triplot in step 4) and BMI as outcome.</p>
<p>In the shown mediation barplot, we can observe the direction and magnitude of the indirect effect and proportion mediated. We observed that with all effects significant, indirect effect is negative, direct and total effect is positive. The negative indirect effect is consistent with the its visualization in the triplot, i.e, the turquiose module on the x axis associative with BSDS positively and with BMI negatively.</p>
<p>However, the figure also shows that BSDS is positively associated with BMI through a larger direct effect. This seems counterintuitive but this could be due to a true direct effect or indirect effect mediated by other modules.</p>
<p>Based on the mediation barplot, we’ve also observed significant proportion mediated with for BSDS-turquiose module-BMI mediations, suggesting a robust mediation effect.</p>
<!-- To visualize the adjusted proportion mediated (APM) and add layers of correlation and risk estimates, use the following settings. -->
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<!-- By observing this figure, we can see the direction and magnitude of adjusted proportion mediated (APM) for the two mediators across all exposures and outcomes. The positioning of the points is similar to what we observed for the proportion mediated (PM). -->
<ul>
<li>Notably, the APM for BSDS (Baltic Sea Diet Score) as the exposure and T2D (Type 2 Diabetes) as the outcome is smaller than their corresponding PM (considering the abosolute value). This difference occurs because the indirect and direct effects for this mediation pathway are in opposite directions. This opposition leads to a smaller total effect and consequently a larger PM (considering the abosolute value). However, the APM is not affected by the directionality of the direct and indirect effects, providing a more stable measure of mediation.</li>
</ul>
<!-- -   No confidence intervals are shown for APM. This is because APM values cannot be directly calculated from the mediation analysis in the `mediation` R package, unlike the proportion mediated (PM). --><ul>
<li>The APM is always smaller than 1, even when direct and indirect effects are in opposite directions. This is due to the calculation method of APM, which uses the sum of the absolute values of indirect and direct effects as the denominator. <span class="math display">\[APM=\frac{IE}{|IE|+|DE|}\cdot\frac{|IE+DE|}{IE+DE}=\frac{IE}{IE+DE}\cdot\frac{|IE+DE|}{|IE|+|DE|}=\frac{IE}{|IE|+|DE|}\cdot\frac{IE+DE}{|IE+DE|}\]</span>
</li>
</ul>
</div>
</div>
<p>To further explore the indirect, direct, and total effects of different combinations of mediations, you can run more mediation analysis at Step 5 in the TriplotGUI interface .</p>
<p>Add the mediation result from <code>getMediationCounterfactual()</code> into the TPObject.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">TPObject4</span> <span class="op">&lt;-</span> <span class="fu">addMediation</span><span class="op">(</span>TPObject <span class="op">=</span> <span class="va">TPObject3</span>, </span>
<span>                          mediationObject <span class="op">=</span> <span class="va">mediation_object3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Adding mediation to TPO
-------------------------

TPO mediation has used 2 mediators, 2 exposures, 2 outcomes
Mediators are turquoise, blue 
Exposures are Hamburger, BSDS 
Outcomes are BMI, T2D</code></pre>
</div>
</div>
<!-- To create the triplot with mediation, use the provided function with its default arguments. This will generate a visualization that incorporates the mediation analysis results into the triplot framework. You can adjust these arguments as needed to customize the appearance and content of the triplot. -->
<!-- ```{r showcode_runcode_noshowoutput_8} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: false -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- TPO_plots4 <- -->
<!--   mediationTriplot( -->
<!--     TPObject4, -->
<!--     show = c("APM","PM"), -->
<!--     ##Which mediation estimate to show -->
<!--     firstPC = 1, -->
<!--     ##The first PC to map -->
<!--     secondPC = 2, -->
<!--     ##The second PC to map -->
<!--     plotMed = TRUE, -->
<!--     ##Whether to plot mediation estimates (TRUE; default) or suppress them (FALSE) -->
<!--     plotCorr = TRUE, -->
<!--     ##Whether to plot correlations (TRUE; default) or suppress them (FALSE) -->
<!--     plotRisk = TRUE, -->
<!--     ##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE) -->
<!--     ############################################### -->
<!--     ##For correlations -->
<!--     colCorr = "blue", -->
<!--     ##Color vector for correlations -->
<!--     pchCorr = 16, -->
<!--     ##Plotting character for correlations -->
<!--     corrLim = NULL, -->
<!--     ##Plot range for correlations -->
<!--     corrLabels = TRUE, -->
<!--     ##Add labels on exposures -->
<!--     ############################################### -->
<!--     ##For risks -->
<!--     colRisk = "red", -->
<!--     ##Color vector for risk estimates -->
<!--     pchRisk = 15, -->
<!--     ##Plotting character for risk estimates -->
<!--     riskLim = NULL, -->
<!--     ##Plot range for risks -->
<!--     whiskerPercentageRisk = 0.1, -->
<!--     ##whisker length is how many percentage of confidence interval -->
<!--     riskLabels = TRUE, -->
<!--     ##Add labels on outcomes -->
<!--     riskOR = TRUE, -->
<!--     #plot the risk estimates as odds ratio -->
<!--     ############################################### -->
<!--     ##For mediations -->
<!--     colmed = "darkgreen", -->
<!--     ##Color vector for mediation estimates -->
<!--     pchmed = 17, -->
<!--     ##Plotting character for mediation estimates -->
<!--     medLim = NULL, -->
<!--     ##Plot range for mediations -->
<!--     whiskerPercentageMediation= 0.1, -->
<!--     ##whisker length is how many percentage of confidence interval -->
<!--     medLabels = TRUE, -->
<!--     ##Add labels on mediation estimates -->
<!--     ######################################### -->
<!--     size = 3 -->
<!--     # the size of points ont he plot -->
<!--   ) -->
<!-- ``` -->
<!-- Only showing the mediation results. -->
<!-- ```{r showcode_runcode_showoutput_13} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: true -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- #| out-width: "100%" -->
<!-- TPO_plots4$mediations_plot -->
<!-- ``` -->
<!-- The `mediationTriplot()` function displays only the proportion mediated (PM) and adjusted proportion mediated (APM) as dark green triangle points due to the specified `show = c("PM", "APM")` argument. -->
<!-- To reduce visual clutter, you can separate these by running the function twice: once with `show = c("PM")` and once with `show = c("APM")`.  -->
<!-- ```{r showcode_runcode_noshowoutput_8A} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: false -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- TPO_plots4 <- -->
<!--   mediationTriplot( -->
<!--     TPObject4, -->
<!--     show = c("PM") -->
<!--   ) -->
<!-- ``` -->
<!-- ```{r showcode_runcode_showoutput_13B} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: true -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- #| out-width: "100%" -->
<!-- TPO_plots4$mediations_plot -->
<!-- ``` -->
<!-- Four green triangles are displayed on the figure. Their x and y coordiates represent the eight combinations of exposures, mediators and outcomes. -->
<!-- -   exposure=BSDS, mediator= module 1, outcome=BMI -->
<!-- -   exposure=BSDS, mediator= module 2, outcome=BMI -->
<!-- -   exposure=Hamburger, mediator= module 1, outcome=BMI -->
<!-- -   exposure=Hamburger, mediator= module 2, outcome=BMI -->
<!-- -   exposure=BSDS, mediator= module 1, outcome=T2D -->
<!-- -   exposure=BSDS, mediator= module 2, outcome=T2D -->
<!-- -   exposure=Hamburger, mediator= module 1, outcome=T2D -->
<!-- -   exposure=Hamburger, mediator= module 2, outcome=T2D -->
<!-- We can see from the confidence intervals that some PM values are not significant, with large intervals pushing triangle points towards the origin. To better examine these points and their dimensions, we zoom in by adjusting the limit of the proportion mediated. Setting `"medLim = 2.5"` restricts the plot's range from -2.5 to 2.5, allowing for a closer inspection of the points and their relationships within this more focused area -->
<!-- ```{r showcode_runcode_noshowoutput_8B} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: false -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- TPO_plots4 <- -->
<!--   mediationTriplot( -->
<!--     TPObject4, -->
<!--     show = c("PM"), -->
<!--     medLim = 2.5 -->
<!--   ) -->
<!-- ``` -->
<!-- ```{r showcode_runcode_showoutput_13D} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: true -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- #| out-width: "100%" -->
<!-- TPO_plots4$mediations_plot -->
<!-- ``` -->
<!-- ::: callout-note -->
<!-- -   Confidence intervals are automatically removed from the figure if they fall outside the set limits.  -->
<!-- -   In certain mediations, the direct and indirect effects may have opposite directions. This can result in a proportion mediated (PM) greater than 1. This occurs because the total effect might be smaller than the indirect effect. -->
<!-- ::: -->
<!-- Based on the figure showing the mediation analysis results, we can observe the direction and magnitude of proportion mediated for the 2 mediators (module 1 and 2), all the exposures and outcomes. Based on the confidence interval, we also observed that the PM for BSDS-module 1-BMI and BSDS-module 2-BMI mediation is significant. -->
<!-- To further examine the mediation results, we look at the adjusted proportion mediated (APM): -->
<!-- ```{r showcode_runcode_noshowoutput_8C} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: false -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- TPO_plots4 <- -->
<!--   mediationTriplot( -->
<!--     TPObject4, -->
<!--     show = c("APM") -->
<!--   ) -->
<!-- ``` -->
<!-- ```{r showcode_runcode_showoutput_13F} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: true -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- #| out-width: "100%" -->
<!-- TPO_plots4$mediations_plot -->
<!-- ``` -->
<!-- By observing this figure, we can see the direction and magnitude of adjusted proportion mediated (APM) for the two mediators across all exposures and outcomes. The positioning of the points is similar to what we observed for the proportion mediated (PM). -->
<!-- Notably, the APM for BSDS (Baltic Sea Diet Score) as the exposure and T2D (Type 2 Diabetes) as the outcome is smaller than their corresponding PM. This difference occurs because the indirect and direct effects for this mediation pathway are of similar size but in opposite directions. This opposition leads to a smaller total effect and consequently a larger PM. However, the APM is not affected by the directionality of the direct and indirect effects, providing a more stable measure of mediation. -->
<!-- ::: callout-note -->
<!-- -   No confidence intervals are shown for APM. This is because APM values cannot be directly calculated from the mediation analysis in the `mediation` R package, unlike the proportion mediated (PM). -->
<!-- -   The APM is always smaller than 1, even when direct and indirect effects are in opposite directions. This is due to the calculation method of APM, which uses the sum of the absolute values of indirect and direct effects as the denominator. $$APM=\frac{IE}{|IE|+|DE|}\cdot\frac{|IE+DE|}{IE+DE}=\frac{IE}{IE+DE}\cdot\frac{|IE+DE|}{|IE|+|DE|}=\frac{IE}{|IE|+|DE|}\cdot\frac{IE+DE}{|IE+DE|}$$ -->
<!-- ::: -->
<!-- ::: callout-note -->
<!-- Specifying `show = c("PM", "APM", "IE", "TE")` in the `mediationTriplot()` function would display all estimates, including indirect effect (IE) and total effect (TE). However, this is not recommended as it can overcrowd the plot, making it difficult to interpret.  -->
<!-- For a clearer visualization, it's better to view IE and TE separately. The [Tutorial(simple)](simple_code.qmd){target="_blank"} section provides examples of plots showing `"IE"` and `"TE"`, offering a more manageable and interpretable view of these mediation components. -->
<!-- ::: -->
<!-- Plot the triplot with mediation, -->
<!-- ```{r showcode_runcode_showoutput_14} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: true -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- #| out-width: "100%" -->
<!-- TPO_plots4$mediations_triplot -->
<!-- ``` -->
<!-- Based on the barplot and the triplot with mediation, we’ve observed significant proportion mediated for BSDS-module 1/2-BMI mediations. Further exploration on indirect, direct and total effect of the mediation analysis could be explored by playing around the `show` argument in the `mediationTriplot()` function. We will not go into details here. -->
</section><section id="comparative-visualization" class="level2"><h2 class="anchored" data-anchor-id="comparative-visualization">Comparative Visualization</h2>
<p>The <code>checkTPO()</code> function in TriplotGUI allows users to generate heatmaps from the TPObject to visualize correlations, risk estimations, and mediation results.</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span> <span class="op">&lt;-</span> <span class="fu">checkTPO</span><span class="op">(</span><span class="va">TPObject4</span>,</span>
<span>                                  mediatorEstimates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IE"</span>,<span class="st">"TE"</span>,<span class="st">"PM"</span>,<span class="st">"APM"</span><span class="op">)</span>,</span>
<span>                                  <span class="co">## What type of mediation estimate or proportion mediated to show on the heatmap</span></span>
<span>                                  mediators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"turquoise"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>                                  <span class="co">## What mediators (principal component) you want to show</span></span>
<span>                                  exposures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Hamburger"</span>,<span class="st">"BSDS"</span><span class="op">)</span>,</span>
<span>                                  <span class="co">## What exposure variables you want to show</span></span>
<span>                                  outcomes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"T2D"</span>,<span class="st">"BMI"</span><span class="op">)</span></span>
<span>                                  <span class="co">## What outcome variables you want to show</span></span>
<span>                                  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Correlation coefficients and p values between modules and exposures:</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span><span class="op">$</span><span class="va">corr_coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_15A-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_15A-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>Risk estimates(beta coefficients) and p values between modules and outcomes:</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span><span class="op">$</span><span class="va">risk_coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_15B-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_15B-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<p>Mediation estimates and p values for indirect effect(IE) and total effect(TE), proportion mediated(PM) and adjusted proportion mediated(APM): Read <a href="./workflow.html" target="_blank">Manual</a> for more details:</p>
<div class="cell styled-output" data-fold.plot="true">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">checkTPObject4</span><span class="op">$</span><span class="va">med_coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><details><summary>
plot
</summary><div class="cell-output-display">
<div>
<figure class="figure"><p><a href="complex_code_files/figure-html/showcode_runcode_showoutput_15C-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="complex_code_files/figure-html/showcode_runcode_showoutput_15C-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</details>
</div>
<!-- You could also View the three plots aboved combinedly. -->
<!-- ```{r showcode_runcode_showoutput_15D} -->
<!-- #| eval: true -->
<!-- #| echo: true -->
<!-- #| output: true -->
<!-- #| classes: styled-output -->
<!-- #| fold.plot: true -->
<!-- #| out-width: "100%" -->
<!-- checkTPObject4$corr_risk_med_coefficients -->
<!-- ``` -->
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Significance is indicated as follows. One star for p&lt;0.05; Two stars for p&lt;0.01; Three stars for p&lt;0.001.</li>
<li>The first two plots, correlation coefficients with exposures and risk estimates of outcomes will show all the exposure and outcome variables that are not removed from visualization.</li>
<li>Note that in the plot of <code>checkTPbject4$med_coefficients</code>, nly the selected exposures, mediators and outcomes that we use to do mediation on will show up in the mediation results. The rows in the heatmaps are mediators and the column represents exposure-outcome pairs. For each exposure-outcome pair, 4 results are shown: <em>IE</em> (indirect effect), <em>TE</em> (total effect), <em>PM</em>(Proportion Mediated) and <em>APM</em>(Adjusted Proportion Mediated). Please read <a href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/workflow.html#5.2" target="_blank">Manual</a> for more information. The “CF” before the names of exposures-outcome pairs means that this mediation is using the Counterfactual method.</li>
</ul>
</div>
</div>
</section><section id="data-download" class="level2"><h2 class="anchored" data-anchor-id="data-download">Data download</h2>
<p>To save all your output, including data, results, and visualization output as an .rda file, you can use the <code><a href="https://rdrr.io/r/base/save.html">save()</a></code> function as an rda file.</p>
<div class="cell styled-output">
<details open="" class="code-fold"><summary>Show the code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">exposure2</span>,<span class="va">Omics2</span>,<span class="va">outcome2</span>,<span class="va">covariates2</span>,<span class="va">auxilariy2</span>,</span>
<span>     <span class="va">reduced_Omics2</span>,<span class="va">Correlations_object</span>,<span class="va">Risks_object</span>,</span>
<span>     <span class="va">mediation_object3</span>,<span class="va">mediation_plots3</span>,</span>
<span>     <span class="va">TPObject1</span>,<span class="va">TPObject2</span>,<span class="va">TPObject3</span>,<span class="va">TPObject4</span>,</span>
<span>     <span class="va">checkTPObject4</span>,</span>
<span>     <span class="st">"Tutorial_complex_output.rda"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>0</p>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/yingxiaoyan\.gitlab\.io\/triplotgui_tutorial\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb49" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Tutorial(complex) - Code"</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co">   - lightbox</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="an">lightbox:</span><span class="co"> auto</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Complex demo of using TriplotGUI's code"</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner:</span><span class="co"> true</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-banner-color:</span><span class="co"> white</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="an">title-block-categories:</span><span class="co"> false</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="an">page-layout:</span><span class="co"> full</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="co">    margin-top: 0em</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co">    margin-bottom: 0em</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co">    padding-top: 0em</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co">    padding-bottom: 0em</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co">    minimal: true</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="co">    smooth-scroll: true</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-responsive: true</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: right</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 5</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: Tutorial</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="co">    #number-sections: true  ## add number in the session or not</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co">    #number-depth: 4</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show the code"</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight: tango</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged  ## kable is another option How the dataframe looks like </span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="co">    standalone: false  ### specifies if all assets and libraries must be integrated into the output html file as a standalone document.</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-align: right</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="co">    theme:  solar</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a><span class="an">geometry:</span><span class="co"> margin=lin  </span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="in">##This is a function that combines html and rmarkdown. It aims to generate a button that could hide output or plot (fold.output=TRUE or fold.plot=TRUE).</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="in">hooks = knitr::knit_hooks$get()</span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a><span class="in">hook_foldable = function(type) {</span></span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a><span class="in">  force(type)</span></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a><span class="in">  function(x, options) {</span></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a><span class="in">    res = hooks[[type]](x, options)</span></span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="in">    if (!isTRUE(options[[paste0("fold.", type)]])) return(res)</span></span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0(</span></span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a><span class="in">      "&lt;details&gt;&lt;summary&gt;", type, "&lt;/summary&gt;\n\n",</span></span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a><span class="in">      res,</span></span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a><span class="in">      "\n\n&lt;/details&gt;"</span></span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::knit_hooks$set(</span></span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a><span class="in">  output = hook_foldable("output"),</span></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a><span class="in">  plot = hook_foldable("plot")</span></span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-62"><a href="#cb49-62" aria-hidden="true" tabindex="-1"></a>The code at this page can be downloaded <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/Tutorial_code/HealthyNordicDiet_2_applying_TriplotGUI_code.R)</span>{target="_blank"}</span>
<span id="cb49-63"><a href="#cb49-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-64"><a href="#cb49-64" aria-hidden="true" tabindex="-1"></a>Before starting, please ensure you have installed the TriplotGUI package following the <span class="co">[</span><span class="ot">Setup</span><span class="co">](installation.qmd)</span>{target="_blank" style="color:blue"} instructions.</span>
<span id="cb49-65"><a href="#cb49-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-66"><a href="#cb49-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-67"><a href="#cb49-67" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data description</span></span>
<span id="cb49-68"><a href="#cb49-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-69"><a href="#cb49-69" aria-hidden="true" tabindex="-1"></a>The data used in this tutorial section can be downloaded <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/data/HealthyNordicDiet_2.rda)</span>{target="_blank"} in rda format.</span>
<span id="cb49-70"><a href="#cb49-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-71"><a href="#cb49-71" aria-hidden="true" tabindex="-1"></a>This example utilizes ***HealthyNordicDiet_2***, which is a modified version of the **HealthyNordicDiet** data provided by the [*Triplot*](https://gitlab.com/CarlBrunius/triplot/-/blob/master/vignettes/Triplot_Tutorial.md?ref_type=heads){target="_blank"} package (Schillemans et al. 2019). The **HealthyNordicDiet** is a synthetic dataset that simulates data from a case-control study within the Swedish Västerbotten Intervention Programme cohort, exploring plasma metabolites reflecting healthy Nordic dietary patterns and their association with type 2 diabetes development (Shi et al. 2018). The simulated ***HealthyNordicDiet_2*** data consists of three data frames:</span>
<span id="cb49-72"><a href="#cb49-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-73"><a href="#cb49-73" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Clinical measurements (ClinData): Contains 11 variables: <span class="in">`"ID"`</span>,<span class="in">`"T2D"`</span>(Cases and controls for type 2 diabetes), <span class="in">`"PairedInfo"`</span>(Pairing/matching information for case and controls, a unique number is assigned to each case-control pairs),<span class="in">`"Energy"`</span>,<span class="in">`"Gender"`</span>,<span class="in">`"Age"`</span>,<span class="in">`"BMI"`</span>,<span class="in">`"Smoking"`</span>,<span class="in">`"PhysicalActivityIndex"`</span>,<span class="in">`"Education"`</span>,<span class="in">`"FastingGlucose"`</span>.\</span>
<span id="cb49-74"><a href="#cb49-74" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Plasma metabolites predictive of BMI (MetaboliteData): Comprises 20 variables</span>
<span id="cb49-75"><a href="#cb49-75" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Dietary intake as measured by food frequency questionnaires (FoodData): Includes 11 variables: <span class="in">`"HFI"`</span>(Healthy Food Index),<span class="in">`"BSDS"`</span>(the Baltic Sea Diet Score),<span class="in">`"Wholegrains"`</span>,<span class="in">`"Sausage"`</span>,<span class="in">`"Pizza"`</span>,<span class="in">`"Refined.bread"`</span>, <span class="in">`"Fruits"`</span>,<span class="in">`"Liquor"`</span>,<span class="in">`"Wine"`</span>,<span class="in">`"Hamburger"`</span>,<span class="in">`"Poultry"`</span>,<span class="in">`"Fish"`</span>,<span class="in">`"Margarine"`</span>,<span class="in">`"Cabbage"`</span>,<span class="in">`"Carrot"`</span>,<span class="in">`"low_fat_Dairy"`</span>,<span class="in">`"Vegetables"`</span></span>
<span id="cb49-76"><a href="#cb49-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-77"><a href="#cb49-77" aria-hidden="true" tabindex="-1"></a>The data frames are row-wise matched by observations and consist of 1000 synthetic observations.</span>
<span id="cb49-78"><a href="#cb49-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-79"><a href="#cb49-79" aria-hidden="true" tabindex="-1"></a>**Reference**</span>
<span id="cb49-80"><a href="#cb49-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-81"><a href="#cb49-81" aria-hidden="true" tabindex="-1"></a>Shi, L., Brunius, C., Johansson, I., Bergdahl, I. A., Lindahl, B., Hanhineva, K., &amp; Landberg, R. (2018). Plasma metabolites associated with healthy Nordic dietary indexes and risk of type 2 diabetes—a nested case-control study in a Swedish population. *The American Journal of Clinical Nutrition*, 108(3), 564-575. <span class="co">[</span><span class="ot">10.1093/ajcn/nqy145</span><span class="co">](https://www.sciencedirect.com/science/article/pii/S0002916522029628?via%3Dihub)</span>{target="_blank"}</span>
<span id="cb49-82"><a href="#cb49-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-83"><a href="#cb49-83" aria-hidden="true" tabindex="-1"></a>Schillemans T, Shi L, Liu X, Åkesson A, Landberg R, Brunius C. Visualization and Interpretation of Multivariate Associations with Disease Risk Markers and Disease Risk-The Triplot. *Metabolites*. 2019 Jul 6;9(7):133. <span class="co">[</span><span class="ot">doi: 10.3390/metabo9070133</span><span class="co">](https://www.mdpi.com/2218-1989/9/7/133)</span>{target="_blank"}</span>
<span id="cb49-84"><a href="#cb49-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-85"><a href="#cb49-85" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research question</span></span>
<span id="cb49-86"><a href="#cb49-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-87"><a href="#cb49-87" aria-hidden="true" tabindex="-1"></a>We want to assess the relationship between diet, metabolic profiles and Type 2 diabetes and BMI. We assume that metabolites serves as mediators, mediating the effect of dietary exposures on Type 2 diabetes and BMI.</span>
<span id="cb49-88"><a href="#cb49-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-89"><a href="#cb49-89" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data exploration</span></span>
<span id="cb49-90"><a href="#cb49-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-91"><a href="#cb49-91" aria-hidden="true" tabindex="-1"></a>***HealthyNordicDiet_2*** is loaded in the R environment upon running <span class="in">`library(TriplotGUI)`</span>. Let's begin with some data exploration to understand the structure and contents of the dataset:</span>
<span id="cb49-92"><a href="#cb49-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-93"><a href="#cb49-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r noshowcode_runcode_noshowoutput_1}</span></span>
<span id="cb49-94"><a href="#cb49-94" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-95"><a href="#cb49-95" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb49-96"><a href="#cb49-96" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-97"><a href="#cb49-97" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-98"><a href="#cb49-98" aria-hidden="true" tabindex="-1"></a><span class="in">library(TriplotGUI)</span></span>
<span id="cb49-99"><a href="#cb49-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-100"><a href="#cb49-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-101"><a href="#cb49-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-102"><a href="#cb49-102" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check HealthyNordicDiet_2</span></span>
<span id="cb49-103"><a href="#cb49-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-104"><a href="#cb49-104" aria-hidden="true" tabindex="-1"></a>Check the ***HealthyNordicDiet_2*** list:</span>
<span id="cb49-105"><a href="#cb49-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-106"><a href="#cb49-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_1}</span></span>
<span id="cb49-107"><a href="#cb49-107" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-108"><a href="#cb49-108" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-109"><a href="#cb49-109" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-110"><a href="#cb49-110" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-111"><a href="#cb49-111" aria-hidden="true" tabindex="-1"></a><span class="in">class(HealthyNordicDiet_2)</span></span>
<span id="cb49-112"><a href="#cb49-112" aria-hidden="true" tabindex="-1"></a><span class="in">names(HealthyNordicDiet_2)</span></span>
<span id="cb49-113"><a href="#cb49-113" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-114"><a href="#cb49-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-115"><a href="#cb49-115" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check datasets</span></span>
<span id="cb49-116"><a href="#cb49-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-117"><a href="#cb49-117" aria-hidden="true" tabindex="-1"></a>Check the names of variables in each data:</span>
<span id="cb49-118"><a href="#cb49-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-119"><a href="#cb49-119" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_2}</span></span>
<span id="cb49-120"><a href="#cb49-120" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-121"><a href="#cb49-121" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-122"><a href="#cb49-122" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-123"><a href="#cb49-123" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-124"><a href="#cb49-124" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(HealthyNordicDiet_2$ClinData)  </span></span>
<span id="cb49-125"><a href="#cb49-125" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(HealthyNordicDiet_2$MetaboliteData)</span></span>
<span id="cb49-126"><a href="#cb49-126" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(HealthyNordicDiet_2$FoodData)</span></span>
<span id="cb49-127"><a href="#cb49-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-128"><a href="#cb49-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-129"><a href="#cb49-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check variables' class</span></span>
<span id="cb49-130"><a href="#cb49-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-131"><a href="#cb49-131" aria-hidden="true" tabindex="-1"></a>We then transform the data to dataframe format and use TriplotGUI's <span class="in">`checkdata()`</span> function to examine the classes of variables.</span>
<span id="cb49-132"><a href="#cb49-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-133"><a href="#cb49-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_1}</span></span>
<span id="cb49-134"><a href="#cb49-134" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-135"><a href="#cb49-135" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-136"><a href="#cb49-136" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-137"><a href="#cb49-137" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-138"><a href="#cb49-138" aria-hidden="true" tabindex="-1"></a><span class="in">ClinData &lt;- as.data.frame(HealthyNordicDiet_2$ClinData)</span></span>
<span id="cb49-139"><a href="#cb49-139" aria-hidden="true" tabindex="-1"></a><span class="in">MetaboliteData &lt;- as.data.frame(HealthyNordicDiet_2$MetaboliteData)</span></span>
<span id="cb49-140"><a href="#cb49-140" aria-hidden="true" tabindex="-1"></a><span class="in">FoodData &lt;- as.data.frame(HealthyNordicDiet_2$FoodData)</span></span>
<span id="cb49-141"><a href="#cb49-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-142"><a href="#cb49-142" aria-hidden="true" tabindex="-1"></a><span class="in">ClinData_check &lt;- checkdata(ClinData)</span></span>
<span id="cb49-143"><a href="#cb49-143" aria-hidden="true" tabindex="-1"></a><span class="in">MetaboliteData_check &lt;- checkdata(MetaboliteData)</span></span>
<span id="cb49-144"><a href="#cb49-144" aria-hidden="true" tabindex="-1"></a><span class="in">FoodData_check &lt;- checkdata(FoodData)</span></span>
<span id="cb49-145"><a href="#cb49-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-146"><a href="#cb49-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-147"><a href="#cb49-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_3}</span></span>
<span id="cb49-148"><a href="#cb49-148" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-149"><a href="#cb49-149" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-150"><a href="#cb49-150" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-151"><a href="#cb49-151" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-152"><a href="#cb49-152" aria-hidden="true" tabindex="-1"></a><span class="in">ClinData_check$class_summary_statistics</span></span>
<span id="cb49-153"><a href="#cb49-153" aria-hidden="true" tabindex="-1"></a><span class="in">MetaboliteData_check$class_summary_statistics</span></span>
<span id="cb49-154"><a href="#cb49-154" aria-hidden="true" tabindex="-1"></a><span class="in">FoodData_check$class_summary_statistics</span></span>
<span id="cb49-155"><a href="#cb49-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-156"><a href="#cb49-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-157"><a href="#cb49-157" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-158"><a href="#cb49-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-159"><a href="#cb49-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-160"><a href="#cb49-160" aria-hidden="true" tabindex="-1"></a>Note that in the given data, <span class="in">`"HFI"`</span>(Healthy Food Index) is a factor variable and <span class="in">`"BSDS"`</span>(the Baltic Sea Diet Score) is a numeric variable. You could use <span class="in">`table(FoodData$HFI)`</span> and <span class="in">`table(FoodData$BSDS)`</span> to check the difference.</span>
<span id="cb49-161"><a href="#cb49-161" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-162"><a href="#cb49-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-163"><a href="#cb49-163" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check sanities for variables</span></span>
<span id="cb49-164"><a href="#cb49-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-165"><a href="#cb49-165" aria-hidden="true" tabindex="-1"></a>To check for missing (NA) or abnormal values (e.g., NaN, negative values, infinite values, blank values) in each variable, you can use the <span class="in">`checkdata()`</span> function. This function generates a summary table for each data frame, showing the number of observations containing NA, NaN, zero, negative, infinite (Inf), and blank values, along with their percentages.</span>
<span id="cb49-166"><a href="#cb49-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-167"><a href="#cb49-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-168"><a href="#cb49-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_1_1}</span></span>
<span id="cb49-169"><a href="#cb49-169" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-170"><a href="#cb49-170" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-171"><a href="#cb49-171" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-172"><a href="#cb49-172" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-173"><a href="#cb49-173" aria-hidden="true" tabindex="-1"></a><span class="in">#| </span></span>
<span id="cb49-174"><a href="#cb49-174" aria-hidden="true" tabindex="-1"></a><span class="in">if (!require(kableExtra)) {</span></span>
<span id="cb49-175"><a href="#cb49-175" aria-hidden="true" tabindex="-1"></a><span class="in">  install.packages("kableExtra")  # Install the package if it's not available.</span></span>
<span id="cb49-176"><a href="#cb49-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-177"><a href="#cb49-177" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb49-178"><a href="#cb49-178" aria-hidden="true" tabindex="-1"></a><span class="in">library(kableExtra)             # Load it after installation.</span></span>
<span id="cb49-179"><a href="#cb49-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-180"><a href="#cb49-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-181"><a href="#cb49-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-182"><a href="#cb49-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_4}</span></span>
<span id="cb49-183"><a href="#cb49-183" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-184"><a href="#cb49-184" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-185"><a href="#cb49-185" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-186"><a href="#cb49-186" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-187"><a href="#cb49-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-188"><a href="#cb49-188" aria-hidden="true" tabindex="-1"></a><span class="in">kable(ClinData_check$everycolumn)</span></span>
<span id="cb49-189"><a href="#cb49-189" aria-hidden="true" tabindex="-1"></a><span class="in">kable(MetaboliteData_check$everycolumn)</span></span>
<span id="cb49-190"><a href="#cb49-190" aria-hidden="true" tabindex="-1"></a><span class="in">kable(FoodData_check$everycolumn)</span></span>
<span id="cb49-191"><a href="#cb49-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-192"><a href="#cb49-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-193"><a href="#cb49-193" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-194"><a href="#cb49-194" aria-hidden="true" tabindex="-1"></a>You shall only continue to use the data when the class of variables are correct and the missing or abnormal values in the variable are properly handled.</span>
<span id="cb49-195"><a href="#cb49-195" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-196"><a href="#cb49-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-197"><a href="#cb49-197" aria-hidden="true" tabindex="-1"></a><span class="fu">## Build data for analysis</span></span>
<span id="cb49-198"><a href="#cb49-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-199"><a href="#cb49-199" aria-hidden="true" tabindex="-1"></a>We treat food variables as our exposures and BMI and type 2 diabetes as outcomes. Note that BMI is a continuous variable. We can additionally construct BMI as a categorical outcome using the following criteria:</span>
<span id="cb49-200"><a href="#cb49-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-201"><a href="#cb49-201" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>BMI <span class="sc">\&lt;</span>= 18.5: Underweight</span>
<span id="cb49-202"><a href="#cb49-202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>18.5 <span class="sc">\&lt;</span>BMI <span class="sc">\&lt;</span>= 25: Normal</span>
<span id="cb49-203"><a href="#cb49-203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>25 <span class="sc">\&lt;</span> BMI <span class="sc">\&lt;</span>= 30: Overweight</span>
<span id="cb49-204"><a href="#cb49-204" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>30 <span class="sc">\&lt;</span> BMI: Obese</span>
<span id="cb49-205"><a href="#cb49-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-206"><a href="#cb49-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_4_1}</span></span>
<span id="cb49-207"><a href="#cb49-207" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-208"><a href="#cb49-208" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-209"><a href="#cb49-209" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-210"><a href="#cb49-210" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-211"><a href="#cb49-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-212"><a href="#cb49-212" aria-hidden="true" tabindex="-1"></a><span class="in">BMI &lt;- ClinData[,"BMI"] </span></span>
<span id="cb49-213"><a href="#cb49-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-214"><a href="#cb49-214" aria-hidden="true" tabindex="-1"></a><span class="in">BMI_cat &lt;- cut(BMI,  </span></span>
<span id="cb49-215"><a href="#cb49-215" aria-hidden="true" tabindex="-1"></a><span class="in">               breaks = c(-Inf, 18.5, 25, 30, Inf),  </span></span>
<span id="cb49-216"><a href="#cb49-216" aria-hidden="true" tabindex="-1"></a><span class="in">               labels = c('underweight', 'normal', 'overweight', 'obese'),  </span></span>
<span id="cb49-217"><a href="#cb49-217" aria-hidden="true" tabindex="-1"></a><span class="in">               right = TRUE) </span></span>
<span id="cb49-218"><a href="#cb49-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-219"><a href="#cb49-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-220"><a href="#cb49-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-221"><a href="#cb49-221" aria-hidden="true" tabindex="-1"></a>We want to explore the exposure-outcome relationships through the metabolomics data, using metabolites as assumed mediators. Food data serves as exposures, while BMI (both continuous and categorical) and Type 2 Diabetes are treated as outcomes. Gender, age, education, physical activity, and smoking are used as potential confounders for the exposure-mediator and mediator-outcome associations. Additionally, auxiliary information regarding case-control matches, fasting glucose levels, education, and physical activity is provided to enhance the analysis. </span>
<span id="cb49-222"><a href="#cb49-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-223"><a href="#cb49-223" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_5}</span></span>
<span id="cb49-224"><a href="#cb49-224" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-225"><a href="#cb49-225" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-226"><a href="#cb49-226" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-227"><a href="#cb49-227" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-228"><a href="#cb49-228" aria-hidden="true" tabindex="-1"></a><span class="in">exposure2 &lt;- FoodData</span></span>
<span id="cb49-229"><a href="#cb49-229" aria-hidden="true" tabindex="-1"></a><span class="in">Omics2 &lt;- MetaboliteData</span></span>
<span id="cb49-230"><a href="#cb49-230" aria-hidden="true" tabindex="-1"></a><span class="in">outcome2 &lt;- cbind.data.frame(ClinData[,c("T2D","BMI")], BMI_cat)</span></span>
<span id="cb49-231"><a href="#cb49-231" aria-hidden="true" tabindex="-1"></a><span class="in">covariates2 &lt;- ClinData[, c("Gender" ,"Age","Education","PhysicalActivityIndex","Smoking" )]</span></span>
<span id="cb49-232"><a href="#cb49-232" aria-hidden="true" tabindex="-1"></a><span class="in">auxiliary2 &lt;- ClinData[, c("PairedInfo","FastingGlucose","Education","PhysicalActivityIndex", "Energy")]</span></span>
<span id="cb49-233"><a href="#cb49-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-234"><a href="#cb49-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-235"><a href="#cb49-235" aria-hidden="true" tabindex="-1"></a><span class="fu"># Code example of using TriplotGUI</span></span>
<span id="cb49-236"><a href="#cb49-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-237"><a href="#cb49-237" aria-hidden="true" tabindex="-1"></a>We will use more complex settings in this example. Please go to <span class="co">[</span><span class="ot">Tutorial(simple)</span><span class="co">](simple_code.qmd)</span>{target="_blank"}.if you want to try simpler settings.</span>
<span id="cb49-238"><a href="#cb49-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-239"><a href="#cb49-239" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 1: Data reduction of Omics variables {#simple_link}</span></span>
<span id="cb49-240"><a href="#cb49-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-241"><a href="#cb49-241" aria-hidden="true" tabindex="-1"></a>Using <span class="in">`TriplotGUI`</span> package, first we perform dimension reduction, using weighted correlation network analysis (WGCNA) on metabolomics data.</span>
<span id="cb49-242"><a href="#cb49-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-243"><a href="#cb49-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_2}</span></span>
<span id="cb49-244"><a href="#cb49-244" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-245"><a href="#cb49-245" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-246"><a href="#cb49-246" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-247"><a href="#cb49-247" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-248"><a href="#cb49-248" aria-hidden="true" tabindex="-1"></a><span class="in"># Using the complex settings</span></span>
<span id="cb49-249"><a href="#cb49-249" aria-hidden="true" tabindex="-1"></a><span class="in">reduced_Omics2 &lt;- OmicsReduction(dataframe = Omics2,</span></span>
<span id="cb49-250"><a href="#cb49-250" aria-hidden="true" tabindex="-1"></a><span class="in">                                   plotType = c("scree","score","loading","scoreloading"),</span></span>
<span id="cb49-251"><a href="#cb49-251" aria-hidden="true" tabindex="-1"></a><span class="in">                                   pcType = "principal", </span></span>
<span id="cb49-252"><a href="#cb49-252" aria-hidden="true" tabindex="-1"></a><span class="in"># Users can choose freely to use principal() instead of prcomp() to perform PCA.The result should be very similar, but principal() allows more functionalities</span></span>
<span id="cb49-253"><a href="#cb49-253" aria-hidden="true" tabindex="-1"></a><span class="in">                                   firstPC = 1,</span></span>
<span id="cb49-254"><a href="#cb49-254" aria-hidden="true" tabindex="-1"></a><span class="in">                                   secondPC= 2,</span></span>
<span id="cb49-255"><a href="#cb49-255" aria-hidden="true" tabindex="-1"></a><span class="in">                                   option = "WGCNA",</span></span>
<span id="cb49-256"><a href="#cb49-256" aria-hidden="true" tabindex="-1"></a><span class="in"># In this example we use WGCNA to perform data reduction, therefore specifying `option="WGCNA"`.</span></span>
<span id="cb49-257"><a href="#cb49-257" aria-hidden="true" tabindex="-1"></a><span class="in">                                   scale = TRUE,</span></span>
<span id="cb49-258"><a href="#cb49-258" aria-hidden="true" tabindex="-1"></a><span class="in">                                   center = TRUE,</span></span>
<span id="cb49-259"><a href="#cb49-259" aria-hidden="true" tabindex="-1"></a><span class="in">                                   eigenLoading = "loading",</span></span>
<span id="cb49-260"><a href="#cb49-260" aria-hidden="true" tabindex="-1"></a><span class="in"># If you want to show loading or scale it to eigevalues.</span></span>
<span id="cb49-261"><a href="#cb49-261" aria-hidden="true" tabindex="-1"></a><span class="in">                                   rotate = "none",</span></span>
<span id="cb49-262"><a href="#cb49-262" aria-hidden="true" tabindex="-1"></a><span class="in"># This argument is inherited from the principal() function</span></span>
<span id="cb49-263"><a href="#cb49-263" aria-hidden="true" tabindex="-1"></a><span class="in">                                   sizeVariable = auxiliary2$FastingGlucose,</span></span>
<span id="cb49-264"><a href="#cb49-264" aria-hidden="true" tabindex="-1"></a><span class="in">                                   sizeVariableName = "FastigGlucose",</span></span>
<span id="cb49-265"><a href="#cb49-265" aria-hidden="true" tabindex="-1"></a><span class="in">                                   colorVariable = auxiliary2$Education,</span></span>
<span id="cb49-266"><a href="#cb49-266" aria-hidden="true" tabindex="-1"></a><span class="in">                                   colorVariableName = "Education",</span></span>
<span id="cb49-267"><a href="#cb49-267" aria-hidden="true" tabindex="-1"></a><span class="in">                                   shapeVariable = auxiliary2$PhysicalActivityIndex,</span></span>
<span id="cb49-268"><a href="#cb49-268" aria-hidden="true" tabindex="-1"></a><span class="in">                                   shapeVariableName = "PhysicalActivityIndex",</span></span>
<span id="cb49-269"><a href="#cb49-269" aria-hidden="true" tabindex="-1"></a><span class="in"># The size,shape,color variables are used to differentiate points on the score plot and biplot </span></span>
<span id="cb49-270"><a href="#cb49-270" aria-hidden="true" tabindex="-1"></a><span class="in">                                   loadingsName = TRUE,</span></span>
<span id="cb49-271"><a href="#cb49-271" aria-hidden="true" tabindex="-1"></a><span class="in"># Show the names of loadings</span></span>
<span id="cb49-272"><a href="#cb49-272" aria-hidden="true" tabindex="-1"></a><span class="in">                                   loadingsCutpercent = 0.2,</span></span>
<span id="cb49-273"><a href="#cb49-273" aria-hidden="true" tabindex="-1"></a><span class="in"># The loadings bigger than 20% of all the loadings will show up</span></span>
<span id="cb49-274"><a href="#cb49-274" aria-hidden="true" tabindex="-1"></a><span class="in">                                   minModuleSize = 3</span></span>
<span id="cb49-275"><a href="#cb49-275" aria-hidden="true" tabindex="-1"></a><span class="in"># The mimimum number of variable in each cluster of WGCNA</span></span>
<span id="cb49-276"><a href="#cb49-276" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb49-277"><a href="#cb49-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-278"><a href="#cb49-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-279"><a href="#cb49-279" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-280"><a href="#cb49-280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In WGCNA, Omics variables are grouped into clusters. PCA is performed on each cluster, and the first principal component of each cluster is used as the module for WGCNA.</span>
<span id="cb49-281"><a href="#cb49-281" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>You could try out the arguments of the <span class="in">`OmicsReduction()`</span> function to visualize the results and view the whole function <span class="co">[</span><span class="ot">here</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCAorWGCNA_plots.R?ref_type=heads)</span>{target="_blank"}</span>
<span id="cb49-282"><a href="#cb49-282" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The <span class="in">`minModuleSize`</span> argument in <span class="in">`OmicsReduction()`</span> is crucial as it defines the minimum number of variables in each cluster. Setting this too high may result in all variables being grouped into a single cluster. For instance, with 20 variables and <span class="in">`minModuleSize=15`</span>, you might end up with one cluster containing all 20 variables. In this case, only the first principal component of this single cluster would be used and displayed on both axes of the resulting triplots.</span>
<span id="cb49-283"><a href="#cb49-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-284"><a href="#cb49-284" aria-hidden="true" tabindex="-1"></a>    To avoid this, adjust <span class="in">`minModuleSize`</span> based on your total variable count and desired cluster granularity. Experiment with different values to achieve a balance between meaningful clusters and interpretable results.</span>
<span id="cb49-285"><a href="#cb49-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-286"><a href="#cb49-286" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-287"><a href="#cb49-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-288"><a href="#cb49-288" aria-hidden="true" tabindex="-1"></a>You can see scree plot, score plot, loadings plot and biplot at this stage.</span>
<span id="cb49-289"><a href="#cb49-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-290"><a href="#cb49-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6A}</span></span>
<span id="cb49-291"><a href="#cb49-291" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-292"><a href="#cb49-292" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-293"><a href="#cb49-293" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-294"><a href="#cb49-294" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-295"><a href="#cb49-295" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-296"><a href="#cb49-296" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-297"><a href="#cb49-297" aria-hidden="true" tabindex="-1"></a><span class="in">reduced_Omics2$scree_plot</span></span>
<span id="cb49-298"><a href="#cb49-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-299"><a href="#cb49-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-300"><a href="#cb49-300" aria-hidden="true" tabindex="-1"></a>The scree plot in WGCNA visualizes the variance explained by each cluster. Clusters are color-coded, with column heights representing the proportion of total variance explained by each cluster. The darker color in each column shows the variance explained by the first principal component (module) of that cluster.</span>
<span id="cb49-301"><a href="#cb49-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-302"><a href="#cb49-302" aria-hidden="true" tabindex="-1"></a>The grey cluster, showing only a darker color, indicates it contains just one variable, which serves as its own first principal component/module. This can occur even with <span class="in">`minModuleSize=2`</span>, as some variables may be left unclustered.</span>
<span id="cb49-303"><a href="#cb49-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-304"><a href="#cb49-304" aria-hidden="true" tabindex="-1"></a>Clusters are arranged from left to right based on the number of variables they contain, with the leftmost cluster having the most variables and the rightmost having the least. This arrangement helps in quickly identifying the relative sizes and importance of different clusters in the dataset.</span>
<span id="cb49-305"><a href="#cb49-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-306"><a href="#cb49-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6B}</span></span>
<span id="cb49-307"><a href="#cb49-307" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-308"><a href="#cb49-308" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-309"><a href="#cb49-309" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-310"><a href="#cb49-310" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-311"><a href="#cb49-311" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-312"><a href="#cb49-312" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-313"><a href="#cb49-313" aria-hidden="true" tabindex="-1"></a><span class="in">reduced_Omics2$score_plot</span></span>
<span id="cb49-314"><a href="#cb49-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-315"><a href="#cb49-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-316"><a href="#cb49-316" aria-hidden="true" tabindex="-1"></a>In the score plot, observations are colored by education level, with different shapes representing varying physical activity indices and different sizes indicating fasting glucose levels. This visualization allows for an integrated view of how these characteristics relate to the modules derived from the WGCNA analysis, highlighting patterns among individuals based on their traits.</span>
<span id="cb49-317"><a href="#cb49-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-318"><a href="#cb49-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6C}</span></span>
<span id="cb49-319"><a href="#cb49-319" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-320"><a href="#cb49-320" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-321"><a href="#cb49-321" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-322"><a href="#cb49-322" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-323"><a href="#cb49-323" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-324"><a href="#cb49-324" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-325"><a href="#cb49-325" aria-hidden="true" tabindex="-1"></a><span class="in">reduced_Omics2$loading_plot</span></span>
<span id="cb49-326"><a href="#cb49-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-327"><a href="#cb49-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-328"><a href="#cb49-328" aria-hidden="true" tabindex="-1"></a>The loading plot displays loadings aligned along the axes, reflecting the use of first principal components/modules from each cluster in WGCNA. This alignment occurs because each axis represents a distinct principal component analysis, making it impossible for loadings to point in the direction of another axis.</span>
<span id="cb49-329"><a href="#cb49-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-330"><a href="#cb49-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_6D}</span></span>
<span id="cb49-331"><a href="#cb49-331" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-332"><a href="#cb49-332" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-333"><a href="#cb49-333" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-334"><a href="#cb49-334" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-335"><a href="#cb49-335" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-336"><a href="#cb49-336" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-337"><a href="#cb49-337" aria-hidden="true" tabindex="-1"></a><span class="in">reduced_Omics2$scoreloading_plot</span></span>
<span id="cb49-338"><a href="#cb49-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-339"><a href="#cb49-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-340"><a href="#cb49-340" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-341"><a href="#cb49-341" aria-hidden="true" tabindex="-1"></a>Sometimes the following text will show up in your console and the figure cannot be directly run:</span>
<span id="cb49-342"><a href="#cb49-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-343"><a href="#cb49-343" aria-hidden="true" tabindex="-1"></a><span class="in">`libpng warning: Image width is zero in IHDR`</span> </span>
<span id="cb49-344"><a href="#cb49-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-345"><a href="#cb49-345" aria-hidden="true" tabindex="-1"></a><span class="in">`libpng error: Invalid IHDR data`</span> </span>
<span id="cb49-346"><a href="#cb49-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-347"><a href="#cb49-347" aria-hidden="true" tabindex="-1"></a><span class="in">`Warning message:`</span></span>
<span id="cb49-348"><a href="#cb49-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-349"><a href="#cb49-349" aria-hidden="true" tabindex="-1"></a><span class="in">`In dev.off(which) : agg could not write to the given file\`</span></span>
<span id="cb49-350"><a href="#cb49-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-351"><a href="#cb49-351" aria-hidden="true" tabindex="-1"></a>Run <span class="in">`gc()`</span> in your console to clear the memory. Then rerun the code again to view the figure.</span>
<span id="cb49-352"><a href="#cb49-352" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb49-353"><a href="#cb49-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-354"><a href="#cb49-354" aria-hidden="true" tabindex="-1"></a>Although informative, the biplot combining both score and loading can appear cluttered due to the high density of information it contains.</span>
<span id="cb49-355"><a href="#cb49-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-356"><a href="#cb49-356" aria-hidden="true" tabindex="-1"></a>A TPObject is constructed based on the data reduction results from the WGCNA analysis. This object serves as a central repository for storing and trandfering information generated through the various steps during the analysis.</span>
<span id="cb49-357"><a href="#cb49-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-358"><a href="#cb49-358" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_7}</span></span>
<span id="cb49-359"><a href="#cb49-359" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-360"><a href="#cb49-360" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-361"><a href="#cb49-361" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-362"><a href="#cb49-362" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-363"><a href="#cb49-363" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.output: false</span></span>
<span id="cb49-364"><a href="#cb49-364" aria-hidden="true" tabindex="-1"></a><span class="in">scores &lt;- reduced_Omics2$object$scores</span></span>
<span id="cb49-365"><a href="#cb49-365" aria-hidden="true" tabindex="-1"></a><span class="in">loadings &lt;- reduced_Omics2$object$loadings</span></span>
<span id="cb49-366"><a href="#cb49-366" aria-hidden="true" tabindex="-1"></a><span class="in">variance &lt;- reduced_Omics2$object$variance</span></span>
<span id="cb49-367"><a href="#cb49-367" aria-hidden="true" tabindex="-1"></a><span class="in">TPObject1 &lt;- makeTPO(scores = scores,</span></span>
<span id="cb49-368"><a href="#cb49-368" aria-hidden="true" tabindex="-1"></a><span class="in">                     loadings = loadings,</span></span>
<span id="cb49-369"><a href="#cb49-369" aria-hidden="true" tabindex="-1"></a><span class="in">                     variance = variance)</span></span>
<span id="cb49-370"><a href="#cb49-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-371"><a href="#cb49-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-372"><a href="#cb49-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-373"><a href="#cb49-373" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 2-3: Exposure-Omics and Omics-Outcome associations</span></span>
<span id="cb49-374"><a href="#cb49-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-375"><a href="#cb49-375" aria-hidden="true" tabindex="-1"></a>The associations between modules and food items and the associations between modules and risk markers can be then calculated, with confounders adjusted. Note that it is possible for users to skip code regarding exposure association or risk association, if their interests focus on only outcome associations or exposure associations with Omics variables.</span>
<span id="cb49-376"><a href="#cb49-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-377"><a href="#cb49-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-378"><a href="#cb49-378" aria-hidden="true" tabindex="-1"></a>The modules information saved in the TPObject can be directly utilized in the <span class="in">`exposureAssociation()`</span> function. This function calculates exposure associations coefficients and p-values between the modules and exposures (food variables and diet scores), while adjusting for specified confounders.</span>
<span id="cb49-379"><a href="#cb49-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-380"><a href="#cb49-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-381"><a href="#cb49-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-382"><a href="#cb49-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-383"><a href="#cb49-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_3}</span></span>
<span id="cb49-384"><a href="#cb49-384" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-385"><a href="#cb49-385" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-386"><a href="#cb49-386" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-387"><a href="#cb49-387" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-388"><a href="#cb49-388" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.output: false</span></span>
<span id="cb49-389"><a href="#cb49-389" aria-hidden="true" tabindex="-1"></a><span class="in">Correlations_object &lt;- exposureAssociation(TPObject = TPObject1,</span></span>
<span id="cb49-390"><a href="#cb49-390" aria-hidden="true" tabindex="-1"></a><span class="in">                                exposure = exposure2,</span></span>
<span id="cb49-391"><a href="#cb49-391" aria-hidden="true" tabindex="-1"></a><span class="in">                                use = 'pairwise', </span></span>
<span id="cb49-392"><a href="#cb49-392" aria-hidden="true" tabindex="-1"></a><span class="in">                                # use inherit from cor() function </span></span>
<span id="cb49-393"><a href="#cb49-393" aria-hidden="true" tabindex="-1"></a><span class="in">                                method = 'pearson',</span></span>
<span id="cb49-394"><a href="#cb49-394" aria-hidden="true" tabindex="-1"></a><span class="in">                                # method inherit from cor() function </span></span>
<span id="cb49-395"><a href="#cb49-395" aria-hidden="true" tabindex="-1"></a><span class="in">                                allowCategorical = FALSE,</span></span>
<span id="cb49-396"><a href="#cb49-396" aria-hidden="true" tabindex="-1"></a><span class="in">                                # one-hot-encoding on categorical exposures</span></span>
<span id="cb49-397"><a href="#cb49-397" aria-hidden="true" tabindex="-1"></a><span class="in">                                partial = TRUE,</span></span>
<span id="cb49-398"><a href="#cb49-398" aria-hidden="true" tabindex="-1"></a><span class="in">                                # perform confonder adjustment</span></span>
<span id="cb49-399"><a href="#cb49-399" aria-hidden="true" tabindex="-1"></a><span class="in">                                confounder = covariates2)</span></span>
<span id="cb49-400"><a href="#cb49-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-401"><a href="#cb49-401" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-402"><a href="#cb49-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-403"><a href="#cb49-403" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-404"><a href="#cb49-404" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The <span class="in">`exposureAssociation()`</span> function offers options for handling categorical variables and adjusting for confounders. When setting <span class="in">`allowcategorical=FALSE`</span>, categorical exposures with more than two classes undergo one-hot-encoding, transforming them into binary variables. This can be verified by examining <span class="in">`Correlations_object$cor_estimate`</span>, which shows separate correlation coefficients for each binary representation of HFI levels. However, <span class="in">`allowcategorical=FALSE`</span> is limited for  meaningful use. The binary variables may be only meaningful when we want to compare one level to all the other levels together. We use this option for categorical variable <span class="in">`"HFI"`</span> for demonstration purpose. Ideally, one should use <span class="in">`allowcategorical=TRUE`</span> for HFI.</span>
<span id="cb49-405"><a href="#cb49-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-406"><a href="#cb49-406" aria-hidden="true" tabindex="-1"></a>    Conversely, <span class="in">`allowcategorical=TRUE`</span> leaves categorical variables like <span class="in">`"HFI"`</span> untransformed. In this case, linear models regressing modules on <span class="in">`"HFI"`</span> are used for correlation analysis. The correlation coefficients are derived from the square root of the proportion of HFI's sum of squares to the total sum of squares. </span>
<span id="cb49-407"><a href="#cb49-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-408"><a href="#cb49-408" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Setting <span class="in">`partial=TRUE`</span> ensures that specified confounders are adjusted for in the correlation analysis.</span>
<span id="cb49-409"><a href="#cb49-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-410"><a href="#cb49-410" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-411"><a href="#cb49-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-412"><a href="#cb49-412" aria-hidden="true" tabindex="-1"></a>The correlation results obtained from the <span class="in">`exposureAssociation()`</span> function are then incorporated into the TPObject. </span>
<span id="cb49-413"><a href="#cb49-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-414"><a href="#cb49-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_8}</span></span>
<span id="cb49-415"><a href="#cb49-415" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-416"><a href="#cb49-416" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-417"><a href="#cb49-417" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-418"><a href="#cb49-418" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-419"><a href="#cb49-419" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.output: false</span></span>
<span id="cb49-420"><a href="#cb49-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-421"><a href="#cb49-421" aria-hidden="true" tabindex="-1"></a><span class="in">TPObject2 &lt;- addExposure(TPObject = TPObject1,</span></span>
<span id="cb49-422"><a href="#cb49-422" aria-hidden="true" tabindex="-1"></a><span class="in">                     corrEstimate = Correlations_object$cor_estimate,</span></span>
<span id="cb49-423"><a href="#cb49-423" aria-hidden="true" tabindex="-1"></a><span class="in">                     corrPvalue = Correlations_object$cor_pvalue)</span></span>
<span id="cb49-424"><a href="#cb49-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-425"><a href="#cb49-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-426"><a href="#cb49-426" aria-hidden="true" tabindex="-1"></a>The modules information saved in the TPObject can be directly utilized in the <span class="in">`outcomeAssociation()`</span> function. This function calculates risk estimates and p-values between the modules and outcomes (BMI, type 2 diabetes and categorical BMI), while adjusting for specified confounders.</span>
<span id="cb49-427"><a href="#cb49-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-428"><a href="#cb49-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-429"><a href="#cb49-429" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_4}</span></span>
<span id="cb49-430"><a href="#cb49-430" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-431"><a href="#cb49-431" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-432"><a href="#cb49-432" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-433"><a href="#cb49-433" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-434"><a href="#cb49-434" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.output: false</span></span>
<span id="cb49-435"><a href="#cb49-435" aria-hidden="true" tabindex="-1"></a><span class="in">Risks_object &lt;- outcomeAssociation(TPObject = TPObject2,</span></span>
<span id="cb49-436"><a href="#cb49-436" aria-hidden="true" tabindex="-1"></a><span class="in">                                outcome = outcome2,</span></span>
<span id="cb49-437"><a href="#cb49-437" aria-hidden="true" tabindex="-1"></a><span class="in">                                confounder = covariates2,</span></span>
<span id="cb49-438"><a href="#cb49-438" aria-hidden="true" tabindex="-1"></a><span class="in">                                partial = TRUE,</span></span>
<span id="cb49-439"><a href="#cb49-439" aria-hidden="true" tabindex="-1"></a><span class="in">                                # performs confounder adjustment</span></span>
<span id="cb49-440"><a href="#cb49-440" aria-hidden="true" tabindex="-1"></a><span class="in">                                multinomial = TRUE,</span></span>
<span id="cb49-441"><a href="#cb49-441" aria-hidden="true" tabindex="-1"></a><span class="in">                                # multinomial regression is used</span></span>
<span id="cb49-442"><a href="#cb49-442" aria-hidden="true" tabindex="-1"></a><span class="in">                                pair = auxiliary2$PairedInfo,</span></span>
<span id="cb49-443"><a href="#cb49-443" aria-hidden="true" tabindex="-1"></a><span class="in">                                # use the pairing information of case and control</span></span>
<span id="cb49-444"><a href="#cb49-444" aria-hidden="true" tabindex="-1"></a><span class="in">                                CI = 0.95</span></span>
<span id="cb49-445"><a href="#cb49-445" aria-hidden="true" tabindex="-1"></a><span class="in">                                # confidence interval</span></span>
<span id="cb49-446"><a href="#cb49-446" aria-hidden="true" tabindex="-1"></a><span class="in">                                )</span></span>
<span id="cb49-447"><a href="#cb49-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-448"><a href="#cb49-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-449"><a href="#cb49-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-450"><a href="#cb49-450" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-451"><a href="#cb49-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-452"><a href="#cb49-452" aria-hidden="true" tabindex="-1"></a>The <span class="in">`outcomeAssociation()`</span> function offers various options for handling outcomes and adjusting for confounders, with behavior differing based on whether pair information is provided.</span>
<span id="cb49-453"><a href="#cb49-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-454"><a href="#cb49-454" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Without <span class="in">`pair`</span> information:</span>
<span id="cb49-455"><a href="#cb49-455" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`multinomial=FALSE`</span> transforms categorical outcomes with &gt;2 classes into binary variables via one-hot-encoding. Logistic regression is used for binary outcomes, and linear regression for continuous outcomes.</span>
<span id="cb49-456"><a href="#cb49-456" aria-hidden="true" tabindex="-1"></a><span class="ss">    -    </span><span class="in">`multinomial=TRUE`</span> applies multinomial regression to categorical outcomes with &gt;2 classes, yielding n-1 estimates. Binary and continuous outcomes are handled as before.</span>
<span id="cb49-457"><a href="#cb49-457" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-458"><a href="#cb49-458" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With pair information:</span>
<span id="cb49-459"><a href="#cb49-459" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`multinomial=FALSE`</span> transforms categorical outcomes as above, then uses conditional logistic regression for binary outcomes and linear mixed models for continuous outcomes, incorporating pairing information.</span>
<span id="cb49-460"><a href="#cb49-460" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`multinomial=TRUE`</span> ignores pairing information, applying multinomial regression to categorical outcomes and standard logistic/linear regression to binary/continuous outcomes.</span>
<span id="cb49-461"><a href="#cb49-461" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-462"><a href="#cb49-462" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Setting <span class="in">`partial=TRUE`</span> ensures adjustment for specified confounders in all analyses.</span>
<span id="cb49-463"><a href="#cb49-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-464"><a href="#cb49-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-465"><a href="#cb49-465" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-466"><a href="#cb49-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-467"><a href="#cb49-467" aria-hidden="true" tabindex="-1"></a>The results for risk estimates obtained from the <span class="in">`outcomeAssociation()`</span> function are then incorporated into the TPObject. </span>
<span id="cb49-468"><a href="#cb49-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-469"><a href="#cb49-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_9}</span></span>
<span id="cb49-470"><a href="#cb49-470" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-471"><a href="#cb49-471" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-472"><a href="#cb49-472" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-473"><a href="#cb49-473" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-474"><a href="#cb49-474" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.output: false</span></span>
<span id="cb49-475"><a href="#cb49-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-476"><a href="#cb49-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-477"><a href="#cb49-477" aria-hidden="true" tabindex="-1"></a><span class="in">TPObject3 &lt;- addOutcome(TPObject = TPObject2, </span></span>
<span id="cb49-478"><a href="#cb49-478" aria-hidden="true" tabindex="-1"></a><span class="in">                     Risk = Risks_object)</span></span>
<span id="cb49-479"><a href="#cb49-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-480"><a href="#cb49-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-481"><a href="#cb49-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-482"><a href="#cb49-482" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 4: Meet-in-the-middle Triplot Visualization</span></span>
<span id="cb49-483"><a href="#cb49-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-484"><a href="#cb49-484" aria-hidden="true" tabindex="-1"></a>The TPObject created from all steps can be used to generate a Triplot using the <span class="in">`TriplotGUI()`</span> function. The function serves as a wrapper for <span class="in">`PCA_TriplotGUI()`</span> and <span class="in">`WGCNA_TriplotGUI()`</span>. You can check the functions respectively here: <span class="co">[</span><span class="ot">`TriplotGUI()`</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/TriplotGUI.R?ref_type=heads)</span>{target="_blank"}, <span class="co">[</span><span class="ot">`PCA_TriplotGUI()`</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/PCA_TriplotGUI.R?ref_type=heads)</span>{target="_blank"}, <span class="co">[</span><span class="ot">`WGCNA_TriplotGUI()`</span><span class="co">](https://gitlab.com/YingxiaoYan/triplotgui/-/blob/main/R/WGCNA_TriplotGUI.R?ref_type=heads)</span>{target="_blank"}.</span>
<span id="cb49-485"><a href="#cb49-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-486"><a href="#cb49-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_5}</span></span>
<span id="cb49-487"><a href="#cb49-487" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-488"><a href="#cb49-488" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-489"><a href="#cb49-489" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-490"><a href="#cb49-490" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-491"><a href="#cb49-491" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.output: false</span></span>
<span id="cb49-492"><a href="#cb49-492" aria-hidden="true" tabindex="-1"></a><span class="in">TPO_plots3 &lt;- TriplotGUI(TPObject3,</span></span>
<span id="cb49-493"><a href="#cb49-493" aria-hidden="true" tabindex="-1"></a><span class="in">                              firstPC = 1, ## The first PC to map</span></span>
<span id="cb49-494"><a href="#cb49-494" aria-hidden="true" tabindex="-1"></a><span class="in">                              secondPC = 2, ## The first PC to map</span></span>
<span id="cb49-495"><a href="#cb49-495" aria-hidden="true" tabindex="-1"></a><span class="in">                              plotLoads = TRUE, ##Whether to plot loadings (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb49-496"><a href="#cb49-496" aria-hidden="true" tabindex="-1"></a><span class="in">                              plotScores = FALSE, ##Whether to plot scores (TRUE) or suppress them (FALSE; default)</span></span>
<span id="cb49-497"><a href="#cb49-497" aria-hidden="true" tabindex="-1"></a><span class="in">                              plotCorr = TRUE, ##Whether to plot correlations (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb49-498"><a href="#cb49-498" aria-hidden="true" tabindex="-1"></a><span class="in">                              plotRisk = TRUE, ##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE)</span></span>
<span id="cb49-499"><a href="#cb49-499" aria-hidden="true" tabindex="-1"></a><span class="in">                              ###############################################</span></span>
<span id="cb49-500"><a href="#cb49-500" aria-hidden="true" tabindex="-1"></a><span class="in">                              ##For loadings</span></span>
<span id="cb49-501"><a href="#cb49-501" aria-hidden="true" tabindex="-1"></a><span class="in">                              loadLabels = TRUE, ###Whether to plot variable loading labels (TRUE; default) or not (FALSE)</span></span>
<span id="cb49-502"><a href="#cb49-502" aria-hidden="true" tabindex="-1"></a><span class="in">                              loadArrowLength = 0.02, ###Length of arrow tip , set it as 0 if you want to remove it</span></span>
<span id="cb49-503"><a href="#cb49-503" aria-hidden="true" tabindex="-1"></a><span class="in">                              loadCut = 0, ###lower limit Loadings below the cut are plotted in light grey and without label</span></span>
<span id="cb49-504"><a href="#cb49-504" aria-hidden="true" tabindex="-1"></a><span class="in">                              loadLim = NULL, ##higher limit,Plot range for loadings</span></span>
<span id="cb49-505"><a href="#cb49-505" aria-hidden="true" tabindex="-1"></a><span class="in">                              ###############################################</span></span>
<span id="cb49-506"><a href="#cb49-506" aria-hidden="true" tabindex="-1"></a><span class="in">                              ##For correlations</span></span>
<span id="cb49-507"><a href="#cb49-507" aria-hidden="true" tabindex="-1"></a><span class="in">                              colCorr = "blue", ##Color vector for correlations</span></span>
<span id="cb49-508"><a href="#cb49-508" aria-hidden="true" tabindex="-1"></a><span class="in">                              pchCorr = 16, ##Plotting character for correlations</span></span>
<span id="cb49-509"><a href="#cb49-509" aria-hidden="true" tabindex="-1"></a><span class="in">                              whichCorr = NULL, ##Which correlations to plot (vector of numbers)</span></span>
<span id="cb49-510"><a href="#cb49-510" aria-hidden="true" tabindex="-1"></a><span class="in">                              corLim = NULL, ##Plot range for correlations</span></span>
<span id="cb49-511"><a href="#cb49-511" aria-hidden="true" tabindex="-1"></a><span class="in">                              corrLabels = TRUE, </span></span>
<span id="cb49-512"><a href="#cb49-512" aria-hidden="true" tabindex="-1"></a><span class="in">                              ###############################################</span></span>
<span id="cb49-513"><a href="#cb49-513" aria-hidden="true" tabindex="-1"></a><span class="in">                              ##For risks</span></span>
<span id="cb49-514"><a href="#cb49-514" aria-hidden="true" tabindex="-1"></a><span class="in">                              colRisk = "red", ##Color vector for risk estimates</span></span>
<span id="cb49-515"><a href="#cb49-515" aria-hidden="true" tabindex="-1"></a><span class="in">                              pchRisk = 15, ##Plotting character for risk estimates</span></span>
<span id="cb49-516"><a href="#cb49-516" aria-hidden="true" tabindex="-1"></a><span class="in">                              whichRisk = NULL, ##Which risk estimates to plot (vector of numbers)</span></span>
<span id="cb49-517"><a href="#cb49-517" aria-hidden="true" tabindex="-1"></a><span class="in">                              riskLim = NULL, ##Plot range for risks</span></span>
<span id="cb49-518"><a href="#cb49-518" aria-hidden="true" tabindex="-1"></a><span class="in">                              riskWhiskerPercentage = 0.1, ## whisker length is how many percentage of confidence interval</span></span>
<span id="cb49-519"><a href="#cb49-519" aria-hidden="true" tabindex="-1"></a><span class="in">                              riskLabels = TRUE, size = 3, # the size of points ont he plot</span></span>
<span id="cb49-520"><a href="#cb49-520" aria-hidden="true" tabindex="-1"></a><span class="in">                              riskOR = TRUE</span></span>
<span id="cb49-521"><a href="#cb49-521" aria-hidden="true" tabindex="-1"></a><span class="in">                              # plot the risk estimates as odds ratio</span></span>
<span id="cb49-522"><a href="#cb49-522" aria-hidden="true" tabindex="-1"></a><span class="in">                              )</span></span>
<span id="cb49-523"><a href="#cb49-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-524"><a href="#cb49-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-525"><a href="#cb49-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-526"><a href="#cb49-526" aria-hidden="true" tabindex="-1"></a>We then visualize the triplot.</span>
<span id="cb49-527"><a href="#cb49-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-528"><a href="#cb49-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_10}</span></span>
<span id="cb49-529"><a href="#cb49-529" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-530"><a href="#cb49-530" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-531"><a href="#cb49-531" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-532"><a href="#cb49-532" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-533"><a href="#cb49-533" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-534"><a href="#cb49-534" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-535"><a href="#cb49-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-536"><a href="#cb49-536" aria-hidden="true" tabindex="-1"></a><span class="in">TPO_plots3$triplot</span></span>
<span id="cb49-537"><a href="#cb49-537" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-538"><a href="#cb49-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-539"><a href="#cb49-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-540"><a href="#cb49-540" aria-hidden="true" tabindex="-1"></a>In the triplot visualization, black arrows represent loadings of Omics variables, forming patterns in different modules (axes). Blue circle points show exposure correlations with the modules, while red square points indicate outcome associations with the modules. </span>
<span id="cb49-541"><a href="#cb49-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-542"><a href="#cb49-542" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-543"><a href="#cb49-543" aria-hidden="true" tabindex="-1"></a>Note that we use first and second module for our example here. In reality, you may use the <span class="in">`checkTPO()`</span> function in TriplotGUI to view which modules may be more of your interest (that are associated with specific exposures and outcomes).</span>
<span id="cb49-544"><a href="#cb49-544" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-545"><a href="#cb49-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-546"><a href="#cb49-546" aria-hidden="true" tabindex="-1"></a>Based on the triplot visualization of the TriplotGUI interface, we can interpret the following key points:</span>
<span id="cb49-547"><a href="#cb49-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-548"><a href="#cb49-548" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>The first (top right) and third (bottom left) dimension generally represents a spectrum of dietary healthiness. Healthier foods (e.g., <span class="in">`"Fruits"`</span>, <span class="in">`"Vegetables"`</span>) and higher healthy food indices (<span class="in">`"HFI"`</span>, <span class="in">`"BSDS"`</span>) are positioned on one side in the first dimension, while less healthy foods (e.g., <span class="in">`"Hamburger"`</span>, <span class="in">`"Sausage"`</span>, <span class="in">`"Margarine"`</span>) are on the opposite side in the third dimension.</span>
<span id="cb49-549"><a href="#cb49-549" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>The second (top left) and fourth (bottom right) dimensions are associated with health outcomes, including the numeric outcome <span class="in">`"BMI"`</span>, binary outcome <span class="in">`"T2D"`</span>, and one-hot-encoded categorical <span class="in">`"BMI_cat"`</span> outcome.</span>
<span id="cb49-550"><a href="#cb49-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-551"><a href="#cb49-551" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Explanation for some variables in the plot:</span>
<span id="cb49-552"><a href="#cb49-552" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`"HFI"`</span> stands for healthy food index. A higher <span class="in">`"HFI"`</span> suggests healthier diet. <span class="in">`"HFI"`</span> ranges from 0 to 6. You can see that there are *HFI_0*, *HFI_1*...*HFI_6* in the figure and that is because `"HFI"` is used as a factor exposure variable in exposure's correlation and is one-hot-encoded to the same number of binary variables as its number of levels. For example, *HFI_6* is a binary variable where individuals with `"HFI"` as 6 (most healthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. *HFI_0* is a binary variable where individuals with `"HFI"` as 0 (most unhealthy diet people) will be labeled as 1 and the rest of individuals will be labelled as 0. *HFI_1*...*HFI_5* has limited use since it only separates the group of people with certain <span class="in">`"HFI"`</span> value from to the rest, which is a mixture of people with healthier and less healthier diet.</span>
<span id="cb49-553"><a href="#cb49-553" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`"BSDS"`</span> stands for Baltic Sea Diet Score ranging. A higher <span class="in">`"BSDS"`</span> suggests healthier diet. <span class="in">`"BSDS"`</span> is used as a numeric variable ranging from 2 to 25 in the correlation.</span>
<span id="cb49-554"><a href="#cb49-554" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>*BMI_cat_obese*, *BMI_cat_overweight*, *BMI_cat_underweight* are the odds ratio generated from the multinomial regression, since `"BMI_cat"` is a categorical outcome and multinomial regression is performed in outcome's association in this example. Normal weight is uses as a reference and odds ratio of obese, overweight and underweight is produced. (Note that the first level of the factor variable is set as the default reference, in this case it is *normal*).</span>
<span id="cb49-555"><a href="#cb49-555" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjusting for <span class="in">`"Age"`</span>, <span class="in">`"Gender"`</span>, <span class="in">`"Smoking"`</span>, <span class="in">`"Education"`</span> and <span class="in">`"FastingGlucose"`</span>, the first module (on x-axis) correlates positively with generally healthy food (e.g. <span class="in">`"fruits"`</span>, <span class="in">`"vegatables"`</span>) and food index (e.g. <span class="in">`"BSDS"`</span>) and negatively with unhealthy food (e.g. <span class="in">`"Hamburger"`</span>, <span class="in">`"pizza"`</span>). It also reversely associated with <span class="in">`"T2D"`</span> and <span class="in">`"BMI"`</span>. From the result from <span class="in">`"BMI_cat"`</span>, this components also reversely associated with being obese.</span>
<span id="cb49-556"><a href="#cb49-556" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjusting for <span class="in">`"Age"`</span>, <span class="in">`"Gender"`</span>, <span class="in">`"Smoking"`</span>, <span class="in">`"Education"`</span> and <span class="in">`"FastingGlucose"`</span>, the second module (on y-axis) associated positively with generally healthy food (e.g. <span class="in">`"fruits"`</span>, <span class="in">`"vegatables"`</span>) and food index (e.g. <span class="in">`"BSDS"`</span>) and negatively with unhealthy food (e.g. <span class="in">`"Hamburger"`</span>, <span class="in">`"pizza"`</span>). However, the module correlates also positively with <span class="in">`"T2D"`</span>,<span class="in">`"BMI"`</span>, *obese*, *overweight* and negatively associated with *underweight*.</span>
<span id="cb49-557"><a href="#cb49-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-558"><a href="#cb49-558" aria-hidden="true" tabindex="-1"></a>Based on what we summarized above, the two modules may be associated with a overall healthy eating pattern. And in this healthy eating pattern, the first module is associated more with the beneficial effect on health and the second module represents the adverse health effect.</span>
<span id="cb49-559"><a href="#cb49-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-560"><a href="#cb49-560" aria-hidden="true" tabindex="-1"></a><span class="fu">## Step 5: Mediation analysis and visualization</span></span>
<span id="cb49-561"><a href="#cb49-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-562"><a href="#cb49-562" aria-hidden="true" tabindex="-1"></a>In mediation analysis in TriplotGUI, we focus on a specific set of variables for mediation analysis: we select <span class="in">`"BSDS"`</span> (Baltic Sea Diet Score) and <span class="in">`"Hamburger"`</span> as our exposures, <span class="in">`"BMI"`</span> and <span class="in">`"T2D"`</span> as outcome to enter our next step. We choose first and second modules as our mediators.</span>
<span id="cb49-563"><a href="#cb49-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-564"><a href="#cb49-564" aria-hidden="true" tabindex="-1"></a>This time, we perform the mediation analysis with the <span class="in">`getMediationCounterfactual()`</span> function, using the counterfactual/potential outcome method implemented through the <span class="in">`mediation`</span> package in R on our exposures (i.e. <span class="in">`"BSDS"`</span>, <span class="in">`"Hamburger"`</span>), mediators (i.e. the first and second modules) and outcome (i.e. <span class="in">`"T2D"`</span>, <span class="in">`"BMI"`</span>) of interest, adjusting for <span class="in">`"Age"`</span>, <span class="in">`"Gender"`</span>, <span class="in">`"Smoking"`</span>, <span class="in">`"Education"`</span> and <span class="in">`"FastingGlucose"`</span> for both exposure-mediator and mediator-outcome relationship.</span>
<span id="cb49-565"><a href="#cb49-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-566"><a href="#cb49-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-567"><a href="#cb49-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-568"><a href="#cb49-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-569"><a href="#cb49-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_6}</span></span>
<span id="cb49-570"><a href="#cb49-570" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-571"><a href="#cb49-571" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-572"><a href="#cb49-572" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-573"><a href="#cb49-573" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-574"><a href="#cb49-574" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.output: false</span></span>
<span id="cb49-575"><a href="#cb49-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-576"><a href="#cb49-576" aria-hidden="true" tabindex="-1"></a><span class="in">mediation_object3 &lt;- </span></span>
<span id="cb49-577"><a href="#cb49-577" aria-hidden="true" tabindex="-1"></a><span class="in">  getMediationCounterfactual (mediator = TPObject3$scores[,c(1:2),drop = FALSE], </span></span>
<span id="cb49-578"><a href="#cb49-578" aria-hidden="true" tabindex="-1"></a><span class="in">                             # Specfiying at least 2 components so that there can be a 2-dimensional plot</span></span>
<span id="cb49-579"><a href="#cb49-579" aria-hidden="true" tabindex="-1"></a><span class="in">                               exposure=exposure2[,c("Hamburger","BSDS"),drop = FALSE],</span></span>
<span id="cb49-580"><a href="#cb49-580" aria-hidden="true" tabindex="-1"></a><span class="in">                             outcome = outcome2[,c("BMI","T2D"),drop = FALSE],</span></span>
<span id="cb49-581"><a href="#cb49-581" aria-hidden="true" tabindex="-1"></a><span class="in">                             exposureTreatment = c(25,19),</span></span>
<span id="cb49-582"><a href="#cb49-582" aria-hidden="true" tabindex="-1"></a><span class="in">                             exposureControl = c(2,0),</span></span>
<span id="cb49-583"><a href="#cb49-583" aria-hidden="true" tabindex="-1"></a><span class="in">                             confounderME = covariates2,</span></span>
<span id="cb49-584"><a href="#cb49-584" aria-hidden="true" tabindex="-1"></a><span class="in">                             confounderOE = covariates2)</span></span>
<span id="cb49-585"><a href="#cb49-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-586"><a href="#cb49-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-587"><a href="#cb49-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-588"><a href="#cb49-588" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-589"><a href="#cb49-589" aria-hidden="true" tabindex="-1"></a>In the counterfactual mediation analysis, contrast values of treatment and controls for each exposure needs to be specified. For each individual, the analysis considers what would happen if they received the treatment versus if they received the control. In brief, the algorithm uses these contrast values to calculate the potential outcomes under each scenario to estimate the direct and indirect effects. For a detailed explanation please refer to <span class="co">[</span><span class="ot">this paper</span><span class="co">](https://www.jstatsoft.org/article/view/v059i05)</span>{target="_blank"} of the <span class="in">`mediation`</span> R package.</span>
<span id="cb49-590"><a href="#cb49-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-591"><a href="#cb49-591" aria-hidden="true" tabindex="-1"></a>If an exposure variable is continuous (numeric variable), it is recommended that the treatment and control contrast values are chosen between the range of the exposure variable. If an exposure variable is categorical (factor variable), the treatment and control contrast values should be chosen from the levels of the exposure variable.</span>
<span id="cb49-592"><a href="#cb49-592" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-593"><a href="#cb49-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-594"><a href="#cb49-594" aria-hidden="true" tabindex="-1"></a>Then we can also Look at the barplot for mediations, which provides a clear visual representation of the direct, indirect, and total effects for each combination of exposure, mediator (principal component), and outcome. This visualization allows for a more intuitive understanding of the mediation analysis results.</span>
<span id="cb49-595"><a href="#cb49-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-596"><a href="#cb49-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_7}</span></span>
<span id="cb49-597"><a href="#cb49-597" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-598"><a href="#cb49-598" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-599"><a href="#cb49-599" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-600"><a href="#cb49-600" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-601"><a href="#cb49-601" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-602"><a href="#cb49-602" aria-hidden="true" tabindex="-1"></a><span class="in">mediation_plots3 &lt;- mediationBarplot(mediationObject = mediation_object3,</span></span>
<span id="cb49-603"><a href="#cb49-603" aria-hidden="true" tabindex="-1"></a><span class="in">                                         cex = 2#,</span></span>
<span id="cb49-604"><a href="#cb49-604" aria-hidden="true" tabindex="-1"></a><span class="in">                                         # size of the text</span></span>
<span id="cb49-605"><a href="#cb49-605" aria-hidden="true" tabindex="-1"></a><span class="in">                                         #by_row = "one_column"</span></span>
<span id="cb49-606"><a href="#cb49-606" aria-hidden="true" tabindex="-1"></a><span class="in">                                         )</span></span>
<span id="cb49-607"><a href="#cb49-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-608"><a href="#cb49-608" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-609"><a href="#cb49-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-610"><a href="#cb49-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_11}</span></span>
<span id="cb49-611"><a href="#cb49-611" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-612"><a href="#cb49-612" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-613"><a href="#cb49-613" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-614"><a href="#cb49-614" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-615"><a href="#cb49-615" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-616"><a href="#cb49-616" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-617"><a href="#cb49-617" aria-hidden="true" tabindex="-1"></a><span class="in">mediation_plots3</span></span>
<span id="cb49-618"><a href="#cb49-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-619"><a href="#cb49-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-620"><a href="#cb49-620" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-621"><a href="#cb49-621" aria-hidden="true" tabindex="-1"></a>The barplot displays direct, indirect, and total effects for each exposure-mediator-outcome combination, offering a convenient tool to assess the direction and magnitude of mediation estimates.</span>
<span id="cb49-622"><a href="#cb49-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-623"><a href="#cb49-623" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Color coding enhances interpretation: red indicates significant positive effects (p&lt;0.05), cyan shows significant negative effects (p&lt;0.05), and grey represents insignificant effects.</span>
<span id="cb49-624"><a href="#cb49-624" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Significance levels are denoted by stars: one star for p&lt;0.05, two stars for p&lt;0.01, and three stars for p&lt;0.001.</span>
<span id="cb49-625"><a href="#cb49-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-626"><a href="#cb49-626" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-627"><a href="#cb49-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-628"><a href="#cb49-628" aria-hidden="true" tabindex="-1"></a>We will make an example interpretation of the mediation barplot using BSDS as exposure, turquoise module as mediator (the module on the x axis in the triplot in step 4) and BMI as outcome. </span>
<span id="cb49-629"><a href="#cb49-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-630"><a href="#cb49-630" aria-hidden="true" tabindex="-1"></a>In the shown mediation barplot, we can observe the direction and magnitude of the indirect effect and proportion mediated. We observed that with all effects significant, indirect effect is negative, direct and total effect is positive. The negative indirect effect is consistent with the its visualization in the triplot, i.e, the turquiose module on the x axis associative with BSDS positively and with BMI negatively.</span>
<span id="cb49-631"><a href="#cb49-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-632"><a href="#cb49-632" aria-hidden="true" tabindex="-1"></a>However, the figure also shows that BSDS is positively associated with BMI through a larger direct effect. This seems counterintuitive but this could be due to a true direct effect or indirect effect mediated by other modules.</span>
<span id="cb49-633"><a href="#cb49-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-634"><a href="#cb49-634" aria-hidden="true" tabindex="-1"></a>Based on the mediation barplot, we've also observed significant proportion mediated with for BSDS-turquiose module-BMI mediations, suggesting a robust mediation effect.</span>
<span id="cb49-635"><a href="#cb49-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-636"><a href="#cb49-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-637"><a href="#cb49-637" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- To visualize the adjusted proportion mediated (APM) and add layers of correlation and risk estimates, use the following settings. --&gt;</span></span>
<span id="cb49-638"><a href="#cb49-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-639"><a href="#cb49-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-640"><a href="#cb49-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-641"><a href="#cb49-641" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-642"><a href="#cb49-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-643"><a href="#cb49-643" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- By observing this figure, we can see the direction and magnitude of adjusted proportion mediated (APM) for the two mediators across all exposures and outcomes. The positioning of the points is similar to what we observed for the proportion mediated (PM). --&gt;</span></span>
<span id="cb49-644"><a href="#cb49-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-645"><a href="#cb49-645" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Notably, the APM for BSDS (Baltic Sea Diet Score) as the exposure and T2D (Type 2 Diabetes) as the outcome is smaller than their corresponding PM (considering the abosolute value). This difference occurs because the indirect and direct effects for this mediation pathway are in opposite directions. This opposition leads to a smaller total effect and consequently a larger PM (considering the abosolute value). However, the APM is not affected by the directionality of the direct and indirect effects, providing a more stable measure of mediation.</span>
<span id="cb49-646"><a href="#cb49-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-647"><a href="#cb49-647" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   No confidence intervals are shown for APM. This is because APM values cannot be directly calculated from the mediation analysis in the `mediation` R package, unlike the proportion mediated (PM). --&gt;</span></span>
<span id="cb49-648"><a href="#cb49-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-649"><a href="#cb49-649" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The APM is always smaller than 1, even when direct and indirect effects are in opposite directions. This is due to the calculation method of APM, which uses the sum of the absolute values of indirect and direct effects as the denominator. $$APM=\frac{IE}{|IE|+|DE|}\cdot\frac{|IE+DE|}{IE+DE}=\frac{IE}{IE+DE}\cdot\frac{|IE+DE|}{|IE|+|DE|}=\frac{IE}{|IE|+|DE|}\cdot\frac{IE+DE}{|IE+DE|}$$</span>
<span id="cb49-650"><a href="#cb49-650" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-651"><a href="#cb49-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-652"><a href="#cb49-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-653"><a href="#cb49-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-654"><a href="#cb49-654" aria-hidden="true" tabindex="-1"></a>To further explore the indirect, direct, and total effects of different combinations of mediations, you can run more mediation analysis at Step 5 in the TriplotGUI interface .</span>
<span id="cb49-655"><a href="#cb49-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-656"><a href="#cb49-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-657"><a href="#cb49-657" aria-hidden="true" tabindex="-1"></a>Add the mediation result from <span class="in">`getMediationCounterfactual()`</span> into the TPObject.</span>
<span id="cb49-658"><a href="#cb49-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-659"><a href="#cb49-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_12}</span></span>
<span id="cb49-660"><a href="#cb49-660" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-661"><a href="#cb49-661" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-662"><a href="#cb49-662" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-663"><a href="#cb49-663" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-664"><a href="#cb49-664" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-665"><a href="#cb49-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-666"><a href="#cb49-666" aria-hidden="true" tabindex="-1"></a><span class="in">TPObject4 &lt;- addMediation(TPObject = TPObject3, </span></span>
<span id="cb49-667"><a href="#cb49-667" aria-hidden="true" tabindex="-1"></a><span class="in">                          mediationObject = mediation_object3)</span></span>
<span id="cb49-668"><a href="#cb49-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-669"><a href="#cb49-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-670"><a href="#cb49-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-671"><a href="#cb49-671" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- To create the triplot with mediation, use the provided function with its default arguments. This will generate a visualization that incorporates the mediation analysis results into the triplot framework. You can adjust these arguments as needed to customize the appearance and content of the triplot. --&gt;</span></span>
<span id="cb49-672"><a href="#cb49-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-673"><a href="#cb49-673" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_noshowoutput_8} --&gt;</span></span>
<span id="cb49-674"><a href="#cb49-674" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-675"><a href="#cb49-675" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-676"><a href="#cb49-676" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: false --&gt;</span></span>
<span id="cb49-677"><a href="#cb49-677" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-678"><a href="#cb49-678" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-679"><a href="#cb49-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-680"><a href="#cb49-680" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4 &lt;- --&gt;</span></span>
<span id="cb49-681"><a href="#cb49-681" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   mediationTriplot( --&gt;</span></span>
<span id="cb49-682"><a href="#cb49-682" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     TPObject4, --&gt;</span></span>
<span id="cb49-683"><a href="#cb49-683" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     show = c("APM","PM"), --&gt;</span></span>
<span id="cb49-684"><a href="#cb49-684" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Which mediation estimate to show --&gt;</span></span>
<span id="cb49-685"><a href="#cb49-685" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     firstPC = 1, --&gt;</span></span>
<span id="cb49-686"><a href="#cb49-686" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##The first PC to map --&gt;</span></span>
<span id="cb49-687"><a href="#cb49-687" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     secondPC = 2, --&gt;</span></span>
<span id="cb49-688"><a href="#cb49-688" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##The second PC to map --&gt;</span></span>
<span id="cb49-689"><a href="#cb49-689" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     plotMed = TRUE, --&gt;</span></span>
<span id="cb49-690"><a href="#cb49-690" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Whether to plot mediation estimates (TRUE; default) or suppress them (FALSE) --&gt;</span></span>
<span id="cb49-691"><a href="#cb49-691" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     plotCorr = TRUE, --&gt;</span></span>
<span id="cb49-692"><a href="#cb49-692" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Whether to plot correlations (TRUE; default) or suppress them (FALSE) --&gt;</span></span>
<span id="cb49-693"><a href="#cb49-693" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     plotRisk = TRUE, --&gt;</span></span>
<span id="cb49-694"><a href="#cb49-694" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Whether to plot risk estimates (TRUE; default) or suppress them (FALSE) --&gt;</span></span>
<span id="cb49-695"><a href="#cb49-695" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ############################################### --&gt;</span></span>
<span id="cb49-696"><a href="#cb49-696" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##For correlations --&gt;</span></span>
<span id="cb49-697"><a href="#cb49-697" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     colCorr = "blue", --&gt;</span></span>
<span id="cb49-698"><a href="#cb49-698" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Color vector for correlations --&gt;</span></span>
<span id="cb49-699"><a href="#cb49-699" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     pchCorr = 16, --&gt;</span></span>
<span id="cb49-700"><a href="#cb49-700" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Plotting character for correlations --&gt;</span></span>
<span id="cb49-701"><a href="#cb49-701" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     corrLim = NULL, --&gt;</span></span>
<span id="cb49-702"><a href="#cb49-702" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Plot range for correlations --&gt;</span></span>
<span id="cb49-703"><a href="#cb49-703" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     corrLabels = TRUE, --&gt;</span></span>
<span id="cb49-704"><a href="#cb49-704" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Add labels on exposures --&gt;</span></span>
<span id="cb49-705"><a href="#cb49-705" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ############################################### --&gt;</span></span>
<span id="cb49-706"><a href="#cb49-706" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##For risks --&gt;</span></span>
<span id="cb49-707"><a href="#cb49-707" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     colRisk = "red", --&gt;</span></span>
<span id="cb49-708"><a href="#cb49-708" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Color vector for risk estimates --&gt;</span></span>
<span id="cb49-709"><a href="#cb49-709" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     pchRisk = 15, --&gt;</span></span>
<span id="cb49-710"><a href="#cb49-710" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Plotting character for risk estimates --&gt;</span></span>
<span id="cb49-711"><a href="#cb49-711" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     riskLim = NULL, --&gt;</span></span>
<span id="cb49-712"><a href="#cb49-712" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Plot range for risks --&gt;</span></span>
<span id="cb49-713"><a href="#cb49-713" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     whiskerPercentageRisk = 0.1, --&gt;</span></span>
<span id="cb49-714"><a href="#cb49-714" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##whisker length is how many percentage of confidence interval --&gt;</span></span>
<span id="cb49-715"><a href="#cb49-715" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     riskLabels = TRUE, --&gt;</span></span>
<span id="cb49-716"><a href="#cb49-716" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Add labels on outcomes --&gt;</span></span>
<span id="cb49-717"><a href="#cb49-717" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     riskOR = TRUE, --&gt;</span></span>
<span id="cb49-718"><a href="#cb49-718" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     #plot the risk estimates as odds ratio --&gt;</span></span>
<span id="cb49-719"><a href="#cb49-719" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ############################################### --&gt;</span></span>
<span id="cb49-720"><a href="#cb49-720" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##For mediations --&gt;</span></span>
<span id="cb49-721"><a href="#cb49-721" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     colmed = "darkgreen", --&gt;</span></span>
<span id="cb49-722"><a href="#cb49-722" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Color vector for mediation estimates --&gt;</span></span>
<span id="cb49-723"><a href="#cb49-723" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     pchmed = 17, --&gt;</span></span>
<span id="cb49-724"><a href="#cb49-724" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Plotting character for mediation estimates --&gt;</span></span>
<span id="cb49-725"><a href="#cb49-725" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     medLim = NULL, --&gt;</span></span>
<span id="cb49-726"><a href="#cb49-726" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Plot range for mediations --&gt;</span></span>
<span id="cb49-727"><a href="#cb49-727" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     whiskerPercentageMediation= 0.1, --&gt;</span></span>
<span id="cb49-728"><a href="#cb49-728" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##whisker length is how many percentage of confidence interval --&gt;</span></span>
<span id="cb49-729"><a href="#cb49-729" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     medLabels = TRUE, --&gt;</span></span>
<span id="cb49-730"><a href="#cb49-730" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ##Add labels on mediation estimates --&gt;</span></span>
<span id="cb49-731"><a href="#cb49-731" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     ######################################### --&gt;</span></span>
<span id="cb49-732"><a href="#cb49-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-733"><a href="#cb49-733" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     size = 3 --&gt;</span></span>
<span id="cb49-734"><a href="#cb49-734" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     # the size of points ont he plot --&gt;</span></span>
<span id="cb49-735"><a href="#cb49-735" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ) --&gt;</span></span>
<span id="cb49-736"><a href="#cb49-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-737"><a href="#cb49-737" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-738"><a href="#cb49-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-739"><a href="#cb49-739" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Only showing the mediation results. --&gt;</span></span>
<span id="cb49-740"><a href="#cb49-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-741"><a href="#cb49-741" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_showoutput_13} --&gt;</span></span>
<span id="cb49-742"><a href="#cb49-742" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-743"><a href="#cb49-743" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-744"><a href="#cb49-744" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: true --&gt;</span></span>
<span id="cb49-745"><a href="#cb49-745" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-746"><a href="#cb49-746" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-747"><a href="#cb49-747" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| out-width: "100%" --&gt;</span></span>
<span id="cb49-748"><a href="#cb49-748" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4$mediations_plot --&gt;</span></span>
<span id="cb49-749"><a href="#cb49-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-750"><a href="#cb49-750" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-751"><a href="#cb49-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-752"><a href="#cb49-752" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The `mediationTriplot()` function displays only the proportion mediated (PM) and adjusted proportion mediated (APM) as dark green triangle points due to the specified `show = c("PM", "APM")` argument. --&gt;</span></span>
<span id="cb49-753"><a href="#cb49-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-754"><a href="#cb49-754" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- To reduce visual clutter, you can separate these by running the function twice: once with `show = c("PM")` and once with `show = c("APM")`.  --&gt;</span></span>
<span id="cb49-755"><a href="#cb49-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-756"><a href="#cb49-756" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_noshowoutput_8A} --&gt;</span></span>
<span id="cb49-757"><a href="#cb49-757" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-758"><a href="#cb49-758" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-759"><a href="#cb49-759" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: false --&gt;</span></span>
<span id="cb49-760"><a href="#cb49-760" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-761"><a href="#cb49-761" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-762"><a href="#cb49-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-763"><a href="#cb49-763" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4 &lt;- --&gt;</span></span>
<span id="cb49-764"><a href="#cb49-764" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   mediationTriplot( --&gt;</span></span>
<span id="cb49-765"><a href="#cb49-765" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     TPObject4, --&gt;</span></span>
<span id="cb49-766"><a href="#cb49-766" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     show = c("PM") --&gt;</span></span>
<span id="cb49-767"><a href="#cb49-767" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ) --&gt;</span></span>
<span id="cb49-768"><a href="#cb49-768" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-769"><a href="#cb49-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-770"><a href="#cb49-770" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_showoutput_13B} --&gt;</span></span>
<span id="cb49-771"><a href="#cb49-771" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-772"><a href="#cb49-772" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-773"><a href="#cb49-773" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: true --&gt;</span></span>
<span id="cb49-774"><a href="#cb49-774" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-775"><a href="#cb49-775" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-776"><a href="#cb49-776" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| out-width: "100%" --&gt;</span></span>
<span id="cb49-777"><a href="#cb49-777" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4$mediations_plot --&gt;</span></span>
<span id="cb49-778"><a href="#cb49-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-779"><a href="#cb49-779" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-780"><a href="#cb49-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-781"><a href="#cb49-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-782"><a href="#cb49-782" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Four green triangles are displayed on the figure. Their x and y coordiates represent the eight combinations of exposures, mediators and outcomes. --&gt;</span></span>
<span id="cb49-783"><a href="#cb49-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-784"><a href="#cb49-784" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   exposure=BSDS, mediator= module 1, outcome=BMI --&gt;</span></span>
<span id="cb49-785"><a href="#cb49-785" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   exposure=BSDS, mediator= module 2, outcome=BMI --&gt;</span></span>
<span id="cb49-786"><a href="#cb49-786" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   exposure=Hamburger, mediator= module 1, outcome=BMI --&gt;</span></span>
<span id="cb49-787"><a href="#cb49-787" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   exposure=Hamburger, mediator= module 2, outcome=BMI --&gt;</span></span>
<span id="cb49-788"><a href="#cb49-788" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   exposure=BSDS, mediator= module 1, outcome=T2D --&gt;</span></span>
<span id="cb49-789"><a href="#cb49-789" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   exposure=BSDS, mediator= module 2, outcome=T2D --&gt;</span></span>
<span id="cb49-790"><a href="#cb49-790" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   exposure=Hamburger, mediator= module 1, outcome=T2D --&gt;</span></span>
<span id="cb49-791"><a href="#cb49-791" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   exposure=Hamburger, mediator= module 2, outcome=T2D --&gt;</span></span>
<span id="cb49-792"><a href="#cb49-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-793"><a href="#cb49-793" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- We can see from the confidence intervals that some PM values are not significant, with large intervals pushing triangle points towards the origin. To better examine these points and their dimensions, we zoom in by adjusting the limit of the proportion mediated. Setting `"medLim = 2.5"` restricts the plot's range from -2.5 to 2.5, allowing for a closer inspection of the points and their relationships within this more focused area --&gt;</span></span>
<span id="cb49-794"><a href="#cb49-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-795"><a href="#cb49-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-796"><a href="#cb49-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-797"><a href="#cb49-797" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_noshowoutput_8B} --&gt;</span></span>
<span id="cb49-798"><a href="#cb49-798" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-799"><a href="#cb49-799" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-800"><a href="#cb49-800" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: false --&gt;</span></span>
<span id="cb49-801"><a href="#cb49-801" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-802"><a href="#cb49-802" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-803"><a href="#cb49-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-804"><a href="#cb49-804" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4 &lt;- --&gt;</span></span>
<span id="cb49-805"><a href="#cb49-805" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   mediationTriplot( --&gt;</span></span>
<span id="cb49-806"><a href="#cb49-806" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     TPObject4, --&gt;</span></span>
<span id="cb49-807"><a href="#cb49-807" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     show = c("PM"), --&gt;</span></span>
<span id="cb49-808"><a href="#cb49-808" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     medLim = 2.5 --&gt;</span></span>
<span id="cb49-809"><a href="#cb49-809" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ) --&gt;</span></span>
<span id="cb49-810"><a href="#cb49-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-811"><a href="#cb49-811" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-812"><a href="#cb49-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-813"><a href="#cb49-813" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_showoutput_13D} --&gt;</span></span>
<span id="cb49-814"><a href="#cb49-814" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-815"><a href="#cb49-815" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-816"><a href="#cb49-816" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: true --&gt;</span></span>
<span id="cb49-817"><a href="#cb49-817" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-818"><a href="#cb49-818" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-819"><a href="#cb49-819" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| out-width: "100%" --&gt;</span></span>
<span id="cb49-820"><a href="#cb49-820" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4$mediations_plot --&gt;</span></span>
<span id="cb49-821"><a href="#cb49-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-822"><a href="#cb49-822" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-823"><a href="#cb49-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-824"><a href="#cb49-824" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ::: callout-note --&gt;</span></span>
<span id="cb49-825"><a href="#cb49-825" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   Confidence intervals are automatically removed from the figure if they fall outside the set limits.  --&gt;</span></span>
<span id="cb49-826"><a href="#cb49-826" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   In certain mediations, the direct and indirect effects may have opposite directions. This can result in a proportion mediated (PM) greater than 1. This occurs because the total effect might be smaller than the indirect effect. --&gt;</span></span>
<span id="cb49-827"><a href="#cb49-827" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ::: --&gt;</span></span>
<span id="cb49-828"><a href="#cb49-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-829"><a href="#cb49-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-830"><a href="#cb49-830" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Based on the figure showing the mediation analysis results, we can observe the direction and magnitude of proportion mediated for the 2 mediators (module 1 and 2), all the exposures and outcomes. Based on the confidence interval, we also observed that the PM for BSDS-module 1-BMI and BSDS-module 2-BMI mediation is significant. --&gt;</span></span>
<span id="cb49-831"><a href="#cb49-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-832"><a href="#cb49-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-833"><a href="#cb49-833" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- To further examine the mediation results, we look at the adjusted proportion mediated (APM): --&gt;</span></span>
<span id="cb49-834"><a href="#cb49-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-835"><a href="#cb49-835" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_noshowoutput_8C} --&gt;</span></span>
<span id="cb49-836"><a href="#cb49-836" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-837"><a href="#cb49-837" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-838"><a href="#cb49-838" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: false --&gt;</span></span>
<span id="cb49-839"><a href="#cb49-839" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-840"><a href="#cb49-840" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-841"><a href="#cb49-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-842"><a href="#cb49-842" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4 &lt;- --&gt;</span></span>
<span id="cb49-843"><a href="#cb49-843" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   mediationTriplot( --&gt;</span></span>
<span id="cb49-844"><a href="#cb49-844" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     TPObject4, --&gt;</span></span>
<span id="cb49-845"><a href="#cb49-845" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--     show = c("APM") --&gt;</span></span>
<span id="cb49-846"><a href="#cb49-846" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!--   ) --&gt;</span></span>
<span id="cb49-847"><a href="#cb49-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-848"><a href="#cb49-848" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-849"><a href="#cb49-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-850"><a href="#cb49-850" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_showoutput_13F} --&gt;</span></span>
<span id="cb49-851"><a href="#cb49-851" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-852"><a href="#cb49-852" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-853"><a href="#cb49-853" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: true --&gt;</span></span>
<span id="cb49-854"><a href="#cb49-854" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-855"><a href="#cb49-855" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-856"><a href="#cb49-856" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| out-width: "100%" --&gt;</span></span>
<span id="cb49-857"><a href="#cb49-857" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4$mediations_plot --&gt;</span></span>
<span id="cb49-858"><a href="#cb49-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-859"><a href="#cb49-859" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-860"><a href="#cb49-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-861"><a href="#cb49-861" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- By observing this figure, we can see the direction and magnitude of adjusted proportion mediated (APM) for the two mediators across all exposures and outcomes. The positioning of the points is similar to what we observed for the proportion mediated (PM). --&gt;</span></span>
<span id="cb49-862"><a href="#cb49-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-863"><a href="#cb49-863" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Notably, the APM for BSDS (Baltic Sea Diet Score) as the exposure and T2D (Type 2 Diabetes) as the outcome is smaller than their corresponding PM. This difference occurs because the indirect and direct effects for this mediation pathway are of similar size but in opposite directions. This opposition leads to a smaller total effect and consequently a larger PM. However, the APM is not affected by the directionality of the direct and indirect effects, providing a more stable measure of mediation. --&gt;</span></span>
<span id="cb49-864"><a href="#cb49-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-865"><a href="#cb49-865" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ::: callout-note --&gt;</span></span>
<span id="cb49-866"><a href="#cb49-866" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   No confidence intervals are shown for APM. This is because APM values cannot be directly calculated from the mediation analysis in the `mediation` R package, unlike the proportion mediated (PM). --&gt;</span></span>
<span id="cb49-867"><a href="#cb49-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-868"><a href="#cb49-868" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- -   The APM is always smaller than 1, even when direct and indirect effects are in opposite directions. This is due to the calculation method of APM, which uses the sum of the absolute values of indirect and direct effects as the denominator. $$APM=\frac{IE}{|IE|+|DE|}\cdot\frac{|IE+DE|}{IE+DE}=\frac{IE}{IE+DE}\cdot\frac{|IE+DE|}{|IE|+|DE|}=\frac{IE}{|IE|+|DE|}\cdot\frac{IE+DE}{|IE+DE|}$$ --&gt;</span></span>
<span id="cb49-869"><a href="#cb49-869" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ::: --&gt;</span></span>
<span id="cb49-870"><a href="#cb49-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-871"><a href="#cb49-871" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ::: callout-note --&gt;</span></span>
<span id="cb49-872"><a href="#cb49-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-873"><a href="#cb49-873" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Specifying `show = c("PM", "APM", "IE", "TE")` in the `mediationTriplot()` function would display all estimates, including indirect effect (IE) and total effect (TE). However, this is not recommended as it can overcrowd the plot, making it difficult to interpret.  --&gt;</span></span>
<span id="cb49-874"><a href="#cb49-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-875"><a href="#cb49-875" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- For a clearer visualization, it's better to view IE and TE separately. The [Tutorial(simple)](simple_code.qmd){target="_blank"} section provides examples of plots showing `"IE"` and `"TE"`, offering a more manageable and interpretable view of these mediation components. --&gt;</span></span>
<span id="cb49-876"><a href="#cb49-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-877"><a href="#cb49-877" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ::: --&gt;</span></span>
<span id="cb49-878"><a href="#cb49-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-879"><a href="#cb49-879" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Plot the triplot with mediation, --&gt;</span></span>
<span id="cb49-880"><a href="#cb49-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-881"><a href="#cb49-881" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_showoutput_14} --&gt;</span></span>
<span id="cb49-882"><a href="#cb49-882" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-883"><a href="#cb49-883" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-884"><a href="#cb49-884" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: true --&gt;</span></span>
<span id="cb49-885"><a href="#cb49-885" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-886"><a href="#cb49-886" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-887"><a href="#cb49-887" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| out-width: "100%" --&gt;</span></span>
<span id="cb49-888"><a href="#cb49-888" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- TPO_plots4$mediations_triplot --&gt;</span></span>
<span id="cb49-889"><a href="#cb49-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-890"><a href="#cb49-890" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-891"><a href="#cb49-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-892"><a href="#cb49-892" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- Based on the barplot and the triplot with mediation, we’ve observed significant proportion mediated for BSDS-module 1/2-BMI mediations. Further exploration on indirect, direct and total effect of the mediation analysis could be explored by playing around the `show` argument in the `mediationTriplot()` function. We will not go into details here. --&gt;</span></span>
<span id="cb49-893"><a href="#cb49-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-894"><a href="#cb49-894" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparative Visualization</span></span>
<span id="cb49-895"><a href="#cb49-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-896"><a href="#cb49-896" aria-hidden="true" tabindex="-1"></a>The <span class="in">`checkTPO()`</span> function in TriplotGUI allows users to generate heatmaps from the TPObject to visualize correlations, risk estimations, and mediation results.</span>
<span id="cb49-897"><a href="#cb49-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-898"><a href="#cb49-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_noshowoutput_9}</span></span>
<span id="cb49-899"><a href="#cb49-899" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-900"><a href="#cb49-900" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-901"><a href="#cb49-901" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: false</span></span>
<span id="cb49-902"><a href="#cb49-902" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-903"><a href="#cb49-903" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-904"><a href="#cb49-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-905"><a href="#cb49-905" aria-hidden="true" tabindex="-1"></a><span class="in">checkTPObject4 &lt;- checkTPO(TPObject4,</span></span>
<span id="cb49-906"><a href="#cb49-906" aria-hidden="true" tabindex="-1"></a><span class="in">                                  mediatorEstimates = c("IE","TE","PM","APM"),</span></span>
<span id="cb49-907"><a href="#cb49-907" aria-hidden="true" tabindex="-1"></a><span class="in">                                  ## What type of mediation estimate or proportion mediated to show on the heatmap</span></span>
<span id="cb49-908"><a href="#cb49-908" aria-hidden="true" tabindex="-1"></a><span class="in">                                  mediators = c("turquoise", "blue"),</span></span>
<span id="cb49-909"><a href="#cb49-909" aria-hidden="true" tabindex="-1"></a><span class="in">                                  ## What mediators (principal component) you want to show</span></span>
<span id="cb49-910"><a href="#cb49-910" aria-hidden="true" tabindex="-1"></a><span class="in">                                  exposures = c("Hamburger","BSDS"),</span></span>
<span id="cb49-911"><a href="#cb49-911" aria-hidden="true" tabindex="-1"></a><span class="in">                                  ## What exposure variables you want to show</span></span>
<span id="cb49-912"><a href="#cb49-912" aria-hidden="true" tabindex="-1"></a><span class="in">                                  outcomes = c("T2D","BMI")</span></span>
<span id="cb49-913"><a href="#cb49-913" aria-hidden="true" tabindex="-1"></a><span class="in">                                  ## What outcome variables you want to show</span></span>
<span id="cb49-914"><a href="#cb49-914" aria-hidden="true" tabindex="-1"></a><span class="in">                                  )</span></span>
<span id="cb49-915"><a href="#cb49-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-916"><a href="#cb49-916" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-917"><a href="#cb49-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-918"><a href="#cb49-918" aria-hidden="true" tabindex="-1"></a>Correlation coefficients and p values between modules and exposures:</span>
<span id="cb49-919"><a href="#cb49-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-920"><a href="#cb49-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_15A}</span></span>
<span id="cb49-921"><a href="#cb49-921" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-922"><a href="#cb49-922" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-923"><a href="#cb49-923" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-924"><a href="#cb49-924" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-925"><a href="#cb49-925" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-926"><a href="#cb49-926" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-927"><a href="#cb49-927" aria-hidden="true" tabindex="-1"></a><span class="in">checkTPObject4$corr_coefficients</span></span>
<span id="cb49-928"><a href="#cb49-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-929"><a href="#cb49-929" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-930"><a href="#cb49-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-931"><a href="#cb49-931" aria-hidden="true" tabindex="-1"></a>Risk estimates(beta coefficients) and p values between modules and outcomes:</span>
<span id="cb49-932"><a href="#cb49-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-933"><a href="#cb49-933" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_15B}</span></span>
<span id="cb49-934"><a href="#cb49-934" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-935"><a href="#cb49-935" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-936"><a href="#cb49-936" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-937"><a href="#cb49-937" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-938"><a href="#cb49-938" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-939"><a href="#cb49-939" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-940"><a href="#cb49-940" aria-hidden="true" tabindex="-1"></a><span class="in">checkTPObject4$risk_coefficients</span></span>
<span id="cb49-941"><a href="#cb49-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-942"><a href="#cb49-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-943"><a href="#cb49-943" aria-hidden="true" tabindex="-1"></a>Mediation estimates and p values for indirect effect(IE) and total effect(TE), proportion mediated(PM) and adjusted proportion mediated(APM): Read <span class="co">[</span><span class="ot">Manual</span><span class="co">](workflow.qmd)</span>{target="_blank"} for more details:</span>
<span id="cb49-944"><a href="#cb49-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-945"><a href="#cb49-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_runcode_showoutput_15C}</span></span>
<span id="cb49-946"><a href="#cb49-946" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb49-947"><a href="#cb49-947" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-948"><a href="#cb49-948" aria-hidden="true" tabindex="-1"></a><span class="in">#| output: true</span></span>
<span id="cb49-949"><a href="#cb49-949" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-950"><a href="#cb49-950" aria-hidden="true" tabindex="-1"></a><span class="in">#| fold.plot: true</span></span>
<span id="cb49-951"><a href="#cb49-951" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: "100%"</span></span>
<span id="cb49-952"><a href="#cb49-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-953"><a href="#cb49-953" aria-hidden="true" tabindex="-1"></a><span class="in">checkTPObject4$med_coefficients</span></span>
<span id="cb49-954"><a href="#cb49-954" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-955"><a href="#cb49-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-956"><a href="#cb49-956" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- You could also View the three plots aboved combinedly. --&gt;</span></span>
<span id="cb49-957"><a href="#cb49-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-958"><a href="#cb49-958" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r showcode_runcode_showoutput_15D} --&gt;</span></span>
<span id="cb49-959"><a href="#cb49-959" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| eval: true --&gt;</span></span>
<span id="cb49-960"><a href="#cb49-960" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| echo: true --&gt;</span></span>
<span id="cb49-961"><a href="#cb49-961" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| output: true --&gt;</span></span>
<span id="cb49-962"><a href="#cb49-962" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| classes: styled-output --&gt;</span></span>
<span id="cb49-963"><a href="#cb49-963" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| fold.plot: true --&gt;</span></span>
<span id="cb49-964"><a href="#cb49-964" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- #| out-width: "100%" --&gt;</span></span>
<span id="cb49-965"><a href="#cb49-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-966"><a href="#cb49-966" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- checkTPObject4$corr_risk_med_coefficients --&gt;</span></span>
<span id="cb49-967"><a href="#cb49-967" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb49-968"><a href="#cb49-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-969"><a href="#cb49-969" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb49-970"><a href="#cb49-970" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Significance is indicated as follows. One star for p&lt;0.05; Two stars for p&lt;0.01; Three stars for p&lt;0.001.</span>
<span id="cb49-971"><a href="#cb49-971" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The first two plots, correlation coefficients with exposures and risk estimates of outcomes will show all the exposure and outcome variables that are not removed from visualization.</span>
<span id="cb49-972"><a href="#cb49-972" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that in the plot of <span class="in">`checkTPbject4$med_coefficients`</span>, nly the selected exposures, mediators and outcomes that we use to do mediation on will show up in the mediation results. The rows in the heatmaps are mediators and the column represents exposure-outcome pairs. For each exposure-outcome pair, 4 results are shown: *IE* (indirect effect), *TE* (total effect), *PM*(Proportion Mediated) and *APM*(Adjusted Proportion Mediated). Please read <span class="co">[</span><span class="ot">Manual</span><span class="co">](https://yingxiaoyan.gitlab.io/triplotgui_tutorial/workflow.html#5.2)</span>{target="_blank"} for more information. The "CF" before the names of exposures-outcome pairs means that this mediation is using the Counterfactual method.</span>
<span id="cb49-973"><a href="#cb49-973" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb49-974"><a href="#cb49-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-975"><a href="#cb49-975" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data download</span></span>
<span id="cb49-976"><a href="#cb49-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-977"><a href="#cb49-977" aria-hidden="true" tabindex="-1"></a>To save all your output, including data, results, and visualization output as an .rda file, you can use the <span class="in">`save()`</span> function as an rda file.</span>
<span id="cb49-978"><a href="#cb49-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-979"><a href="#cb49-979" aria-hidden="true" tabindex="-1"></a><span class="in">```{r showcode_noruncode_noshowoutput_1}</span></span>
<span id="cb49-980"><a href="#cb49-980" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: false</span></span>
<span id="cb49-981"><a href="#cb49-981" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb49-982"><a href="#cb49-982" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb49-983"><a href="#cb49-983" aria-hidden="true" tabindex="-1"></a><span class="in">#| error: true</span></span>
<span id="cb49-984"><a href="#cb49-984" aria-hidden="true" tabindex="-1"></a><span class="in">#| classes: styled-output</span></span>
<span id="cb49-985"><a href="#cb49-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-986"><a href="#cb49-986" aria-hidden="true" tabindex="-1"></a><span class="in">save(exposure2,Omics2,outcome2,covariates2,auxilariy2,</span></span>
<span id="cb49-987"><a href="#cb49-987" aria-hidden="true" tabindex="-1"></a><span class="in">     reduced_Omics2,Correlations_object,Risks_object,</span></span>
<span id="cb49-988"><a href="#cb49-988" aria-hidden="true" tabindex="-1"></a><span class="in">     mediation_object3,mediation_plots3,</span></span>
<span id="cb49-989"><a href="#cb49-989" aria-hidden="true" tabindex="-1"></a><span class="in">     TPObject1,TPObject2,TPObject3,TPObject4,</span></span>
<span id="cb49-990"><a href="#cb49-990" aria-hidden="true" tabindex="-1"></a><span class="in">     checkTPObject4,</span></span>
<span id="cb49-991"><a href="#cb49-991" aria-hidden="true" tabindex="-1"></a><span class="in">     "Tutorial_complex_output.rda")</span></span>
<span id="cb49-992"><a href="#cb49-992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb49-993"><a href="#cb49-993" aria-hidden="true" tabindex="-1"></a>0</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block">© 2024 Yingxiao Yan <br> CC BY-SA 4.0</span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block"> <a href="https://yingxiao.shinyapps.io/triplotgui/" target="_blank">TriplotGUI</a> <br><a href="https://gitlab.com/YingxiaoYan/TriplotGUI" target="_blank">TriplotGUI Gitlab</a> </span></p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial/edit/main/complex_code.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial/blob/main/complex_code.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li><li><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p><span class="faux-block cyan"> <a href="https://yingxiaoyan.gitlab.io/triplotgui_tutorial/" target="_blank">Main page of this tutorial</a> <br><a href="https://gitlab.com/YingxiaoYan/triplotgui_tutorial" target="_blank">View source of this site on GitLab</a> </span></p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"openEffect":"zoom","closeEffect":"zoom","loop":false,"selector":".lightbox","descPosition":"bottom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>